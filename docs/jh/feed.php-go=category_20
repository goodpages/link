<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0">
<channel>
<title><![CDATA[流浪的龙－个人知识管理]]></title> 
<link>http://i.renjihe.com/blog/index.php</link> 
<description><![CDATA[]]></description> 
<language>zh-cn</language> 
<copyright><![CDATA[流浪的龙－个人知识管理]]></copyright>
<item>
<link>http://i.renjihe.com/blog/read.php?5524</link>
<title><![CDATA[WebRTC音视频引擎研究--整体架构分析]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[音视频与流媒体]]></category>
<pubDate>Sat, 12 Oct 2013 02:02:09 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5524</guid> 
<description>
<![CDATA[ 
	<div style="font-family: Arial; font-size: 14px; line-height: 26px"><h3 style="margin: 0px; padding: 0px; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; line-height: 19px; font-size: 13px">1、WebRTC目的</h3><span style="line-height: 19px; font-size: 12px; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif">&nbsp; &nbsp; &nbsp; &nbsp;</span></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px">&nbsp; &nbsp; &nbsp; &nbsp;WebRTC（Web Real-Time Communication）项目的最终目的主要是让Web开发者能够基于浏览器（Chrome&#92;FireFox&#92;...）轻易快捷开发出丰富的实时多媒体应用，而无需下载安装任何插件，Web开发者也无需关注多媒体的数字信号处理过程，只需编写简单的Javascript程序即可实现，W3C等组织正在制定Javascript 标准API，目前是WebRTC 1.0版本，Draft状态，<a style="color: #ff9900; text-decoration: none" href="http://dev.w3.org/2011/webrtc/editor/webrtc.html">网址</a>；另外WebRTC还希望能够建立一个多互联网浏览器间健壮的实时通信的平台，形成开发者与浏览器厂商良好的生态环境。同时，Google也希望和致力于让WebRTC的技术成为HTML5标准之一，可见Google布局之深远。</div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><h3 style="margin: 0px; padding: 0px; font-family: Arial; line-height: 26px"><a style="color: #ff9900" name="t3"></a>2、WebRTC架构图<br /></h3><div style="color: #333333; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="color: #333333; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px">架构图颜色标识说明：</div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><span style="color: #6600cc">（1）紫色部分是Web开发者API层；</span></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><span style="color: #3366ff">（2）蓝色实线部分是面向浏览器厂商的API层（也就是红色框标内模块，也是本人专注研究的部分）</span></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><span style="color: #3366ff">（3）蓝色虚线部分浏览器厂商可以自定义实现</span></div><div style="color: #333333; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><h3 style="margin: 0px; padding: 0px"><a style="color: #ff9900" name="t4"></a>3、WebRTC架构组件介绍</h3><div><br /></div><strong>(1) Your Web App</strong><br />Web开发者开发的程序，Web开发者可以基于集成WebRTC的浏览器提供的web API开发基于视频、音频的实时通信应用。</div><div style="color: #333333; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><strong><strong>(2)&nbsp;</strong>Web API</strong><br />面向第三方开发者的WebRTC标准API（Javascript），使开发者能够容易地开发出类似于网络视频聊天的web应用，最新的标准化进程可以查看<a style="color: #ff9900; text-decoration: none" href="http://dev.w3.org/2011/webrtc/editor/webrtc.html"><strong><span style="color: #3366ff">这里</span></strong></a><span style="color: #333333">。</span><br /><br /><strong><strong>(3)&nbsp;</strong>WebRTC Native C++ API</strong><br />本地C++ API层，使浏览器厂商容易实现WebRTC标准的Web API，抽象地对数字信号过程进行处理。<br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><strong><strong>(4)&nbsp;</strong>Transport / Session</strong><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px">传输/会话层</div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px">会话层组件采用了libjingle库的部分组件实现，无须使用xmpp/jingle协议<br /><br /><span style="color: #3366ff"><strong>a. &nbsp;RTP Stack协议栈</strong></span><br />Real Time Protocol<br /><br /><span style="color: #3366ff"><strong>b. &nbsp;STUN/ICE</strong></span><br />可以通过STUN和ICE组件来建立不同类型网络间的呼叫连接。<br /><br /><strong><span style="color: #3366ff">c. &nbsp;Session Management</span></strong><br />一个抽象的会话层，提供会话建立和管理功能。该层协议留给应用开发者自定义实现。<br /></div><div style="color: #333333; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><strong><strong>(5)&nbsp;</strong>VoiceEngine</strong><br />音频引擎是包含一系列音频多媒体处理的框架，包括从视频采集卡到网络传输端等整个解决方案。<br />PS：VoiceEngine是WebRTC极具价值的技术之一，是Google收购GIPS公司后开源的。在VoIP上，技术业界领先，后面的文章会详细了解<br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><strong><span style="color: #3333ff">a. &nbsp;iSAC</span></strong><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px">Internet Speech Audio Codec<br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px">针对VoIP和音频流的宽带和超宽带音频编解码器，是WebRTC音频引擎的默认的编解码器<br />采样频率：16khz，24khz，32khz；（默认为16khz）<br />自适应速率为10kbit/s ~ 52kbit/；<br />自适应包大小：30~60ms；<br />算法延时：frame + 3ms<br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><strong><span style="color: #3333ff"><strong>b. &nbsp;</strong>iLBC</span></strong><br />Internet Low Bitrate Codec<br />VoIP音频流的窄带语音编解码器<br />采样频率：8khz；<br />20ms帧比特率为15.2kbps<br />30ms帧比特率为13.33kbps<br />标准由IETF RFC3951和RFC3952定义<br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /><strong><span style="color: #3333ff"><strong>c. &nbsp;</strong>NetEQ for Voice</span></strong><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px">针对音频软件实现的语音信号处理元件</div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px">NetEQ算法：自适应抖动控制算法以及语音包丢失隐藏算法。使其能够快速且高解析度地适应不断变化的网络环境，确保音质优美且缓冲延迟最小。<br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px">是GIPS公司独步天下的技术，能够有效的处理由于网络抖动和语音包丢失时候对语音质量产生的影响。</div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px">PS：NetEQ 也是WebRTC中一个极具价值的技术，对于提高VoIP质量有明显效果，加以AEC&#92;NR&#92;AGC等模块集成使用，效果更好。</div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><strong><span style="color: #3333ff"><strong>d. &nbsp;</strong>Acoustic Echo Canceler (AEC)</span></strong><br />回声消除器是一个基于软件的信号处理元件，能实时的去除mic采集到的回声。<br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><strong><span style="color: #3333ff"><strong>e. &nbsp;</strong>Noise Reduction (NR)</span></strong><br />噪声抑制也是一个基于软件的信号处理元件，用于消除与相关VoIP的某些类型的背景噪声（嘶嘶声，风扇噪音等等&hellip; &hellip;）<br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><strong><strong>(6)&nbsp;</strong>VideoEngine</strong><br />WebRTC视频处理引擎<br />VideoEngine是包含一系列视频处理的整体框架，从摄像头采集视频到视频信息网络传输再到视频显示整个完整过程的解决方案。<br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><strong><span style="color: #3333ff">a. &nbsp;VP8</span></strong><br />视频图像编解码器，是WebRTC视频引擎的默认的编解码器<br />VP8适合实时通信应用场景，因为它主要是针对低延时而设计的编解码器。<br />PS:VPx编解码器是Google收购ON2公司后开源的，VPx现在是WebM项目的一部分，而WebM项目是Google致力于推动的HTML5标准之一<br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><strong><span style="color: #3333ff">b. &nbsp;Video Jitter Buffer</span></strong><br />视频抖动缓冲器，可以降低由于视频抖动和视频信息包丢失带来的不良影响。<br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><strong><span style="color: #3333ff">c. &nbsp;Image enhancements</span></strong><br />图像质量增强模块<br />对网络摄像头采集到的图像进行处理，包括明暗度检测、颜色增强、降噪处理等功能，用来提升视频质量。<br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><h3 style="margin: 0px; padding: 0px; font-family: Arial; line-height: 26px"><a style="color: #ff9900" name="t5"></a>4、WebRTC核心模块API</h3><div style="font-family: Arial; font-size: 14px; line-height: 26px"><br /></div><h4 style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><a style="color: #ff9900" name="t6"></a>(1)、网络传输模块：libjingle</h4><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px">WebRTC重用了libjingle的一些组件，主要是network和transport组件，关于libjingle的文档资料可以查看<a style="color: #ff9900; text-decoration: none" href="http://code.google.com/apis/talk/libjingle/developer_guide.html"><span style="color: #000099"><strong>这里</strong></span></a>。</div><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><br /></div><div style="font-family: Arial; line-height: 26px; font-size: 13px"><h4 style="margin: 0px; padding: 0px; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; line-height: 19px"><a style="color: #ff9900" name="t7"></a>(2)、音频、视频图像处理的主要数据结构</h4><div><span style="line-height: 19px; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif"><strong>常量&#92;VideoEngine&#92;VoiceEngine</strong></span><br /></div><div><span style="line-height: 19px; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif"><strong><br /></strong></span></div><span style="line-height: 16px"><span style="font-family: arial, sans-serif"><em><span style="color: #ff0000">注意：以下所有的方法、类、结构体、枚举常量等都在</span><span style="color: #000099">webrtc</span><span style="color: #ff0000">命名空间里</span></em></span></span><span style="line-height: 19px; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif"><em></em><span style="color: #333333">&nbsp;&nbsp;</span></span><table border="1" cellspacing="0" cellpadding="7" width="610" style="margin: 0px; color: #333333; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><tbody><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><strong>类、结构体、枚举常量</strong></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><strong><span style="font-family: arial, sans-serif">头文件</span></strong></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><strong>说明</strong></span></p></td></tr></tbody><tbody><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>Structures</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">common_types.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="line-height: normal"><span style="font-family: arial, sans-serif">Lists the structures common to the VoiceEngine &amp; VideoEngine</span></span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>Enumerators</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">common_types.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="line-height: normal"><span style="font-family: arial, sans-serif">List the enumerators common to the &nbsp;VoiceEngine &amp; VideoEngine</span></span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>Classes</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">common_types.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="line-height: normal"><span style="font-family: arial, sans-serif">List the classes common to VoiceEngine &amp; VideoEngine</span></span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">class&nbsp;<span style="color: #24355d"><span style="padding: 2px"><strong>VoiceEngine</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_base.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="line-height: normal">How to allocate and release resources for the VoiceEngine using factory methods in the&nbsp;VoiceEngine&nbsp;class. It also lists the APIs which are required to enable file tracing and/or traces as callback messages</span></span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">class&nbsp;<span style="color: #24355d"><span style="padding: 2px"><strong>VideoEngine</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">vie_base.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="line-height: normal"><span style="font-family: arial, sans-serif">How to allocate and release resources for the VideoEngine using factory methods in the&nbsp;VideoEngine&nbsp;class. It also lists the APIs which are required to enable file tracing and/or traces as callback messages</span></span></p></td></tr></tbody></table><br /></div><h4 style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><a style="color: #ff9900" name="t8"></a><strong>(3)、音频引擎（VoiceEngine）模块 APIs</strong></h4><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><strong><br /></strong></div><div style="font-family: Arial; font-size: 14px; line-height: 19px"><div style="font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px"><span style="line-height: normal"><span style="font-size: 12px; font-family: arial, sans-serif"><em><span style="color: #cc0000">下表列的是目前在 VoiceEngine中可用的sub APIs</span></em></span></span></div><table border="1" cellspacing="0" cellpadding="7" width="610" style="margin: 0px; color: #333333; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; line-height: 19px"><tbody><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><span style="font-family: arial, sans-serif"><strong>sub-API</strong></span></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><strong><span style="font-family: arial, sans-serif">头文件</span></strong></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><strong><span style="font-family: arial, sans-serif">说明</span></strong></p></td></tr></tbody><tbody><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoEAudioProcessing</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_audio_processing.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds support for Noise Suppression (NS), Automatic Gain Control (AGC) and Echo Control (EC). Receiving side VAD is also included.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoEBase</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_base.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Enables full duplex VoIP using G.711.<br /><strong>NOTE:</strong>&nbsp;This API must always be created.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoECallReport</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_call_report.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds support for call reports which contains number of dead-or-alive detections, RTT measurements, and Echo metrics.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="padding: 2px; border-collapse: collapse; font-size: 13px; font-family: Calibri, sans-serif; color: #24355d"><strong>VoECodec</strong></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_codec.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds non-default codecs (e.g. iLBC, iSAC, G.722 etc.), Voice Activity Detection (VAD) support.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoEDTMF</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_dtmf.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds telephone event transmission, DTMF tone generation and telephone event detection. (Telephone events include DTMF.)</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoEEncryption</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_encryption.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds external encryption/decryption support.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoEErrors</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; color: #000000"><span style="font-family: arial, sans-serif">voe_errors.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; color: #000000"><span style="font-family: arial, sans-serif">Error Codes for the VoiceEngine</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoEExternalMedia</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_external_media.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds support for external media processing and enables utilization of an external audio resource.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoEFile</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_file.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds file playback, file recording and file conversion functions.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoEHardware</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_hardware.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds sound device handling, CPU load monitoring and device information functions.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoENetEqStats</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_neteq_stats.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds buffer statistics functions.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoENetwork</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_network.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds external transport, port and address filtering, Windows QoS support and packet timeout notifications.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoERTP_RTCP</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_rtp_rtcp.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds support for RTCP sender reports, SSRC handling, RTP/RTCP statistics, Forward Error Correction (FEC), RTCP APP, RTP capturing and RTP keepalive.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoEVideoSync</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_video_sync.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds RTP header modification support, playout-delay tuning and monitoring.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>VoEVolumeControl</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">voe_volume_control.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px; direction: ltr; color: #000000"><span style="font-family: arial, sans-serif">Adds speaker volume controls, microphone volume controls, mute support, and additional stereo scaling methods.</span></p></td></tr></tbody></table><br /><br /></div><div style="font-family: Arial; font-size: 14px; line-height: 19px"><h4 style="margin: 0px; padding: 0px; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px"><a style="color: #ff9900" name="t9"></a>(4)、视频引擎（VideoEngine）模块 APIs</h4><div style="color: #333333; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px"><span style="line-height: normal; color: #000000"><span style="font-size: 12px; font-family: arial, sans-serif"><span style="color: #cc0000"><em>下表列的是目前在 VideoEngine中可用的sub APIs</em></span></span></span></div><table border="1" cellspacing="0" cellpadding="7" width="610" style="margin: 0px; font-family: 'Lucida Grande', 'Lucida Sans', Verdana, Arial, sans-serif; font-size: 13px; color: #000000"><tbody><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><strong>sub-API</strong></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><strong>头文件</strong></span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><strong><span style="font-family: arial, sans-serif">说明</span></strong></p></td></tr></tbody><tbody><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>ViEBase</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">vie_base.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">Basic functionality for creating a VideoEngine instance, channels and VoiceEngine interaction.</span></p><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><strong>NOTE:</strong>&nbsp;This API must always be created.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>ViECapture</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">vie_capture.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">Adds support for capture device allocation as well as capture device capabilities.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>ViECodec</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">vie_codec.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">Adds non-default codecs, codec settings and packet loss functionality.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>ViEEncryption</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">vie_encryption.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">Adds external encryption/decryption support.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>ViEErrors</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">vie_errors.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">Error codes for the VideoEngine</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>ViEExternalCodec</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">vie_external_codec.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">Adds support for using external codecs.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>ViEFile</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">vie_file.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">Adds support for file recording, file playout, background images and snapshot.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>ViEImageProcess</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">vie_image_process.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">Adds effect filters, deflickering, denoising and color enhancement.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>ViENetwork</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">vie_network.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">Adds send and receive functionality, external transport, port and address filtering, Windows QoS support, packet timeout notification and changes to network settings.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>ViERender</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">vie_render.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">Adds rendering functionality.</span></p></td></tr><tr><td width="146" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif"><span style="color: #24355d"><span style="padding: 2px"><strong>ViERTP_RTCP</strong></span></span></span></p></td><td width="157" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">vie_rtp_rtcp.h</span></p></td><td width="264" style="vertical-align: top; padding: 1px 4px" bgcolor="#f3f3f3"><p style="margin: 0px 0px 0.08in 0in; padding: 0px"><span style="font-family: arial, sans-serif">Adds support for RTCP reports, SSRS handling RTP/RTCP statistics, NACK/FEC, keep-alive functionality and key frame request methods.</span></p><div><span style="font-family: arial, sans-serif"><br /></span></div></td></tr></tbody></table></div>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5504</link>
<title><![CDATA[PeerCDN：使用WebRTC构建基于浏览器的P2P CDN]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[音视频与流媒体]]></category>
<pubDate>Thu, 10 Oct 2013 08:20:55 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5504</guid> 
<description>
<![CDATA[ 
	<p style="margin: 0px 0px 15px; padding: 0px; border: 0px; float: left; font-size: 14px; line-height: 21px; clear: both; width: 610px; font-family: Arial, sans-serif">一组Web黑客构建了一个基于P2P的CDN，能够借助于一些JavaScript代码在Web浏览器之间分发网站数据。该项目称为<a style="text-decoration: none; color: #286ab2; margin: 0px; border: 0px; padding: 0px; outline: none !important" href="https://peercdn.com/">PeerCDN</a>，它基于<a style="text-decoration: none; color: #286ab2; margin: 0px; border: 0px; padding: 0px; outline: none !important" href="http://www.webrtc.org/">WebRTC</a>这个新兴的技术构建。</p><p style="margin: 0px 0px 15px; padding: 0px; border: 0px; float: left; font-size: 14px; line-height: 21px; clear: both; width: 610px; font-family: Arial, sans-serif"><a style="text-decoration: none; color: #286ab2; margin: 0px; border: 0px; padding: 0px; outline: none !important" href="https://peercdn.com/">PeerCDN的官网</a>是这样介绍该项目的：</p><p style="margin: 0px 0px 15px; padding: 0px; border: 0px; float: left; font-size: 14px; line-height: 21px; clear: both; width: 610px; font-family: Arial, sans-serif">PeerCDN是一个对等的分布式CDN，它能够让Web变得更快、更可靠，同时能够帮助网站降低带宽消耗。PeerCDN会自动地通过网站当前访问者所建立起来的P2P网络为网站内的静态内容（图片、视频和文件下载）服务，降低Web主机的一部分负担，同时也减少网站访问者的带宽消耗。除此之外，它还具有以下优点：</p><ul style="margin: 0px 0px 15px 10px; padding: 0px; list-style-position: initial; list-style-image: initial; border: 0px; clear: left; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px"><li style="margin: 0px 0px 0px 15px; padding: 0px; border: 0px; float: none; clear: none">纯JavaScript，非常快，也非常轻量级，使用它不需要安装任何浏览器插件。</li><li style="margin: 0px 0px 0px 15px; padding: 0px; border: 0px; float: none; clear: none">能够轻松地处理瞬间流量增长。访问量高的文件可以被对等节点快速有效地传递，而常规的Web服务器和传统的CDN则可以为长尾内容提供可靠的服务。</li><li style="margin: 0px 0px 0px 15px; padding: 0px; border: 0px; float: none; clear: none">广泛的浏览器支持。PeerCDN利用WebRTC的数据通道在网站访问者之间建立对等的连接，Chrome和夜间版Firefox已经实现了该数据通道协议，而根据StatCounter提供的数据，这两款浏览器一共占有全球58%的浏览器使用率。此外，IE和Safari可能很快就会支持该协议。</li><li style="margin: 0px 0px 0px 15px; padding: 0px; border: 0px; float: none; clear: none">可以和传统的CDN一起工作。可以在需要提供更好的网站性能或需要减少服务器带宽使用率的情况下采用PeerCDN。</li><li style="margin: 0px 0px 0px 15px; padding: 0px; border: 0px; float: none; clear: none">内置的安全性。PeerCDN使用集中的资源认证服务器为网站资源生成SHA1哈希。对等节点提供的数据都会在确认安全性和原始性（内容未被篡改）的情况下才会被接受。同时，对等节点间的通信也是加密的。</li><li style="margin: 0px 0px 0px 15px; padding: 0px; border: 0px; float: none; clear: none">可靠性。如果对等节点慢或者中央PeerCDN服务器无法访问，那么网站就会按照正常方式加载。</li><li style="margin: 0px 0px 0px 15px; padding: 0px; border: 0px; float: none; clear: none">易于安装。我们的目标是易于复制、粘贴。只要在一个网站上粘贴一个script标签，网站马上就会变快，使用的带宽更少，更加弹性地处理瞬间流量。</li></ul><p style="margin: 0px 0px 15px; padding: 0px; border: 0px; float: left; font-size: 14px; line-height: 21px; clear: both; width: 610px; font-family: Arial, sans-serif">为了解释PeerCDN的实现方式，该项目还制作了一个<a style="text-decoration: none; color: #286ab2; margin: 0px; border: 0px; padding: 0px; outline: none !important" href="http://www.youtube.com/watch?feature=player_embedded&amp;v=PnBIIdmKO9o">截屏视频</a>。该视频首先介绍了PeerCDN的一些优点；然后通过文件下载、视频和图片三个示例讲解了其工作方式；最后简要介绍了其安全性、浏览器支持和性能。</p><p style="margin: 0px 0px 15px; padding: 0px; border: 0px; float: left; font-size: 14px; line-height: 21px; clear: both; width: 610px; font-family: Arial, sans-serif">当然，对于该项目的前景还有一些不同的声音，有些人就在<a style="text-decoration: none; color: #286ab2; margin: 0px; border: 0px; padding: 0px; outline: none !important" href="https://news.ycombinator.com/item?id=5452780">HackNews上提出了自己的疑问</a>：</p><blockquote style="margin: 0px 0px 10px; padding: 10px 10px 10px 45px; border: 1px solid #e8e8e8; float: left; clear: both; width: 553px; background-image: url('http://infoqstatic.com/styles/i/gg.jpg'); background-color: #f4f4f4; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; background-position: 0% 0%; background-repeat: no-repeat no-repeat"><p style="margin: 0px 0px 15px; padding: 0px; border: 0px; float: left; line-height: 1.5; clear: both; width: 553px; word-wrap: break-word !important">这对网站很好，但是对移动或者有数据上限的用户而言就有问题了。移动用户和某些使用无线网络的情况下会有流量限制。</p></blockquote><p style="margin: 0px 0px 15px; padding: 0px; border: 0px; float: left; font-size: 14px; line-height: 21px; clear: both; width: 610px; font-family: Arial, sans-serif">除此之外，有人提出了隐私问题，认为向其他的对等节点泄漏信息根本就不好，因为可以暗地里使用这些信息跟踪用户。同时在2013年，为所有类型的静态文件提供服务非常容易且成本低廉，所以大的视频可能是唯一的使用场景，而如果使用这种方式加载视频，需要大量的种子才能快速缓冲并播放。此外，还有存储这些内容需要占用用户多大的磁盘空间，是否会在当前页面上下文之外存储内容等问题。</p><p style="margin: 0px 0px 15px; padding: 0px; border: 0px; float: left; font-size: 14px; line-height: 21px; clear: both; width: 610px; font-family: Arial, sans-serif"><a style="text-decoration: none; color: #286ab2; margin: 0px; border: 0px; padding: 0px; outline: none !important" href="http://www.reddit.com/r/programming/comments/1b6162/peertopeer_cdn_in_the_browser/">Reddit网站上也有人对该项目发表了自己的看法</a>：</p><blockquote style="margin: 0px 0px 10px; padding: 10px 10px 10px 45px; border: 1px solid #e8e8e8; float: left; clear: both; width: 553px; background-image: url('http://infoqstatic.com/styles/i/gg.jpg'); background-color: #f4f4f4; font-family: Arial, sans-serif; font-size: 14px; line-height: 21px; background-position: 0% 0%; background-repeat: no-repeat no-repeat"><p style="margin: 0px 0px 15px; padding: 0px; border: 0px; float: left; line-height: 1.5; clear: both; width: 553px; word-wrap: break-word !important">人们并不想这样共享自己的带宽，特别是他们自己没有选择权的情况下。很多用户可能并不知道发生了什么，但是他们会发现自己访问网页时的速度变慢了。另外，现在人们通常会打开大量的标签页，但是他们并不希望一些忘记关闭的标签页占用大量的流量。</p></blockquote><p style="margin: 0px 0px 15px; padding: 0px; border: 0px; float: left; font-size: 14px; line-height: 21px; clear: both; width: 610px; font-family: Arial, sans-serif">当然，也有人持肯定意见，认为互联网需要更多这样的技术。只有ADSL连接才存在人们所关心的带宽问题，但是对称访问连接（FttH）会越来越多，这将推动P2P协议向前发展。</p><p style="margin: 0px 0px 15px; padding: 0px; border: 0px; float: left; font-size: 14px; line-height: 21px; clear: both; width: 610px; font-family: Arial, sans-serif">如果你想了解社区中对该项目的相关讨论，可以打开新闻中给出的链接阅读更详细的信息。</p><p style="margin: 0px 0px 15px; padding: 0px; border: 0px; float: left; font-size: 14px; line-height: 21px; clear: both; width: 610px; font-family: Arial, sans-serif">PeerCDN项目的开发者之一Feross Aboukhadijeh是一位著名的HTML 5开发者，他在最近构建了一个网站，能够自动地通过<a style="text-decoration: none; color: #286ab2; margin: 0px; border: 0px; padding: 0px; outline: none !important" href="http://feross.org/fill-disk/">GB大小的猫图</a>填满访问者的硬盘（可参考<a style="text-decoration: none; color: #286ab2; margin: 0px; border: 0px; padding: 0px; outline: none !important" href="http://www.infoq.com/cn/news/2013/02/html5-fill-disk">InfoQ中文站之前的报道</a>）。在此之前，他还创建了一个名为<a style="text-decoration: none; color: #286ab2; margin: 0px; border: 0px; padding: 0px; outline: none !important" href="http://ytinstant.com/">YTInstant</a>的YouTube搜索网站。</p>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5500</link>
<title><![CDATA[WebRTC学习笔记]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[音视频与流媒体]]></category>
<pubDate>Wed, 09 Oct 2013 07:22:25 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5500</guid> 
<description>
<![CDATA[ 
	<h1 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 41.818180084228516px"><a style="text-decoration: underline; color: #566053" name="_Toc353542667"></a><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px"><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px"><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px">1.<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px">WebRTC</span></span><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px"><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px"><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px; font-family: 黑体">学习</span></span></span><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px"></span></h1><h2 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><a style="text-decoration: underline; color: #566053" name="_Toc353542668"></a><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">1.1<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">WebRTC</span></span><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px; font-family: 黑体">现状</span></span></span></h2><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">本人最早接触<span style="word-wrap: normal; word-break: normal">WebRTC</span>是在<span style="word-wrap: normal; word-break: normal">2011</span>年底，那时<span style="word-wrap: normal; word-break: normal">Google</span>已经在<span style="word-wrap: normal; word-break: normal">Android</span>源码中加入了<span style="word-wrap: normal; word-break: normal">webrtc</span>源码，放在<span style="word-wrap: normal; word-break: normal">/external/webrtc/</span>，但是<span style="word-wrap: normal; word-break: normal">Android</span>并没有用到它，更没有被浏览器使用。当时试图在<span style="word-wrap: normal; word-break: normal">Android 2.3</span>（<span style="word-wrap: normal; word-break: normal">Gingerbread</span>）高通平台的手机上用<span style="word-wrap: normal; word-break: normal">H.264</span>&nbsp;硬件<span style="word-wrap: normal; word-break: normal">codec</span>替换掉<span style="word-wrap: normal; word-break: normal">WebRTC</span>缺省使用的<span style="word-wrap: normal; word-break: normal">VP8</span>软<span style="word-wrap: normal; word-break: normal">codec</span>，费了不少劲勉强换掉后效果很差只得放弃。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">最近得知<span style="word-wrap: normal; word-break: normal">Google</span>最新版的<span style="word-wrap: normal; word-break: normal">Chrome for Android</span>已经支持<span style="word-wrap: normal; word-break: normal">WebRTC</span>，应老板的要求搭一个手机浏览器上视频通信的<span style="word-wrap: normal; word-break: normal">demo</span>，为此在网上搜集各种资料，发现经过一年多的发展，国内外研究和使用<span style="word-wrap: normal; word-break: normal">WebRTC</span>的人明显多起来，可用的<span style="word-wrap: normal; word-break: normal">demo</span>也很多。在此做一个笔记，留作日后参考。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">目前基于<span style="word-wrap: normal; word-break: normal">WebRTC</span>的开发其实有两个方向，一个是基于浏览器的<span style="word-wrap: normal; word-break: normal">WebRTC</span>应用开发，编程语言主要是<span style="word-wrap: normal; word-break: normal">JavaScript</span>、<span style="word-wrap: normal; word-break: normal">HTML</span>等，这也是<span style="word-wrap: normal; word-break: normal">WebRTC</span>作为<span style="word-wrap: normal; word-break: normal">HTML5</span>标准的组成部分原本的目的；另一个是<span style="word-wrap: normal; word-break: normal">C</span>层面的移植和开发，作为一款非常强大的开源软件，很多领域的软件项目都可以利用到<span style="word-wrap: normal; word-break: normal">WebRTC</span>的音视频通信和处理能力，这些场合的应用程序可能是<span style="word-wrap: normal; word-break: normal">C</span>语言写的，也不一定与浏览器有关。本文是属于前一种方向。</span></p><h2 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 30.909090042114258px"><a style="text-decoration: underline; color: #566053" name="_Toc353542669"></a><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">1.2<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">WebRTC</span><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px; font-family: 黑体">基本概念学习</span></span></h2><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">WebRTC</span><span style="word-wrap: normal; word-break: normal; font-family: 宋体">的官方资料可以从其官网<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://www.webrtc.org/">http://www.webrtc.org/</a></span>和<span style="word-wrap: normal; word-break: normal">W 3C</span>网站<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://www.w3.org/TR/webrtc/">http://www.w3.org/TR/webrtc/</a></span>上看到。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">学习<span style="word-wrap: normal; word-break: normal">WebRTC</span>基础知识比较好的网站是《<span style="word-wrap: normal; word-break: normal">Getting Started with WebRTC</span>》，网址是<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://www.html5rocks.com/en/tutorials/webrtc/basics/">http://www.html5rocks.com/en/tutorials/webrtc/basics/</a></span>，这个也是官网上推荐的。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">对浏览器来说，<span style="word-wrap: normal; word-break: normal">WebRTC</span>其实就是提供了<span style="word-wrap: normal; word-break: normal">3</span>个<span style="word-wrap: normal; word-break: normal">API</span>：</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; text-indent: 21pt; background-color: #e0e0e0"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">MediaStream (</span><span style="word-wrap: normal; word-break: normal; font-family: 宋体">即<span style="word-wrap: normal; word-break: normal">getUserMedia)</span>，用于获取媒体数据，例如来自摄像头和麦克风的视频流和音频流；</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; text-indent: 21pt; background-color: #e0e0e0"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">RTCPeerConnection</span><span style="word-wrap: normal; word-break: normal; font-family: 宋体">，用于<span style="word-wrap: normal; word-break: normal">peer</span>跟<span style="word-wrap: normal; word-break: normal">peer</span>之间呼叫和建立连接以便传输音视频数据流；</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; text-indent: 21pt; background-color: #e0e0e0"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">RTCDataChannel</span><span style="word-wrap: normal; word-break: normal; font-family: 宋体">，用于<span style="word-wrap: normal; word-break: normal">peer</span>跟<span style="word-wrap: normal; word-break: normal">peer</span>之间传输音视频之外的一般数据。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">需要注意的是这几个<span style="word-wrap: normal; word-break: normal">API</span>的名称在不同浏览器及同一浏览器的不同版本之间略有差异，比如<span style="word-wrap: normal; word-break: normal">PeerConnection</span>在<span style="word-wrap: normal; word-break: normal">FireFox</span>上叫做<span style="word-wrap: normal; word-break: normal">mozRTCPeerConnection</span>，而在当前版本的<span style="word-wrap: normal; word-break: normal">Chrome</span>上叫做<span style="word-wrap: normal; word-break: normal">webkitRTCPeerConnection</span>，将来<span style="word-wrap: normal; word-break: normal">WebRTC</span>标准化完成后会把这些前缀去掉使用统一的名称。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">目前网上找到的<span style="word-wrap: normal; word-break: normal">WebRTC demo</span>都只用到了<span style="word-wrap: normal; word-break: normal">getUserMedia</span>和<span style="word-wrap: normal; word-break: normal">RTCPeerConnection</span>这两个<span style="word-wrap: normal; word-break: normal">API</span>，另一个<span style="word-wrap: normal; word-break: normal">API</span>即<span style="word-wrap: normal; word-break: normal">RTCDataChannel</span>似乎目前还不太成熟。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">WebRTC</span><span style="word-wrap: normal; word-break: normal; font-family: 宋体">是实现<span style="word-wrap: normal; word-break: normal">peer to peer</span>的实时通信（可以两个或多个<span style="word-wrap: normal; word-break: normal">peer</span>之间），在能够通信前<span style="word-wrap: normal; word-break: normal">peer</span>跟<span style="word-wrap: normal; word-break: normal">peer</span>之间必须建立连接，这是<span style="word-wrap: normal; word-break: normal">RTCPeerConnection</span>的任务，为此需要借助一个信令服务器（<span style="word-wrap: normal; word-break: normal">signaling server</span>）来进行，信令包括<span style="word-wrap: normal; word-break: normal">3</span>种类型的信息：</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; text-indent: 21pt; background-color: #e0e0e0"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">Session control messages:</span>&nbsp;<span style="word-wrap: normal; word-break: normal; font-family: 宋体">初始化和关闭通信，及报告错误；</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; text-indent: 21pt; background-color: #e0e0e0"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">Network configuration:</span>&nbsp;<span style="word-wrap: normal; word-break: normal; font-family: 宋体">双方的<span style="word-wrap: normal; word-break: normal">IP</span>地址和端口号（局域网内部<span style="word-wrap: normal; word-break: normal">IP</span>地址需转换为外部的<span style="word-wrap: normal; word-break: normal">IP</span>地址）；</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; text-indent: 21pt; background-color: #e0e0e0"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">Media capabilities:</span>&nbsp;<span style="word-wrap: normal; word-break: normal; font-family: 宋体">双方的浏览器支持使用何种<span style="word-wrap: normal; word-break: normal">codecs</span>以及多高的视频分辨率。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">WebRTC</span><span style="word-wrap: normal; word-break: normal; font-family: 宋体">并未规定使用何种信令机制和消息协议，象<span style="word-wrap: normal; word-break: normal">SIP</span>、<span style="word-wrap: normal; word-break: normal">XMPP</span>、<span style="word-wrap: normal; word-break: normal">XHR</span>、<span style="word-wrap: normal; word-break: normal">WebSocket</span>这些技术都可以用作<span style="word-wrap: normal; word-break: normal">WebRTC</span>的信令通信。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">除了信令服务器，<span style="word-wrap: normal; word-break: normal">peer</span>跟<span style="word-wrap: normal; word-break: normal">peer</span>建立连接还需要借助另一种服务器（称为<span style="word-wrap: normal; word-break: normal">STUN server</span>）实现<span style="word-wrap: normal; word-break: normal">NAT/Firewall</span>穿越，因为很多<span style="word-wrap: normal; word-break: normal">peer</span>是处于私有局域网中，使用私有<span style="word-wrap: normal; word-break: normal">IP</span>地址，必须转换为公有<span style="word-wrap: normal; word-break: normal">IP</span>地址才能相互之间传输数据。这其中涉及到一些专业术语包括<span style="word-wrap: normal; word-break: normal">STUN</span>、<span style="word-wrap: normal; word-break: normal">TURN</span>、<span style="word-wrap: normal; word-break: normal">ICE</span>等，具体的本人还有待学习。网上找到的<span style="word-wrap: normal; word-break: normal">WebRTC demo</span>好象都用的是<span style="word-wrap: normal; word-break: normal">Google</span>提供的<span style="word-wrap: normal; word-break: normal">STUN server</span>。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">peer</span><span style="word-wrap: normal; word-break: normal; font-family: 宋体">跟<span style="word-wrap: normal; word-break: normal">peer</span>之间一旦建立连接就可以直接传输音视频数据流，并不需要借助第三方服务器中转。</span></p><h1 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 41.818180084228516px"><a style="text-decoration: underline; color: #566053" name="_Toc353542670"></a><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px"><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px">2.<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px">WebRTC</span><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px"><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px; font-family: 黑体">封装库</span></span></h1><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">WebRTC</span><span style="word-wrap: normal; word-break: normal; font-family: 宋体">的目的是为了简化基于浏览器的实时数据通信的开发工作量，但实际应用编程还是有点复杂，尤其调用<span style="word-wrap: normal; word-break: normal">RTCPeerConnection</span>必须对如何建立连接、交换信令的流程和细节有较深入的理解。因此有高人为我们开发了<span style="word-wrap: normal; word-break: normal">WebRTC</span>封装库，将<span style="word-wrap: normal; word-break: normal">WebRTC</span>的调用细节封装起来，包装成更简单的<span style="word-wrap: normal; word-break: normal">API</span>，使开发应用程序更简单。封装库的另一个目的是为了屏蔽不同浏览器之间的差异，例如上面说的<span style="word-wrap: normal; word-break: normal">API</span>名称的差异。当然，这些库都是开源的，可以根据自己的需要重新修改。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">目前网上找到的有两种<span style="word-wrap: normal; word-break: normal">WebRTC</span>封装库，一个是<span style="word-wrap: normal; word-break: normal">webrtc.io</span>，网址是<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="https://github.com/webRTC/webRTC.io">https://github.com/webRTC/webRTC.io</a></span>，上面有详细说明和使用方法，有很多<span style="word-wrap: normal; word-break: normal">demo</span>使用它；另一个是<span style="word-wrap: normal; word-break: normal">SimpleWebRTC</span>，网址是<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="https://github.com/HenrikJoreteg/SimpleWebRTC">https://github.com/HenrikJoreteg/SimpleWebRTC</a></span>，貌似比<span style="word-wrap: normal; word-break: normal">webrtc.io</span>用起来更简单。</span></p><h1 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 41.818180084228516px"><a style="text-decoration: underline; color: #566053" name="_Toc353542671"></a><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px"><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px">3.<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px">WebRTC demo</span><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px"><span style="word-wrap: normal; word-break: normal; line-height: 41.818180084228516px; font-family: 黑体">试用</span></span></h1><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">网上可以找到一堆<span style="word-wrap: normal; word-break: normal">WebRTC demo</span>，在<span style="word-wrap: normal; word-break: normal">code.google.com</span>上也能找到不少<span style="word-wrap: normal; word-break: normal">WebRTC</span>应用项目的源码。有些<span style="word-wrap: normal; word-break: normal">demo</span>是直接调用<span style="word-wrap: normal; word-break: normal">WebRTC API</span>开发的，但大多数是调用上述两种<span style="word-wrap: normal; word-break: normal">WebRTC</span>封装库开发的。由于<span style="word-wrap: normal; word-break: normal">WebRTC API</span>的名称在不同浏览器及同一浏览器的不同版本之间存在差异，所以不是所有<span style="word-wrap: normal; word-break: normal">demo</span>都能运行在所有浏览器上。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">为了找到一个可在公司局域网环境中跑在手机上的<span style="word-wrap: normal; word-break: normal">WebRTC demo</span>，本人试用了不少<span style="word-wrap: normal; word-break: normal">demo</span>，下面选几个有代表性的介绍，其中有两个经修改后已在本人公司的局域网环境中运行成功。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">先说一下本人的测试环境：手机上的浏览器是<span style="word-wrap: normal; word-break: normal">Chrome for Android 26.0.1410.49</span>，运行在<span style="word-wrap: normal; word-break: normal">Android 4.1.2</span>上，这个<span style="word-wrap: normal; word-break: normal">Chrome</span>版本本身是<span style="word-wrap: normal; word-break: normal">beta</span>版，支持<span style="word-wrap: normal; word-break: normal">WebRTC</span>但缺省是关闭<span style="word-wrap: normal; word-break: normal">WebRTC</span>功能的，需要在<span style="word-wrap: normal; word-break: normal">chrome://flags</span>中使能<span style="word-wrap: normal; word-break: normal">WebRTC</span>并重启<span style="word-wrap: normal; word-break: normal">Chrome</span>，或者在启动<span style="word-wrap: normal; word-break: normal">Chrome</span>时增加命令行选项<span style="word-wrap: normal; word-break: normal">--enable-webrtc</span>。本人在<span style="word-wrap: normal; word-break: normal">PC</span>上运行<span style="word-wrap: normal; word-break: normal">WebRTC</span>的浏览器是<span style="word-wrap: normal; word-break: normal">Chrome 26.0.1410.43</span>，操作系统是<span style="word-wrap: normal; word-break: normal">Windows 7</span>。</span></p><h2 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">3.1<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;</span></span></span><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><a style="text-decoration: none; color: #566053" href="http://www.webrtc.org/demo"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">http://www.webrtc.org/demo</span></a><a style="text-decoration: underline; color: #566053" name="_Toc353542672"></a></span><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px; font-family: 黑体">（</span><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">https://apprtc.appspot.com/</span></span><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px; font-family: 黑体">）</span></span></h2><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">这是官方的<span style="word-wrap: normal; word-break: normal">demo</span>，功能很全，可惜不知为何<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="https://apprtc.appspot.com/">https://apprtc.appspot.com/</a></span>这个网址已经连不上了，不过其源码还是可以下载到的，在<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="https://code.google.com/p/webrtc-samples/">https://code.google.com/p/webrtc-samples/</a></span>。此<span style="word-wrap: normal; word-break: normal">demo</span>没有用任何封装库。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">这个<span style="word-wrap: normal; word-break: normal">demo</span>所使用的信令机制使用了<span style="word-wrap: normal; word-break: normal">XHR</span>和<span style="word-wrap: normal; word-break: normal">Google App Engine Channel API</span>&nbsp;，具体我不懂。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">在我的公司局域网环境里无法运行该<span style="word-wrap: normal; word-break: normal">demo</span>。</span></p><h2 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 30.909090042114258px"><a style="text-decoration: underline; color: #566053" name="_Toc353542673"></a><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">3.2<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px; font-family: 黑体">爱立信实验室开发的</span><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">WebRTC demo</span></h2><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">据说是第一个基于浏览器的<span style="word-wrap: normal; word-break: normal">WebRTC</span>视频通信<span style="word-wrap: normal; word-break: normal">demo</span>，爱立信为此还开发了一个浏览器用于支持<span style="word-wrap: normal; word-break: normal">WebRTC</span>，好象也是基于<span style="word-wrap: normal; word-break: normal">WebKit</span>的，叫做<span style="word-wrap: normal; word-break: normal">Bowser browser</span>（当时市场上可能还没有支持<span style="word-wrap: normal; word-break: normal">WebRTC</span>的浏览器），该项目网址是<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="https://labs.ericsson.com/apps/bowser">https://labs.ericsson.com/apps/bowser</a></span>。这个<span style="word-wrap: normal; word-break: normal">Bowser browser</span>好象只支持<span style="word-wrap: normal; word-break: normal">Ubuntu 11.04 and 11.10</span>（见<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="https://labs.ericsson.com/apis/web-real-time-communication/downloads">https://labs.ericsson.com/apis/web-real-time-communication/downloads</a></span>）。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">该<span style="word-wrap: normal; word-break: normal">demo</span>的网址是<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://webrtc.labs.ericsson.net:8082/">http://webrtc.labs.ericsson.net:8082</a></span>。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">在我的公司局域网环境里无法运行该<span style="word-wrap: normal; word-break: normal">demo</span>。</span></p><h2 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 30.909090042114258px"><a style="text-decoration: underline; color: #566053" name="_Toc353542674"></a><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">3.3<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px; font-family: 黑体">人脸检测识别</span></h2><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">利用<span style="word-wrap: normal; word-break: normal">WebRTC</span>的<span style="word-wrap: normal; word-break: normal">getUserMedia</span>从摄像头获取图像进行人脸识别的<span style="word-wrap: normal; word-break: normal">demo</span>，例如这两个：</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体"><a style="text-decoration: none; color: #566053" href="http://neave.com/webcam/html5/face/">http://neave.com/webcam/html5/face/</a></span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体"><a style="text-decoration: none; color: #566053" href="http://www.raymondcamden.com/demos/2012/mar/29/test1.html">http://www.raymondcamden.com/demos/2012/mar/29/test1.html</a></span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">这两个<span style="word-wrap: normal; word-break: normal">demo</span>在<span style="word-wrap: normal; word-break: normal">PC</span>和手机上的<span style="word-wrap: normal; word-break: normal">Chrome</span>上都可运行。</span></p><h2 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 30.909090042114258px"><a style="text-decoration: underline; color: #566053" name="_Toc353542675"></a><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">3.4<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">http://www.simpl.info</span></h2><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">这个<span style="word-wrap: normal; word-break: normal">demo</span>演示<span style="word-wrap: normal; word-break: normal">HTML, CSS and JavaScript</span>的各种<span style="word-wrap: normal; word-break: normal">feature</span>和使用方法，包括<span style="word-wrap: normal; word-break: normal">WebRTC</span>的<span style="word-wrap: normal; word-break: normal">3</span>个<span style="word-wrap: normal; word-break: normal">API</span>：<span style="word-wrap: normal; word-break: normal">getUserMedia</span>、<span style="word-wrap: normal; word-break: normal">RTCPeerConnection</span>、<span style="word-wrap: normal; word-break: normal">RTCDataChannel</span>的演示，但遗憾的是<span style="word-wrap: normal; word-break: normal">RTCPeerConnection</span>的演示只是本地<span style="word-wrap: normal; word-break: normal">camera</span>的画面传回给本地，并没有实现真正的设备之间音视频通信。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">该项目的源码在<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="https://github.com/samdutton/simpl">https://github.com/samdutton/simpl</a></span>。</span></p><h2 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 30.909090042114258px"><a style="text-decoration: underline; color: #566053" name="_Toc353542676"></a><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">3.5<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">Framegrabber</span></h2><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">这是一个基于<span style="word-wrap: normal; word-break: normal">WebRTC</span>实现屏幕共享（<span style="word-wrap: normal; word-break: normal">screensharing</span>）的<span style="word-wrap: normal; word-break: normal">Chrome</span>扩展，源码在<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="https://github.com/samdutton/rtcshare">https://github.com/samdutton/rtcshare</a></span>，有关介绍可参考这篇文章：<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://blog.sina.com.cn/s/blog_51396f890102es7k.html">http://blog.sina.com.cn/s/blog_51396f890102es7k.html</a></span>。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">本人没有试用过。</span></p><h2 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 30.909090042114258px"><a style="text-decoration: underline; color: #566053" name="_Toc353542677"></a><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">3.6<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">http://webrtc.dennis.is</span></h2><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">这个<span style="word-wrap: normal; word-break: normal">demo</span>是基于库<span style="word-wrap: normal; word-break: normal">webrtc.io</span>实现的，是<span style="word-wrap: normal; word-break: normal">webrtc.io</span>官方的<span style="word-wrap: normal; word-break: normal">demo</span>，使用<span style="word-wrap: normal; word-break: normal">WebSocket</span>作为信令手段。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">在我的公司局域网环境里无法运行该<span style="word-wrap: normal; word-break: normal">demo</span>；在家里无线路由器环境下可成功运行，但只能单向传输视频。</span></p><h2 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 30.909090042114258px"><a style="text-decoration: underline; color: #566053" name="_Toc353542678"></a><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">3.7<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">http://v.kainy.cn</span></h2><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">国内牛人做的，相当于是汉化版的<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://webrtc.dennis.is/">http://webrtc.dennis.is</a></span>，自然也是基于<span style="word-wrap: normal; word-break: normal">webrtc.io</span>实现的，但使用的<span style="word-wrap: normal; word-break: normal">webrtc.io</span>版本较老，不支持新版本<span style="word-wrap: normal; word-break: normal">Chrome</span>所使用的<span style="word-wrap: normal; word-break: normal">API</span>名称<span style="word-wrap: normal; word-break: normal">webkitRTCPeerConnection</span>，所以无法在新版本<span style="word-wrap: normal; word-break: normal">Chrome</span>上运行。具体介绍在<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://blog.kainy.cn/2013/01/webrtc%E5%AE%9E%E7%8E%B0%E7%9A%84%E8%A7%86%E9%A2%91%E8%81%8A%E5%A4%A9%E5%AE%A4%E5%BA%94%E7%94%A8/">http://blog.kainy.cn/2013/01/webrtc<span style="word-wrap: normal; word-break: normal"><span style="word-wrap: normal; word-break: normal">实现的视频聊天室应用/</span></span></a></span>。</span></p><h2 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 30.909090042114258px"><a style="text-decoration: underline; color: #566053" name="_Toc353542679"></a><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">3.8<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">http://conversat.io</span></h2><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">这个<span style="word-wrap: normal; word-break: normal">demo</span>是基于库<span style="word-wrap: normal; word-break: normal">SimpleWebRTC</span>实现的，是<span style="word-wrap: normal; word-break: normal">SimpleWebRTC</span>官方的<span style="word-wrap: normal; word-break: normal">demo</span>，使用<span style="word-wrap: normal; word-break: normal">WebSocket</span>作为信令手段。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">在我的公司局域网环境里无法运行该<span style="word-wrap: normal; word-break: normal">demo</span>；在家里无线路由器环境下可成功运行，且可双向传视频，支持多个<span style="word-wrap: normal; word-break: normal">peer</span>同时视频通信。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">经修改后在本人公司局域网成功运行，试过两个手机和一个笔记本电脑同时视频通信<span style="word-wrap: normal; word-break: normal">OK</span>。修改和运行步骤：</span></p><p style="margin: 0cm 0cm 6pt 39pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: -18pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体"><span style="word-wrap: normal; word-break: normal">1.<span style="word-wrap: normal; word-break: normal; line-height: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; font-family: 宋体">从<span style="word-wrap: normal; word-break: normal">http://www.nodejs.org/download/</span>下载<span style="word-wrap: normal; word-break: normal">nodejs</span>最新版并安装，我是在<span style="word-wrap: normal; word-break: normal">Windows7 64</span>位上安装的；</span></p><p style="margin: 0cm 0cm 6pt 39pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: -18pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体"><span style="word-wrap: normal; word-break: normal">2.<span style="word-wrap: normal; word-break: normal; line-height: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; font-family: 宋体">在命令行下依次运行如下命令（安装运行<span style="word-wrap: normal; word-break: normal">signaling server</span>所需的模块）：</span></p><p style="margin: 0px 0px 5px 42pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">npm install express</span></p><p style="margin: 0px 0px 5px 42pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">npm install yetify</span></p><p style="margin: 0px 0px 5px 42pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">npm install getconfig</span></p><p style="margin: 0px 0px 5px 42pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">npm install node-uuid</span></p><p style="margin: 0cm 0cm 6pt 42pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">npm install socket.io</span></p><p style="margin: 0cm 0cm 6pt 39pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: -18pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体"><span style="word-wrap: normal; word-break: normal">3.<span style="word-wrap: normal; word-break: normal; line-height: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; font-family: 宋体">从<span style="word-wrap: normal; word-break: normal">https://github.com/andyet/signalmaster</span>下载信令服务器源码，该信令服务器是<span style="word-wrap: normal; word-break: normal">SimpleWebRTC</span>缺省使用的，解开该源码后运行<span style="word-wrap: normal; word-break: normal">node server.js</span>，该服务器监听<span style="word-wrap: normal; word-break: normal">8888</span>端口，通过<span style="word-wrap: normal; word-break: normal">WebSocket</span>与浏览器通信。</span></p><p style="margin: 0cm 0cm 6pt 39pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: -18pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体"><span style="word-wrap: normal; word-break: normal">4.<span style="word-wrap: normal; word-break: normal; line-height: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; font-family: 宋体">在同一台<span style="word-wrap: normal; word-break: normal">PC</span>上运行<span style="word-wrap: normal; word-break: normal">apache server</span>，将从<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://conversat.xn--ioserver-v39lz9evvo6p4c56hf3a38rv11etnpl4sju8c/"><span style="word-wrap: normal; word-break: normal; color: windowtext">http://conversat.io</span><span style="word-wrap: normal; word-break: normal; color: windowtext"><span style="word-wrap: normal; word-break: normal">网站扒下来的文件放到该server</span></span></a></span>上（可在<span style="word-wrap: normal; word-break: normal">Chrome</span>浏览器中打开<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://conversat.io/">http://conversat.io</a></span>然后鼠标右键单击在菜单中选&ldquo;另存为&rdquo;、&ldquo;网页，全部&rdquo;即可），修改其中的&nbsp;<span style="word-wrap: normal; word-break: normal">index.html</span>&nbsp;和&nbsp;<span style="word-wrap: normal; word-break: normal">simplewebrtc.js</span>，将其中&nbsp;<span style="word-wrap: normal; word-break: normal">url</span>&nbsp;改为<span style="word-wrap: normal; word-break: normal">'http://10.100.156.83:8888'</span>（其中<span style="word-wrap: normal; word-break: normal">IP</span>地址是我的<span style="word-wrap: normal; word-break: normal">PC</span>在公司局域网中的<span style="word-wrap: normal; word-break: normal">IP</span>地址）。</span></p><p style="margin: 0cm 0cm 6pt 39pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: -18pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体"><span style="word-wrap: normal; word-break: normal">5.<span style="word-wrap: normal; word-break: normal; line-height: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; font-family: 宋体">在同一局域网中的其他设备上打开<span style="word-wrap: normal; word-break: normal">Chrome</span>浏览器，地址栏输入<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://10.100.156.83/">http://10.100.156.83</a></span>，输入相同的<span style="word-wrap: normal; word-break: normal">room</span>名称（随便起）即可开始多方视频通信，也可修改上述<span style="word-wrap: normal; word-break: normal">index.html</span>中的&ldquo;<span style="word-wrap: normal; word-break: normal">var room</span>&rdquo;一行，设定为固定的<span style="word-wrap: normal; word-break: normal">room</span>名称，就不需要每次在每个设备上手工输入<span style="word-wrap: normal; word-break: normal">room</span>名称了。</span></p><h2 style="margin: 0px 0px 0px 0cm; padding: 0px; border: 0px; list-style: none; color: #494949; font-family: simsun; text-indent: 0cm; background-color: #c1cfd0; line-height: 30.909090042114258px"><a style="text-decoration: underline; color: #566053" name="_Toc353542680"></a><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px"><span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px">3.9<span style="word-wrap: normal; word-break: normal; line-height: normal; font-weight: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 30.909090042114258px; font-family: 黑体">国内牛人开发的视频聊天室应用</span></h2><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">这个<span style="word-wrap: normal; word-break: normal">demo</span>是国内牛人赵书剑开发的视频聊天室，基于<span style="word-wrap: normal; word-break: normal">webrtc.io</span>实现。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">该项目源码和文档下载地址是<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://ishare.iask.sina.com.cn/f/35083616.html">http://ishare.iask.sina.com.cn/f/35083616.html</a></span>，源码在<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="https://github.com/zsj2145676">https://github.com/zsj2145676</a></span>。</span></p><p style="margin: 0px 0px 6pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体">经修改后在本人公司局域网成功运行，试过两个手机和一个笔记本电脑同时视频通信<span style="word-wrap: normal; word-break: normal">OK</span>。修改和运行步骤：</span></p><p style="margin: 0cm 0cm 6pt 39pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: -18pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体"><span style="word-wrap: normal; word-break: normal">1.<span style="word-wrap: normal; word-break: normal; line-height: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; font-family: 宋体">从<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://ishare.iask.sina.com.cn/f/35083616.html">http://ishare.iask.sina.com.cn/f/35083616.html</a></span>下载<span style="word-wrap: normal; word-break: normal">webrtc.chatdemo.zip</span>，解压缩，修改其中<span style="word-wrap: normal; word-break: normal">public&#92;javascripts&#92;client.js</span>中的<span style="word-wrap: normal; word-break: normal">rtc.connect</span>一行，将实际的服务器地址写进去，例如改为：<span style="word-wrap: normal; word-break: normal">rtc.connect(&quot;ws://10.100.156.83:8001&quot;, room);</span></span></p><p style="margin: 0cm 0cm 6pt 39pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: -18pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体"><span style="word-wrap: normal; word-break: normal">2.<span style="word-wrap: normal; word-break: normal; line-height: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; font-family: 宋体">同上文<span style="word-wrap: normal; word-break: normal">3.8</span>节步骤<span style="word-wrap: normal; word-break: normal">1</span>、<span style="word-wrap: normal; word-break: normal">2</span>安装<span style="word-wrap: normal; word-break: normal">nodejs</span></span></p><p style="margin: 0cm 0cm 6pt 39pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: -18pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体"><span style="word-wrap: normal; word-break: normal">3.<span style="word-wrap: normal; word-break: normal; line-height: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; font-family: 宋体">运行<span style="word-wrap: normal; word-break: normal">node app.js</span>，注意该<span style="word-wrap: normal; word-break: normal">demo</span>本身已包含<span style="word-wrap: normal; word-break: normal">http server</span>，不需要其他的比如<span style="word-wrap: normal; word-break: normal">apache server</span></span></p><p style="margin: 0cm 0cm 6pt 39pt; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 20px; color: #494949; font-family: simsun; font-size: 13.63636302947998px; background-color: #c1cfd0; text-indent: -18pt"><span style="word-wrap: normal; word-break: normal; font-family: 宋体"><span style="word-wrap: normal; word-break: normal">4.<span style="word-wrap: normal; word-break: normal; line-height: normal; font-size: 7pt; font-family: 'Times new roman'">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; font-family: 宋体">在同一局域网中的其他设备上打开<span style="word-wrap: normal; word-break: normal">Chrome</span>浏览器，地址栏输入<span style="word-wrap: normal; word-break: normal"><a style="text-decoration: none; color: #566053" href="http://10.100.156.83:8000/">http://10.100.156.83:8000</a></span>，输入相同的<span style="word-wrap: normal; word-break: normal">room</span>名称（随便起）即可开始多方视频通信。</span></p>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5499</link>
<title><![CDATA[SIP和H.323协议应用分析]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[音视频与流媒体]]></category>
<pubDate>Wed, 09 Oct 2013 07:19:28 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5499</guid> 
<description>
<![CDATA[ 
	<p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px"><strong style="text-align: center">一、引言</strong></p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">H.323和SIP分别是通信领域与因特网两大阵营推出的协议。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">SIP（会话初始协议）的开发目的是用来帮助提供跨越因特网的高级电话业务。因特网电话（IP电话）正在向一种正式的商业电话模式演进，SIP就是用来确保这种演进实现而需要的NGN（下一代网络）系列协议中重要的一员。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">H.323协议的开发目的是用来的分组交换网络上为用户提供取代普通电话的VoIP业务和视频通信系统。 这两种协议定位有一定的重合，并且随着协议向纵深发展和Internet、Intranet的快速发展，这种重合竞争的关系日益加剧。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">本文从协议本身和应用的角度上对这两种协议进行了初步的分析和比较，并对将来的发展方向做了初步的预测。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px"><strong style="text-align: center">&nbsp;二、SIP概述</strong></p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">SIP（Session Initiation Protocal）称为会话初始协议，是由IETF（Internet Engineering Task Force）组织于1999年提出的，是一个在基于IP网络中，特别是在Internet这样一种结构的网络环境中，实现实时通信应用的一种信令协议。而所谓的会话（Session），就是指用户之间的数据交换。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">在基于SIP的应用中，每一个会话可以是各种不同类型的内容，可以是普通的文本数据，也可以是经过数字化处理的音频、视频数据，还可以是诸如游戏等应用的数据，应用具有巨大的灵活性。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">作为一个IETF提出的标准，SIP在很大程度上借鉴了其他各种广泛存在的Internet协议，如HTTP（超文本传输协议）、SMTP（简单邮件传输协议）等；和这些协议一样，SIP也采用基于文本的编码方式，这也是SIP同视频通信领域其他现有标准相比最大的特点之一。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">由于网络环境以及相关多媒体技术的不足，在SIP首次提出的时候，仅仅针对各种文本应用，随着技术的发展，并通过和IETF中IP电话工作组（IPTEL）、IP网中电话选路（TRIP）工作组等兄弟工作组配合工作，在SIP中大大加强了对多媒体通信的支持。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">由于Internet的飞速发展，在最近的两年时间内，SIP已经开始被ITU-T SG16、ETSI TIPON（欧洲标准化组织），IMTE等各种标准化组织所接受，并在这些组织中成立了与SIP相关的工作组。特别是作为ITU-T SG16主要成员，在多年发展H.323应用的基础上，针对SIP应用在视频领域的特点，提出了SIP的应用指导，并推出了相应的SIP协议栈，使得ITU的成员实现了这两种协议之间的互通性。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px"><strong style="text-align: center">&nbsp;三、SIP系统基本结构</strong></p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">按逻辑功能区分，SIP系统由4种元素组成：用户代理，SIP代理服务器，重定向服务器和SIP注册服务器。 SIP用户代理：又称为SIP终端，是SIP系统中的最终用户，在RFC3261中将它们定义为一个应用。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">根据它们在会话中扮演的角色的不同，又可分为用户代理客户机（UAC）和用户代理服务器（UAS）两种。其中前者用于发起呼叫请求，后者用于响应呼叫请求。 SIP代理服务器（SIP Proxy Server）：是一个中间元素，它既是一个客户机又是一个服务器，具有解析名字的能力，能够代理前面的用户向下一跳服务器发出呼叫请求。然后服务器决定下一跳的地址。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">重定向服务器（Redirect Server）：是一个规划SIP呼叫路径的服务器，在获得了下一跳的地址后，立刻告诉前面的用户，让该用户直接向下一跳地址发出请求而自己则退出对这个呼叫的控制。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">SIP注册服务器（SIP Register Server）：用来完成对UAS的登录，在SIP系统的网元中，所有UAS都要在某个登录服务器中登录，以便UAC通过服务器能找到它们。 SIP在设计上充分考虑了对其他协议的扩展适应性。它支持许多种地址描述和寻址，包括用户名@主机地址，被叫号码@PSTN网关地址，Tel：010-62281234普通电话的描述等。这样，SIP主叫按照被叫地址就可以识别出被叫在传统电话网上的位置，然后通过一个与传统电话网相连的网关发起并建立呼叫。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">SIP最强大之处就是用户定位功能，SIP本身含有向注册服务器注册的功能，也可以利用其他定位服务器DNS、LDAP等提供的定位服务来增强其定位功能。 SIP共规定了六种信令：INVITE、ACK、CANCEL、OPTIONS、BYE、REGISTER。其中INVITE和ACK用于建立呼叫，完成三次握手，或者用于建立以后改变会话属性；BYE用以结束会话；OPTIONS用于查询服务器能力；CANCEL用于取消已经发出但未最终结束的请求；REGISTER用于客户出向注册服务器注册用户位置等消息。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">SIP支持三种呼叫方式：由用户代理服务机（UAC）向用户代理服务器（UAS）直接呼叫，由UAC在重定向服务器的辅助下进行重定向呼叫和由代理服务器代表UAC向被叫发起呼叫。图1(详图见2005第三期杂志)是一个SIP呼叫建立过程的示意图，具体步骤如下所示。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">（1）SIP用户代理向SIP代理服务器发送呼叫建立请求（INVITE）；</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">（2）SIP代理服务器向重定向服务器发送呼叫建立请求；</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">（3）重定向服务器返回重定向消息；</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">（4）SIP代理服务器向重定向服务器指定的SIP代理服务器发送呼叫建立请求；</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">（5）被请求的SIP代理服务器使用非SIP，例如域名查询或者LDAP等到定位服务器查询被叫位置；</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">（6）定位服务器返回被叫位置（被叫SIP代理服务器）；</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">（7）被请求的SIP代理服务器向被叫SIP代理服务器发送呼叫建立请求；</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">（8）被叫SIP代理服务器向SIP用户代理（被叫）发呼叫建立请求（被叫振铃或显示）；</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">（9）被叫用户代理向被叫SIP用户代理服务器发同意或拒绝；</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">（10）被叫用户代理服务器向主叫代理服务器所请求的代理服务器发同意或拒绝；</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">（11）主叫代理服务器所请求的代理服务器向主教代理服务器发同意或拒绝；</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">（12）主叫代理服务器向主叫SIP用户代理指示被叫是否同意呼叫请求。呼叫建立后双方根据协商得到的媒体和压缩算法等信息相互通信。呼叫拆除过程类似于建立过程，在这里不再描述。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px"><strong style="text-align: center">&nbsp;四、H.323协议概论</strong></p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">为了能在不保证QoS的分组交换网络上展开多媒体会议，H.323制定了无QoS保证的分组网络PBN（Packet Based Networks）上的多媒体通信系统标准，这些分组网络主宰了当今的桌面网络系统，包括基于TCP/IP、IPX分组交换的以太网、快速以太网、令牌网、FDDI技术。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">因此，H.323标准为LAN、WAN、Internet、因特网上的多媒体通信应用提供了技术基础和保障。 ITU 的H.323系列建议定义了在Internet或其他包交换网络上多媒体通信的协议及其规程。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">它包括用于控制的H.245，用于建立连接的H.225.0，用于大型会议的H.332 ，用于扩充业务的H.450.1、 H.450.2和 H.HH.450.3，有关安全的 H.235，与电路交换业务互操作的H.246。H.323最初是作为局域网上，不保证服务质量的多媒体通信协议而提出的，但是慢慢发展并逐渐成为满足 Internet电话技术复杂要求的协议系列。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">H.323很大程度上建立在ITU以前的有关多媒体的协议基础上，包括用于ISDN的H.320，用于B-ISDN的H.321和用于PSTN终端的H.324等建议的基础之上。其编码机制、协议范围和基本操作类似于ISDN的Q.931信令协议的简化版本。 从整体上来说，H.323是一个框架性建设，它涉及到终端设备、视频、音频和数据传输、通信控制、网络接口方面的内容，还包括了组成多点会议的多点控制单元（MCU）、多点控制器（MC）、多点处理器（MP）、网关以及关守等设备。其体系结构如图2所示。(详图见2005第三期杂志)</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px"><strong style="text-align: center">五、H.323标准结构</strong></p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">H.323协议族是一个有机的整体，根据功能可以分为四类，也就是说该协议从系统的总体框架（H.323）、视频编解码（H.263）、音频编解码（H.723.1）、系统控制（H.245）、数据流的复用（H.225）等各方面做了比较详细的规定，为网络电话和可视电话会议系统的进一步发展和系统的兼容性提供了良好的条件。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">系统控制协议包括H.245、H.225.0协议。整个系统控制由H.245控制信道、H.225.0呼叫信令信道和RAS（注册、许可、状态）信道提供，音频编解码协议包括G.711协议（必选）、G.722、G.723.1、G.728、G.729等协议。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">编码器使用的音频标准必须由H.245协议协商确定。H.323终端应由对本身所具有的音频编解码能力进行非对称操作，如以G.711发送，以G.729接收。 视频编解码协议主要包括H.261协议（必选）和H.263协议。H.323系统中视频功能是可选的，2003年，ITU发布了H.264视频编码协议，H.264协议将逐步成为主流的视频编码格式。 H.323协议族中，数据会议功能也是可选的，其标准是多媒体会议数据协议T.120。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">另外，H.323协议族中还提供了H.450补充业务协议族，完成一些呼叫补充业务，包括呼叫转接、呼叫等待等。（整个H.323协议族的结构，具体见《中国多媒体视讯》2004年第3期P42页）。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">H.225.0是一个框架协议，遵循H.323V2标准，包含了RAS和Q.931两部分，描述了为在分组网络上的H.323设备之间传送音频、视频、数据和控制信息而进行关联、编码及分组的方法。H.225.0负责协议和消息格式的描述。 H.225.0把RTP/RTCP用于所有下层分组网络媒体流的分组和同步，H.225.0假定了一个初始信令是建立在非RTP传输地址之上的呼叫模型，并把此呼叫模型用于呼叫建立和能力协商（见H.323和H.245），这之后将建立一个或多个RTP/RTCP连接。H.225.0包含RTP/RTCP的详细使用方法。 RAS是端点和GK之间的协议，利用H.225.0消息来执行在端点和GK之间的注册、接入、带宽改变、状态、以及脱离过程。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">Q.931呼叫信令是H.225.0中用于在两个H.323端点之间建立呼叫连接的控制信令。当整个网络中有GK时，其初始接入消息在主叫端点与GK之间，利用GK的RAS信道传输地址进行交换。在初始接入消息交换时，GK在ACF消息中指示了其他端点的呼叫信令传输地址，主叫端口根据此地址与其他端口建立呼叫。整个H.323呼叫流程如图3所示。(详图见2005第三期杂志)</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px"><strong style="text-align: center">六、SIP和H.323应用优势与劣势</strong></p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">H.323企图把IP电话当作是众所周知的传统电话，只是传输方式发生了改变，由电路交换变成了分组交换，H.323是一个相对复杂的协议。SIP侧重于将IP电话作为因特网上的一个应用，较其实际应用（如FTP、E-mail等）增加了信令和QoS的要求，它们支持的业务基本相同，也都利用RTP作为媒体传输的协议。 H.323和SIP是有一定竞争关系的两个协议，表1对其进行对比分析。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px"><strong style="text-align: center">七、结束语</strong></p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">总之，H.323沿用的是传统的实现电话信令模式，比较成熟。H.323符合通信领域传统的设计思想，进行集中、层次控制，采用其便于与传统的电话网相连。SIP借鉴了其他因特网的标准和协议的设计思想，在风格上遵循因特网一贯坚持的简练、开放、兼容和可扩展等原则，比较简单，但推出时间较短，协议本身还需要随着业务的发展而进一步优化。</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">从技术发展的角度上看，由于SIP天生的技术优势，在主流厂商的支持和克服当前一些技术难题后，SIP的应用前景将更加明朗。但是在短期内，SIP支持的业务还是主要集中在VoIP和点对点视频通信领域，基于多点视讯会议的业务还是以H.323、H.320协议为主。</p>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5498</link>
<title><![CDATA[几种开源SIP协议栈对比]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[音视频与流媒体]]></category>
<pubDate>Wed, 09 Oct 2013 06:28:40 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5498</guid> 
<description>
<![CDATA[ 
	<p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">随着VoIP和NGN技术的发展，H.323时代即将过渡到SIP时代，在H.323的开源协议栈中，Openh323占统治地位，它把一个复杂而又先进的H.323协议栈展现在普通程序员的眼前，为H.323普及立下了汗马功劳。而然当在SIP时代，则出现了群雄割据的状况，SIP相对于H.323简单，灵活，于是各种协议栈层出不穷，下面将详细对比最具有代表性的5个开源项目：OPAL,VOCAL,sipX,ReSIProcate,oSIP</p><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">OPAL是Open Phone Abstraction Library，是Openh323的下一个版本，它仍然使用了Openh323的体系结构，并在其基础上进行扩展，同时实现了SIP,H.323，但在音频和视频的编码和传输部分有较大改动。OPAL初衷设计是包含任何电话通信协议，所以其底层进行了高度的抽象化，所以也能够很容易的支持MGCP,PSTN和将来会出现的协议。不过由于Openh323的最后一个版本还在开发中，所以原本6月发布的OPAL也被推迟，现有的OPAL还非常不完善，BUG也非常多，不过相信以Openh323的开发班底，一定能让OPAL十分优秀。</p><table border="1" cellspacing="0" cellpadding="2" width="400" align="center" style="color: #333333; font-family: 宋体; font-size: 14px; line-height: 28px; background-color: #f8f8f8"><tbody><tr><td class="code" style="margin: 0px; padding: 0px" bgcolor="#e6e6e6"><pre style="margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 464.296875px; overflow: auto">CVS : :pserver:anonymous@cvs.sourceforge.net:/cvsroot/openh323/opal<br />Language : C++<br />VxWorks port : Yes <br />Win32 port : Yes <br />Linux port : Yes <br />Supports RFC 3261 : Yes <br />Supports RFC 2327 : Yes <br />Supports RFC 3264 : Yes <br />Supports RFC 3263 : No <br />Supports RFC 3515 : Yes <br />Supports RFC 3262 : No <br />Supports RFC 3311 : No <br />TCP : Yes <br />UDP : Yes <br />SIZE :&nbsp; 8MB<br />License : MPL<br />Document : None<br />Samples : UA,GK</pre></td></tr></tbody></table><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">VOCAL是vovida.org开发的SIP系统，VOCAL应该是目前功能最完善，使用者最多的开源SIP协议栈了.它不只包括了协议栈，还包括了h323与sip转换网关，对SIP的各种Server的功能支持也非常完善.不过很可惜，不支持windows平台，而且自从vovida被CISCO收购以后就停止了开发，最后的版本是2003年4月的1.5.0。</p><table border="1" cellspacing="0" cellpadding="2" width="400" align="center" style="color: #333333; font-family: 宋体; font-size: 14px; line-height: 28px; background-color: #f8f8f8"><tbody><tr><td class="code" style="margin: 0px; padding: 0px" bgcolor="#e6e6e6"><pre style="margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 392.03125px; overflow: auto">CVS : :pserver:anonymous@cvs.vovida.org:/cvsroot/vocal<br />Language : C++<br />VxWorks port : No <br />Win32 port : Partial <br />Linux port : Yes <br />Supports RFC 3261 : Partial <br />Supports RFC 2327 : Yes <br />Supports RFC 3264 : <br />Supports RFC 3263 : <br />Supports RFC 3515 : Yes <br />Supports RFC 3262 : <br />Supports RFC 3311 : <br />TCP : Yes <br />UDP : Yes <br />SIZE : 6MB<br />License: Vovida software licencse<br />Document : Few<br />Samples : UA,GK,GW</pre></td></tr></tbody></table><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">sipX是一个SIP系统，由SIPFoundry开发。sipX是从reSIProcate分离出来的，sipX除了包括SIP stack外，还包括了sipXphone,sipXproxy,sipXregistry等等...,由它们构成了完整的SIP系统，而且sipx还支持嵌入式系统，各个模块可以按需取舍。不过可惜是几乎没有任何开发文档。</p><table border="1" cellspacing="0" cellpadding="2" width="400" align="center" style="color: #333333; font-family: 宋体; font-size: 14px; line-height: 28px; background-color: #f8f8f8"><tbody><tr><td class="code" style="margin: 0px; padding: 0px" bgcolor="#e6e6e6"><pre style="margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 392.03125px; overflow: auto">SVN : <a style="color: #004276; text-decoration: none; background-image: none; border: none; padding: 0px; margin: 0px" href="http://scm.sipfoundry.org/viewsvn/">http://scm.sipfoundry.org/viewsvn/</a><br />Language : C++<br />VxWorks port : Yes <br />Win32 port : Yes <br />Linux port : Yes <br />Supports RFC 3261 : Yes <br />Supports RFC 2327 : Yes <br />Supports RFC 3264 : Yes <br />Supports RFC 3263 : Yes <br />Supports RFC 3515 : Yes <br />Supports RFC 3262 : No <br />Supports RFC 3311 : No <br />TCP : Yes <br />UDP : Yes <br />SIZE : &lt;4 Mb <br />License : LGPL <br />Document : None<br />Samples : UA,GK,GW</pre></td></tr></tbody></table><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">ReSIProcate同样也是由SIPFoundry开发，ReSIProcate最开始起源于Vocal,由于Vocal开始只支持rfc3254，为了支持最新的rfc3261,ReSIProcate诞生了，但现在，ReSIProcate已经成为一个独立SIP协议栈了，它十分稳定，并且很多商业程序都在使用。</p><table border="1" cellspacing="0" cellpadding="2" width="400" align="center" style="color: #333333; font-family: 宋体; font-size: 14px; line-height: 28px; background-color: #f8f8f8"><tbody><tr><td class="code" style="margin: 0px; padding: 0px" bgcolor="#e6e6e6"><pre style="margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 422.71875px; overflow: auto">SVN : <a style="color: #004276; text-decoration: none; background-image: none; border: none; padding: 0px; margin: 0px" href="http://scm.sipfoundry.org/viewsvn/resiprocate/main/sip/">http://scm.sipfoundry.org/viewsvn/resiprocate/main/sip/</a><br />Language : C++<br />VxWorks port : No <br />Win32 port : Yes <br />Linux port : Yes <br />Supports RFC 3261 : Yes <br />Supports RFC 2327 : Yes <br />Supports RFC 3264 : Yes <br />Supports RFC 3263 : Partial <br />Supports RFC 3515 : Yes <br />Supports RFC 3262 : No <br />Supports RFC 3311 : No <br />TCP : Yes <br />UDP : Yes <br />SIZE : &lt; 2.5 Mb <br />License : Vovida <br />Document : Few<br />Samples : None</pre></td></tr></tbody></table><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">oSIP的开发开始于2000年7月，第一个版本在2001年5月发布，到现在已经发展到2.0.9了。它采用ANSI C编写，而且结构简单小巧，所以速度特别快，它并不提供高层的SIP会话控制API,它主要提供一些解析SIP/SDP消息的API和事务处理的状态机，oSIP的作者还开发了基于oSIP的UA</p><table border="1" cellspacing="0" cellpadding="2" width="400" align="center" style="color: #333333; font-family: 宋体; font-size: 14px; line-height: 28px; background-color: #f8f8f8"><tbody><tr><td class="code" style="margin: 0px; padding: 0px" bgcolor="#e6e6e6"><pre style="margin-top: 0px; padding: 0px; font-family: 'Courier New', monospace; font-size: 12px; width: 392.03125px; overflow: auto">lib:exosip和proxy server lib:partysip.<br />CVS : :ext:anoncvs@savannah.gnu.org:/cvsroot/osip<br />Language : C<br />VxWorks port : Yes <br />Win32 port : Yes <br />Linux port : Yes <br />Supports RFC 3261 : Yes <br />Supports RFC 2327 : Yes <br />Supports RFC 3264 : Yes <br />Supports RFC 3263 : Yes<br />Supports RFC 3515 : No <br />Supports RFC 3262 : No <br />Supports RFC 3311 : Yes <br />TCP : Yes<br />UDP : Yes<br />SIZE : 400kb <br />License : LGPL<br />Samples : UA,GK</pre></td></tr></tbody></table><p style="margin: 10px 0px; padding: 0px; color: #333333; background-color: #f8f8f8; text-indent: 28px; font-family: 宋体; font-size: 14px; line-height: 28px">综合上述评测，可以看出5种SIP协议栈各有千秋，OPAL有发展潜力，VOCAL比较完善，sipX兼容性好，ReSIProcate教稳定，oSIP小巧而快速。所以要根据应用的不同选择恰当的协议栈进行研究开发。</p>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5497</link>
<title><![CDATA[live555学习之RTSP连接建立以及请求消息处理过程]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[音视频与流媒体]]></category>
<pubDate>Tue, 08 Oct 2013 13:54:18 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5497</guid> 
<description>
<![CDATA[ 
	<p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><strong><span style="word-wrap: normal; word-break: normal; line-height: 27.200000762939453px; font-size: 14pt">1</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 27.200000762939453px; font-size: 14pt; font-family: 宋体">，</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 27.200000762939453px; font-size: 14pt">RTSP</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 27.200000762939453px; font-size: 14pt; font-family: 宋体">连接的建立过程</span></strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><br />&nbsp;&nbsp;&nbsp;&nbsp;RTSPServer</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">类用于构建一个</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSP</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">服务器，该类同时在其内部定义了一个</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSPClientSession</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">类，用于处理单独的客户会话。</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><br />&nbsp;&nbsp;&nbsp;</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">首先创建</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSP</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">服务器</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">具体实现类是</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">DynamicRTSPServer)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，在创建过程中，先建立</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">Socket(ourSocket)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">在</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">TCP</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">554</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">端口进行监听，然后把连接处理函数句柄</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">&nbsp;</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(RTSPServer:: incomingConnectionHandler)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">和</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">socket</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">句柄传给任务调度器</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(taskScheduler)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">。</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体"><br /></span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: simsun, serif">&nbsp;&nbsp;&nbsp;</span></span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">任务调度器把</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">socket</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">句柄放入后面</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">select</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用中用到的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">socket</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">句柄集</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(fReadSet)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">中，同时将</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">socket</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">句柄和</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">incomingConnectionHandler</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">句柄关联起来。接着，主程序开始进入任务调度器的主循环（</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">doEventLoop</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">），在主循环中调用系统函数</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">select</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">阻塞，等待网络连接。</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><br />&nbsp;&nbsp;&nbsp;</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">当</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSP</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">客户端输入</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(rtsp://192.168.1.109/1.mpg)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">连接服务器时，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">select</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">返回对应的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">scoket</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，进而根据前面保存的对应关系，可找到对应处理函数句柄，这里就是前面提到的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">incomingConnectionHandler</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">了。在</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">incomingConnectionHandler</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">中创建了</span><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSPClientSession</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体; color: red">，</span></strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">开始对这个客户端的会话进行处理。</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">具体分析如下：</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif; color: red">DynamicRTSPServer::creatnew()</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体; color: red">：</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif; color: red"><br />&nbsp;&nbsp;&nbsp;1.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体; color: red">调用继承自</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif; color: red">RTPSever::setUpOurSocket</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体; color: red">：</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">GroupsockHelper</span></strong>&nbsp;<strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">的</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">setupStreamSocket</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">创建一个</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">socket</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">连接，并绑定，</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">设置</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">socket</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">的发送缓存大小，</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">listen</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">开始监听端口，设置同时最大能处理连接数</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">LISTEN_BACKLOG_SIZE=20</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，如果达到这个上限则</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">client</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">端将收到</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">ECONNERREFUSED</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">的错误</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">测试绑定端口是否为</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">0</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，为</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">0</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">的话重新绑定断口，并返回系统自己选择的新的端口。</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">返回建立的</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">socket</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">文件描述符</span></strong></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">&nbsp;&nbsp;&nbsp;</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif; color: red">2.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体; color: red">调用自己和</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif; color: red">RTPSever</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体; color: red">的构造函数：</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif; color: red"><br /></span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">&nbsp;&nbsp;&nbsp;RTPSever</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">构造函数</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">用一个</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">UsageEnvironment</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">对象的引用构造其父类</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">Medium<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">设置最大等待回收连接时间</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">reclamationTestSeconds</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，超过这个时间从客户端没有</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">RTSP</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">命令或者</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">RTSP</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">的</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">RR</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">包则收回其</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">RTSPClientSession<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">建立一个</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">HashTable</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">（实际上是一个</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">BasicHashTable</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">）</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">,</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif; color: red">fServerMediaSessions</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">指向这个表。</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用参数</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">UsageEnvironment</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">对象</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">env</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">的成员</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">,</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">一个</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">TaskScheduler</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">指针所指对象（实际就是一个</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">BasicTaskScheduler</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">对象）的成员函数</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif; color: red">turnOnBackgroundReadHandling()</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体; color: red">：</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif; color: red"><br /></span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用一个</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">HandlerSet::assignHandler()</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">创建一个</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">Handler</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，把</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">socketNum</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">【此处为服务器监听的</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">socket</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">描述符】和处理函数</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">RTSPServer::incomingConnectionHandler()</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，还有指向</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">RTSPSever</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">的指针绑定在一起。</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif; color: red">&nbsp;&nbsp;&nbsp;incomingConnectionHandler</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体; color: red">作用：</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif; color: red"><br /></span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">accept</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">返回服务器与客户端连接的</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">socket</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">描述符</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">设置客户端描述符为非阻塞</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">增加客户端</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">socket</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">描述符的发送缓存为</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">50*1024<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">为此客户端随机分配一个</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">sessionId<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">用客户端</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">socket</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">描述符</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">clientSocket,sessionId,</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">和客户端地址</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">clientAddr</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">creatNewClientSession</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">创建一个</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">clientSession</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">。</span></strong></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><br /></span><strong><span style="word-wrap: normal; word-break: normal; line-height: 27.200000762939453px; font-size: 14pt">2</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 27.200000762939453px; font-size: 14pt; font-family: 宋体">，请求消息处理过程</span></strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><br />&nbsp;&nbsp;&nbsp;</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">上节我们谈到</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSP</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">服务器收到客户端的连接请求，建立了</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSPClientSession</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">类，处理单独的客户会话。在建立</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSPClientSession</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">的过程中，将新建立的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">socket</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">句柄（</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">clientSocket</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">）和</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSP</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">请求处理函数句柄</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSPClientSession::incomingRequestHandler</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">传给任务调度器，由任务调度器对两者进行一对一关联。当客户端发出</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSP</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">请求后，服务器主循环中的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">select</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用返回，根据</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">socket</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">句柄找到对应的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">incomingRequestHandler</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，开始消息处理。先进行消息的解析。</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: red">RTSPClientSession::RTSPClientSession()</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体; color: red">构造函数：</span></strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><br />&nbsp;&nbsp;&nbsp;1.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">重置请求缓存</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">&nbsp;&nbsp;&nbsp;2.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">envir().taskScheduler().</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: red">turnOnBackgroundReadHandling</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">()</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，这次</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">socketnumber</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">为客户端</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">socket</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">描述符这次的处理函数是</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSPServer::RTSPClientSession::</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: red">incomingRequestHandler()</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: red">&nbsp;&nbsp;RTSPServer::RTSPClientSession::incomingRequestHandler():<br /></span></strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">handleAlternativeRequestByte1(uint8_t requestByte)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">：</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.fRequestBuffer[fRequestBytesAlreadySeen] =requestByte;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">把请求字符放入请求缓存</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">fRequestBuffer<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">handleRequestBytes(1)</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">处理请求缓存</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: red">handleRequestBytes(int newBytesRead):<br /></span></strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">noteLiveness()</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">查看请求是否到期</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">如果服务器的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">reclamationTestSeconds&gt; 0</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">taskScheduler</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">对象的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">rescheduleDelayedTask</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">函数</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">:</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">参数为</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">( fLivenessCheckTask,</span>fOurServer.fReclamationTestSeconds*1000000,(TaskFunc*)livenessTimeoutTask,&nbsp;&nbsp;this )</p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">其中</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">livenessTimeoutTask()</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">函数作用是删除</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">new</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">出来的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">clientSession.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">unscheduleDelayedTask(TaskToken&amp;prevTask)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">：</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">从</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">DelayQueue</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">中删除</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">prevTask</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">项，</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">prevTask</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">置空</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">scheduleDelayedTask(int64_t microseconds,&nbsp;</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TaskFunc* proc,&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">void*clientData)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">：&nbsp;</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">创建一个</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">DelayInterval</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">对象</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">timeToDelay</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">，用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">microseconds</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">初始化。</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">创建一个</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">AlarmHandler</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">对象，用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">proc, clientData, timeToDelay</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">初始化</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">fDelayQueue.addEntry(),</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">把这个</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">AlarmHandler</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">对象加入到延迟队列中</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">返回</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">AlarmHandler</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">对象的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">token[long</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">类型</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">]</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">的指针</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>2.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">如果请求的的长度超过请求缓存可读长度</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt">fRequestBufferBytesLeft</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 189pt; font-family: 宋体">，结束这个连接。</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">找到请求消息的结尾：</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">。</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">如果找到消息结尾，调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSPServer::RTSPClientSession::</span><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: red">handleRequestBytes()</span></strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">[</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">值得关注此函数</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">]</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">把请求字符串转换成命令各部分包括：</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">cmdName[</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">方法</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">]</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">urlPreSuffix[url</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">地址</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">]</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">urlSuffix[</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">要读取的文件名</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">]</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">sceq[</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">消息的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">Cseq]</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，否则函数返回需要继续从连接中读取请求。分别存入对应的数组。</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">如果转换成功，调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">handleCmd_xxx()</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">处理对应的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">cmdName: xxx[</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">此处实现了：</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">OPTIONS</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">DESCRIBE</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">SETUP</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">TEARDOWN</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">PLAY</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">PAUSE</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">GET_PARAMETER</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">SET_PARAMETER]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">其中</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">PLAY</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">PAUSE</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">GET_PARAMETER</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">SET_PARAMETER</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">handleCmd_withinSession (cmdName,urlPreSuffix, urlSuffix,cseq,(char const*)fRequestBuffer);</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">清空</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RequestBuffer</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">&nbsp;</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">比如：消息解析后，如果发现客户端的请求是</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">DESCRIBE</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">则进入</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">handleCmd_DESCRIBE</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">函数。</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">RTSP</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">服务器收到客户端的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">DESCRIBE</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">请求后，根据请求</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">URL(rtsp://192.168.1.109/1.mpg)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，找到对应的流媒体资源，返回响应消息。</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">live555</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">中的</span><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">ServerMediaSession</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体; color: red">类</span></strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">用来处理会话中描述，它包含多个（音频或视频）的子会话描述</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(<strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: red">ServerMediaSubsession</span></strong>)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">。根据客户端请求</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">URL</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">的后缀</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">例如是</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">1.mpg),</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">调用成员函数 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">DynamicRTSPServer::lookupServerMediaSession</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">查找对应的流媒体信息</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">ServerMediaSession</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">。（</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">根据</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">urlSuffix</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">查找</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">）。</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202; text-indent: 21pt"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">如果</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">ServerMediaSession</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">不存在，</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">查找文件是否存在，若文件不存在，则判</span><span style="word-wrap: normal; word-break: normal; line-height: 21px; font-family: 宋体">断</span><span style="word-wrap: normal; word-break: normal; line-height: 21px; font-family: Arial, sans-serif">ServerMediaSession</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">（即</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: Arial, sans-serif">smsExists</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">）是否存在，如果存在则将其</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: Arial, sans-serif">remove</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">（调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: Arial, sans-serif">removeServerMediaSession</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">方法）。</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">但是如果本地存在</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: simsun, serif">1.mpg</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">文件，则</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">根据文件名</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">创建一个新的</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: simsun, serif">ServerMediaSession</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">（</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">调用</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: Arial, sans-serif">createNewSMS</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">方法，若在该方法中找不到对应的文件扩展名，则将返回</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: Arial, sans-serif">NULL</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; text-indent: 21pt; font-family: 宋体">）。</span></p><p style="margin: 0px 0px 5px; padding: 0px; border: 0px; list-style: none; word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #323e32; font-family: simsun; font-size: 14.399999618530273px; background-color: #000202; text-indent: 21.1pt"><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">如果通过</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">lookupServerMediaSession</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">返回的是</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">NULL</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">，则向客户端发送响应消息并将</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">fSessionIsActive</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">置为</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">FALSE</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">；否则，为该</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">session</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">组装一个</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">SDP</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">描述信息（调用</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">generateSDPDescription</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">方法，该方法在</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">ServerMediaSession</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">类中），组装完成后，生成一个</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">RTSP URL</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">（调用</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">rtspURL</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">方法，该方法在</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: Calibri, sans-serif">RTSPServer</span></strong><strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体">类中）。</span></strong></p><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: 宋体; color: #323e32">在<strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: red">创建</span></strong></span><strong style="color: #323e32; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #000202"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt">ServerMediaSession</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; font-family: 宋体">过程</span></strong><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: 宋体; color: #323e32">中，根据文件后缀</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: simsun; color: #323e32">.mpg</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: 宋体; color: #323e32">，创建媒体</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: simsun; color: #323e32">MPEG-1or2</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: 宋体; color: #323e32">的解复用器 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: simsun; color: #323e32">(MPEG1or2FileServerDemux)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: 宋体; color: #323e32">。再由</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: simsun; color: #323e32">MPEG1or2FileServerDemux</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: 宋体; color: #323e32">创建一个子会话描述</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: simsun; color: #323e32"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: red">MPEG1or2DemuxedServerMediaSubsession</span></span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: 宋体; color: #323e32">。最后由</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: simsun; color: #323e32">ServerMediaSession</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: 宋体; color: #323e32">完成组装响应消息中的</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: simsun; color: #323e32">SDP</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: 宋体; color: #323e32">信息</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: 宋体; color: #323e32">（</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: simsun; color: #323e32">SDP</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 10.5pt; background-color: #000202; font-family: 宋体; color: #323e32">组装过程见下面的描述），然后将响应消息发给客户端，完成一次消息交互。</span>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5496</link>
<title><![CDATA[crtmpserver实现防盗流和流推送验证]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[音视频与流媒体]]></category>
<pubDate>Tue, 08 Oct 2013 13:47:55 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5496</guid> 
<description>
<![CDATA[ 
	<span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial"><a href="http://m.blog.csdn.net/blog/fireroll/9750703">http://m.blog.csdn.net/blog/fireroll/9750703</a></span><div><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">Protecting your streams from webpage copy&amp;paste flash code, listing or recording</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">保护流，防止在页面上被复制&amp;粘贴，解析或录制</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">by Rani</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">&nbsp;&nbsp;&nbsp;&nbsp; </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">目录表 Table of Contents</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">I.&nbsp;&nbsp;&nbsp;&nbsp;简要说明和目的&nbsp;&nbsp;Brief description and our goals</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">II.&nbsp;&nbsp; 设置rtmpd服务器 Setting up rtmpd server</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">III.&nbsp;&nbsp;测试设置项&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Testing our setup</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">IV.&nbsp;&nbsp; 抓住&ldquo;小偷&rdquo;&nbsp;&nbsp;&nbsp;&nbsp;Catching the thieves</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">V.&nbsp;&nbsp;&nbsp;&nbsp;通过FMLE测试设置，实现和流推送端来共同保护流 </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Combining protected streams (from above) with PUBLISHING streams via FMLE Testing server setup</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">VI.&nbsp;&nbsp; 附录&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANEXA</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">IMPORTANT</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">Global stuff</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">I.&nbsp;&nbsp;Scenario</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">II. Scenario</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">V.&nbsp;&nbsp;Scenario</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">. Due to latest changes, rev. 781 being latest when i write this, </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;you must update your rtmpappprotocolhandler.cpp as:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">. Adding filter for pageURL (webpage where resides the webplayer, dinamic or static webpages)</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">. Show total number of connections after a connection is made</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">. Add posibility to configure a global number of connections that rtmpd could accept</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">I. Brief description and our goals</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">简要说明和目的 </span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">我们想将媒体文件以流的方式发布到网页上。</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">我们使用rtmpd来搭建这套系统，通过编译，测试，运行，看起来都正常工作了；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">但有一天，偶然的机会，发现我们的流被贴在别的网站上，而且看起来也运行正常；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">这个就麻烦大了，别的网站的链接，带宽开销都得由我们承担--为别人做嫁衣了；而且无法进行管控；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">我将这种称之为拷贝&amp;粘贴代码；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">因为他们将我们的代码复制到他们的页面上，并列出相应的媒体文件或流，就能正常工作并且录制；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">对于这种，我们可能会想到要给这套系统添加登录功能，但这个对于用户来说太麻烦了；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">而且也没有解决问题，他们可以正常登录再解决播放页面；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">要不要添加播放器验证机制？实际上也没有用， 他们可以通过反工程进行破解并为伪造；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">而在这个文章中真正要讲的方案是在服务端进行验证，而不是在客户端；</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">我们的目的是要使我们的流只能在我们自己的网页上播放；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">在第一种场景中，网页和rtmpd服务器都托管在同一台机器上；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">在第二种场景中，网页和rtmpd服务器托管在不同子网的不同机器上，</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">无论他们是想复制&amp;粘贴我们的代码，</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">还是使用其它的flash播放器来连接，</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">或是使用软件来录流，</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">我们都能保证他们不能工作；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">那么要如何做呢？</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">II. Setting up rtmpd server</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">设置rtmpd服务器</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">我所举的例子会尽可能接近实际应用；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">为了简便，我们会要覆盖默认的播放应用--flvplayback；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">有一些参数需要先说明下:</span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">tcUrl&nbsp;&nbsp; = contains value of what are you calling your application, like</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="padding: 0px; margin: 0px; word-wrap: break-word; color: #4c33e5">包含了将要调用的应用的值，如： </span></span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtmp:myhost/myapp</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">swfUrl&nbsp;&nbsp;= contains value of flash player absolute address, like </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial"> <span style="padding: 0px; margin: 0px; word-wrap: break-word; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 包含了flash播放器的绝对地址，如:</span></span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://myhost/flowplayer/flowplayer.swf </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">pageUrl = contains value of absolute address of page from where are you calling your app, like: </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">&nbsp;&nbsp; <span style="padding: 0px; margin: 0px; word-wrap: break-word; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 将要调用的应用的页面的绝对地址，如：</span></span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://myhost/mypage.php</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">AND</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">parameter which we are interested very much:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">URI &lt;parameter&gt; =</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">desired URI from one of above parameter like pageUrl and it is anything in the form of:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">schema:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">username:password@domain_or_ip/some/doc/path?and=some&amp;more=parameters </span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;schema can be http,rtmp,rtsp,etc</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URi contains values like:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.fullUri;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.scheme;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.host;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.ip;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.port;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.userName;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.password;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.fullDocumentPath;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.documentPath;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.document;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #e53333">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uri.parameters;</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">如果在同一台服务器上有多个域名，或者是多个服务器有多个域名， 以我的观点来看, </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">最好是使用 uri.ip 来做验证，</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">本教程就是这样做的；</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">We are going to use some prerequests:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">下面是预先的环境设置: </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">a. rtmpd dir:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/usr/local/ameeean </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">b. media folder for testing: /usr/local/media/</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">download source code</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">下载源码:</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">ameeran / # cd /usr/local/</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">ameeran local # mail local # svn co --username anonymous </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">https://svn.rtmpd.com/crtmpserver/branches/1.0 ameeran</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">.......</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">.......</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">A&nbsp;&nbsp;&nbsp;&nbsp;ameeran/constants</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">A&nbsp;&nbsp;&nbsp;&nbsp;ameeran/constants/constants.lua</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">A&nbsp;&nbsp;&nbsp;&nbsp;ameeran/README</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">Checked out revision 294.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">ameeran local #</span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial"><span style="padding: 0px; margin: 0px; word-wrap: break-word; font-size: 18px">a</span><span style="padding: 0px; margin: 0px; word-wrap: break-word; font-size: 18px">dding proper code to some source files</span></span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">修改源文件</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">为了实现我们的目的，需要修改 ProcessInvokeConnect 这个成员函数；</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">修改的源文件有:</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">/usr/local/ameeran/sources/applications/flvplayback/include/rtmpappprotocolhandler.h</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">/usr/local/ameeran/sources/applications/flvplayback/src/rtmpappprotocolhandler.cpp</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">1. FIRST SCENARIO = both website and rtmpd server are hosted on the same machine</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">第一种场景 = 页面和rtmpd都托管在同一台机器</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">预设置 PREREQUEST:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">a. rtmpd public ip:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;86.123.101.7 </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">b. webserver ip:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 86.123.101.7 ( domain example: www.bfy.ro )</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">c. flash player address: http://www.bfy.ro/flowplayer/flowplayer-3.2.5.swf</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">d. application name (alias for flvplayback): ameeran</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">e. media folder:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /usr/local/media</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">1. </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">修改rtmpappprotocolhandler.h文件如下:</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">show code</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/*</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;Copyright (c) 2010,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;Gavriloaie Eugen-Andrei (shiretu@gmail.com)</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;This file is part of crtmpserver.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;crtmpserver is free software: you can redistribute it and/or modify</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;it under the terms of the GNU General Public License as published by</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;the Free Software Foundation, either version 3 of the License, or</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;(at your option) any later version.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;crtmpserver is distributed in the hope that it will be useful,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&nbsp;&nbsp;See the</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;GNU General Public License for more details.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;You should have received a copy of the GNU General Public License</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;along with crtmpserver.&nbsp;&nbsp;If not, see &lt;http://www.gnu.org/licenses/&gt;.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> */</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#ifdef HAS_PROTOCOL_RTMP</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#ifndef _RTMPAPPPROTOCOLHANDLER_H</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#define _RTMPAPPPROTOCOLHANDLER_H</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#include &quot;protocols/rtmp/basertmpappprotocolhandler.h&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">namespace app_flvplayback &#123;</span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;class RTMPAppProtocolHandler</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;: public BaseRTMPAppProtocolHandler &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;public:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;RTMPAppProtocolHandler(Variant &amp;configuration);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;virtual ~RTMPAppProtocolHandler();</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;virtual bool ProcessInvokeGeneric(BaseRTMPProtocol *pFrom, Variant &amp;request);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;virtual bool ProcessInvokeConnect(BaseRTMPProtocol *pFrom, Variant &amp;request);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;private:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;bool ProcessGetAvailableFlvs(BaseRTMPProtocol *pFrom, Variant &amp;request);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;bool ProcessInsertMetadata(BaseRTMPProtocol *pFrom, Variant &amp;request);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&#125;;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#endif&nbsp;&nbsp;/* _RTMPAPPPROTOCOLHANDLER_H */</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#endif /* HAS_PROTOCOL_RTMP */ </span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">RAW file could be found here: http://pastebin.com/raw.php?i=ptrcWpyh</span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">2. modify default rtmpappprotocolhandler.cpp like this:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">修改文件rtmpappprotocolhandler.cpp如下:</span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">show code</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/*</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;Copyright (c) 2010,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;Gavriloaie Eugen-Andrei (shiretu@gmail.com)</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;This file is part of crtmpserver.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;crtmpserver is free software: you can redistribute it and/or modify</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;it under the terms of the GNU General Public License as published by</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;the Free Software Foundation, either version 3 of the License, or</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;(at your option) any later version.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;crtmpserver is distributed in the hope that it will be useful,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&nbsp;&nbsp;See the</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;GNU General Public License for more details.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;You should have received a copy of the GNU General Public License</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> *&nbsp;&nbsp;along with crtmpserver.&nbsp;&nbsp;If not, see &lt;http://www.gnu.org/licenses/&gt;.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> */</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#ifdef HAS_PROTOCOL_RTMP</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#include &quot;rtmpappprotocolhandler.h&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#include &quot;protocols/rtmp/basertmpprotocol.h&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#include &quot;protocols/rtmp/messagefactories/messagefactories.h&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#include &quot;application/baseclientapplication.h&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#include &quot;streaming/baseinnetstream.h&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#include &quot;streaming/streamstypes.h&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">using namespace app_flvplayback;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">RTMPAppProtocolHandler::RTMPAppProtocolHandler(Variant &amp;configuration)</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">: BaseRTMPAppProtocolHandler(configuration) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">RTMPAppProtocolHandler::~RTMPAppProtocolHandler() &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">bool RTMPAppProtocolHandler::ProcessInvokeGeneric(BaseRTMPProtocol *pFrom,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;Variant &amp;request) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;string functionName = M_INVOKE_FUNCTION(request);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;if (functionName == &quot;getAvailableFlvs&quot;) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;return ProcessGetAvailableFlvs(pFrom, request);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&#125; else if (functionName == &quot;insertMetadata&quot;) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;return ProcessInsertMetadata(pFrom, request);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&#125; else &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;return BaseRTMPAppProtocolHandler::ProcessInvokeGeneric(pFrom, request);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">bool RTMPAppProtocolHandler::ProcessGetAvailableFlvs(BaseRTMPProtocol *pFrom, Variant &amp;request) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variant parameters;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameters.PushToArray(Variant());</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameters.PushToArray(Variant());</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vector&lt;string&gt; files;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!ListFolder(_configuration[CONF_APPLICATION_MEDIAFOLDER], files)) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FATAL(&quot;Unable to list folder %s&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STR(_configuration[CONF_APPLICATION_MEDIAFOLDER]));</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string file, name, extension;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR_VECTOR_ITERATOR(string, files, i) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file = VECTOR_VAL(i);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splitFileName(file, name, extension);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extension = lowercase(extension);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (extension != MEDIA_TYPE_FLV</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; extension != MEDIA_TYPE_MP3</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; extension != MEDIA_TYPE_MP4</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; extension != MEDIA_TYPE_M4A</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; extension != MEDIA_TYPE_M4V</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; extension != MEDIA_TYPE_MOV</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; extension != MEDIA_TYPE_F4V</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; extension != MEDIA_TYPE_TS</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; extension != MEDIA_TYPE_MKV)</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string flashName = &quot;&quot;;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (extension == MEDIA_TYPE_FLV) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flashName = name;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125; else if (extension == MEDIA_TYPE_MP3) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flashName = extension + &quot;:&quot; + name;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125; else &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (extension == MEDIA_TYPE_MP4</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#124;&#124; extension == MEDIA_TYPE_M4A</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#124;&#124; extension == MEDIA_TYPE_M4V</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#124;&#124; extension == MEDIA_TYPE_MOV</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#124;&#124; extension == MEDIA_TYPE_F4V) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flashName = MEDIA_TYPE_MP4&quot;:&quot; + name + &quot;.&quot; + extension;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125; else &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flashName = extension + &quot;:&quot; + name + &quot;.&quot; + extension;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINEST(&quot;Parsing `%s`&quot;, STR(flashName));</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variant v = GetMetaData(flashName, true);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (v != V_NULL)</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameters[(uint32_t) 1].PushToArray(flashName);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&lt;uint32_t, BaseStream *&gt; allInboundStreams =</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetApplication()-&gt;GetStreamsManager()-&gt;FindByType(ST_IN_NET, true);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR_MAP(allInboundStreams, uint32_t, BaseStream *, i) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameters[(uint32_t) 1].PushToArray(MAP_VAL(i)-&gt;GetName());</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variant message = GenericMessageFactory::GetInvoke(3, 0, 0, false, 0,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;SetAvailableFlvs&quot;, parameters);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return SendRTMPMessage(pFrom, message);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">bool RTMPAppProtocolHandler::ProcessInvokeConnect(BaseRTMPProtocol *pFrom,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Variant &amp;request) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //0. Dump the request on console, just to see its structure</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FINEST(&quot;Initial request:&#92;n%s&quot;, STR(request.ToString()));</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //1. Get the connect params from the connect invoke</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Variant connectParams = M_INVOKE_PARAM(request, 0);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //2. This should be a key-value map</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (connectParams != V_MAP) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FATAL(&quot;Incorrect invoke params:&#92;n%s&quot;, STR(request.ToString()));</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//3. Let's extract few values. Make sure we extract them using non-case-sensitive keys</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variant tcUrl = connectParams.GetValue(RM_INVOKE_PARAMS_CONNECT_TCURL, false);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//If you are sure about case-sensitive settings, you can extract it directly like this</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variant swfUrl = connectParams[RM_INVOKE_PARAMS_CONNECT_SWFURL];</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Variant tcUrl = connectParams[RM_INVOKE_PARAMS_CONNECT_TCURL];</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variant pageUrl = connectParams[RM_INVOKE_PARAMS_CONNECT_PAGEURL];</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//4. Do some validation on them.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (pageUrl != V_STRING) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FATAL(&quot;Incorrect &quot;RM_INVOKE_PARAMS_CONNECT_PAGEURL&quot;: %s&quot;, STR(request.ToString()));</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (tcUrl != V_STRING) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FATAL(&quot;Incorrect &quot;RM_INVOKE_PARAMS_CONNECT_TCURL&quot;:&#92;n%s&quot;, STR(request.ToString()));</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string rawURI;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI uri;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!URI::FromString(pageUrl, true, uri)) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FATAL(&quot;Unable to parse the uri %s&quot;, STR(rawURI));</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// as proto we are going to validate rtmp/rtmpe - media.bfy.ro=86.123.101.7</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (((string) tcUrl) != &quot;rtmp://media.bfy.ro/ameeran&quot;) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (((string) tcUrl) != &quot;rtmpe://media.bfy.ro/ameeran&quot;) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FATAL(&quot;Incorrect &quot;RM_INVOKE_PARAMS_CONNECT_TCURL&quot;: %s&quot;, STR(request.ToString()));</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// we use our static flowplayer which is always on the same address</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (((string) swfUrl) != &quot;http://www.bfy.ro/flowplayer/flowplayer-3.2.5.swf&quot;) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FATAL(&quot;Incorrect &quot;RM_INVOKE_PARAMS_CONNECT_SWFURL&quot;: %s&quot;, STR(request.ToString()));</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// ip which resolve our calling webpage(s)/website(s)</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (((string) uri.ip) != &quot;86.123.101.7&quot;) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FATAL(&quot;Incorrect &quot;RM_INVOKE_PARAMS_CONNECT_PAGEURL&quot;: %s&quot;, STR(request.ToString()));</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//TODO: continue here</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //5. If everything looks right, continue default processing :)</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return BaseRTMPAppProtocolHandler::ProcessInvokeConnect(pFrom, request);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">bool RTMPAppProtocolHandler::ProcessInsertMetadata(BaseRTMPProtocol *pFrom, Variant &amp;request) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//STREAMING REFACTORING</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;//FINEST(&quot;request:&#92;n%s&quot;, STR(request.ToString()));</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;//1. Get the stream name</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;if ((VariantType) M_INVOKE_PARAM(request, 1) != V_STRING)</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;string streamName = M_INVOKE_PARAM(request, 1);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;//2. Get the stream</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;vector&lt;BaseOutboundStream *&gt; streams = FindOSByName(streamName);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;BaseInboundStream *pInboundStream = NULL;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;FOR_VECTOR(streams, i) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (streams[i]-&gt;GetProtocol()-&gt;GetId() == pFrom-&gt;GetId()) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pInboundStream = streams[i]-&gt;GetInboundStream();</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;if (pInboundStream == NULL) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINEST(&quot;This stream is not yet bound&quot;);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;if (pInboundStream-&gt;IsEnqueueForDelete()) &#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINEST(&quot;This stream will be deleted soon&quot;);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;//3. Prepare the FlexStreamSend message</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;Variant params;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;params.PushToArray(M_INVOKE_PARAM(request, 2));</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;return pInboundStream-&gt;SendStreamMessage(&quot;onMetaData&quot;, params);</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NYIR;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">#endif /* HAS_PROTOCOL_RTMP */</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">raw file could be found here: http://pastebin.com/raw.php?i=mUFevs6g</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">3. a very simple rtmpserver.lua config file only for flv/mp4 streaming based </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">only for flvplayback app:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">下面的相应的一个lua文件，仅用于实现flv/mp4流：</span><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">show code</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">-- Start of the configuration. This is the only node in the config file.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">-- The rest of them are sub-nodes</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">configuration=</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;-- if true, the server will run as a daemon.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;-- NOTE: all console appenders will be ignored if this is a daemon</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;daemon=false,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;-- the OS's path separator. Used in composing paths</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;pathSeparator=&quot;/&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;-- this is the async DNS resolver. This is a &quot;clinet&quot; connection</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;-- to the server.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;dnsResolver=</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;-- the DNS resolver will connect to ip:port.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;-- Whe a request of resolving a domain is made, instead of</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;-- using gethostbyname, we will pass that request to ip:port</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;-- This way, the request is async. Of course, it can be looped back</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;ip=&quot;127.0.0.1&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;port=9311,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;acceptors =</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip=&quot;0.0.0.0&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port=9311,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol=&quot;inboundDns&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;-- this is the place where all the logging facilities are setted up</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;-- you can add/remove any number of locations</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;logAppenders=</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- name of the appender. Not too important, but is mandatory</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; name=&quot;console appender&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- type of the appender. We can have the following values:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- console, coloredConsole and file</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- NOTE: console appenders will be ignored if we run the server</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- as a daemon</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type=&quot;coloredConsole&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- the level of logging. 6 is the FINEST message, 0 is FATAL message.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- The appender will &quot;catch&quot; all the messages below or equal to this level</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- bigger the level, more messages are recorded</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; level=6</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; name=&quot;file appender&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type=&quot;file&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; level=6,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- the file where the log messages are going to land</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fileName=&quot;/tmp/rtmpserver.log&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;-- this node holds all the RTMP applications</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;applications=</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;-- this is the root directory of all applications</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;-- usually this is relative to the binary execuable</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;rootDirectory=&quot;applications&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;--this is where the applications array starts</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- The name of the application. It is mandatory and must be unique</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name=&quot;appselector&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Short description of the application. Optional</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;description=&quot;Application for selecting the rest of the applications&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- The type of the application. Possible values are:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- dynamiclinklibrary - the application is a shared library</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol=&quot;dynamiclinklibrary&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- the complete path to the library. This is optional. If not provided,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- the server will try to load the library from here</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- &lt;rootDirectory&gt;/&lt;name&gt;/lib&lt;name&gt;.&#123;so&#124;dll&#124;dylib&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- library=&quot;/some/path/to/some/shared/library.so&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- Tells the server to validate the clien's handshake before going further.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- It is optional, defaulted to true</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validateHandshake=true,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- this is the folder from where the current application gets it's content.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- It is optional. If not specified, it will be defaulted to:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- &lt;rootDirectory&gt;/&lt;name&gt;/mediaFolder</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- mediaFolder=&quot;/some/directory/where/media/files/are/stored&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- the application will also be known by that names. It is optional</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--aliases=</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;simpleLive&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;vod&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;live&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- This flag designates the default application. The default application</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- is responsable of analyzing the &quot;connect&quot; request and distribute</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- the future connection to the correct application.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default=true,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acceptors =</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip=&quot;0.0.0.0&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port=1935,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol=&quot;inboundRtmp&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip=&quot;0.0.0.0&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port=8081,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol=&quot;inboundRtmps&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sslKey=&quot;server.key&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sslCert=&quot;server.crt&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip=&quot;0.0.0.0&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port=8080,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol=&quot;inboundRtmpt&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;description=&quot;FLV Playback Sample&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name=&quot;flvplayback&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol=&quot;dynamiclinklibrary&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mediaFolder=&quot;/usr/local/media&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aliases=</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;vod&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;live&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ameeran&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acceptors =</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip=&quot;0.0.0.0&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port=1935,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol=&quot;inboundRtmfp&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip=&quot;0.0.0.0&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port=6666,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol=&quot;inboundLiveFlv&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waitForMetadata=true,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip=&quot;0.0.0.0&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port=9999,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol=&quot;inboundTcpTs&quot;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;externalStreams =</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validateHandshake=true,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyframeSeek=true,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seekGranularity=60, --in seconds, between 0.1 and 600</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clientSideBuffer=12, --in seconds, between 5 and 30</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--generateMetaFiles=true, --this will generate seek/meta files on application startup</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--authentication=</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;adobe&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoderAgents=</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;FMLE/3.0 (compatible; FMSc/1.0)&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;my 3rd party encoder&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;some other encoder&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--usersFile=&quot;users.lua&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name=&quot;admin&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;description=&quot;Application for administering&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol=&quot;dynamiclinklibrary&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aliases=</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ameeran_admin&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acceptors =</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip=&quot;0.0.0.0&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port=1112,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol=&quot;inboundJsonCli&quot;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;useLengthPadding=true</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5"> </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--validateHandshake=true,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--default=true,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;&#125;,</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&nbsp;&nbsp;--#INSERTION_MARKER# DO NOT REMOVE THIS. USED BY appscaffold SCRIPT.</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&nbsp;&nbsp;&#125;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#125;</span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">4. Compiling and making rtmpd</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">编译并生成rtmpd</span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">show code</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">ameeran / # cd /usr/local/ameeran/builders/cmake/</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">ameeran cmake # cmake .</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">ameeran cmake # make</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">ameeran cmake # </span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">5. starting up</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">启动rtmpd</span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">show code</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">ameeran cmake #./rtmpserver/rtmpserver ./rtmpserver/rtmpserver.lua</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/rtmpserver/src/rtmpserver.cpp:168 Plug in the default protocol factory</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/rtmpserver/src/rtmpserver.cpp:175 Initialize I/O handlers manager: epoll</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/rtmpserver/src/rtmpserver.cpp:178 Initialize DNS resolver</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/iohandlermanager.cpp:96 Handlers count changed: 0-&gt;1 IOHT_ACCEPTOR</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/iohandlermanager.cpp:96 Handlers count changed: 1-&gt;2 IOHT_TCP_CONNECTOR</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/rtmpserver/src/rtmpserver.cpp:184 Initialize applications</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/iohandlermanager.cpp:96 Handlers count changed: 2-&gt;3 IOHT_ACCEPTOR</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/iohandlermanager.cpp:96 Handlers count changed: 3-&gt;4 IOHT_ACCEPTOR</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/iohandlermanager.cpp:96 Handlers count changed: 4-&gt;5 IOHT_ACCEPTOR</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/configuration/configfile.cpp:787 Application &quot;appselector&quot; is up and running</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/iohandlermanager.cpp:96 Handlers count changed: 5-&gt;6 IOHT_UDP_CARRIER</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/iohandlermanager.cpp:96 Handlers count changed: 6-&gt;7 IOHT_ACCEPTOR</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/iohandlermanager.cpp:96 Handlers count changed: 7-&gt;8 IOHT_ACCEPTOR</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/configuration/configfile.cpp:787 Application &quot;flvplayback&quot; (vod,live,ameeran) is up and running</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/iohandlermanager.cpp:96 Handlers count changed: 8-&gt;9 IOHT_ACCEPTOR</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/configuration/configfile.cpp:787 Application &quot;admin&quot; (ameeran_admin) is up and running</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/rtmpserver/src/rtmpserver.cpp:190 Install the quit signal</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/rtmpserver/src/rtmpserver.cpp:193 Install the conf re-read signal</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/rtmpserver/src/rtmpserver.cpp:200</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">+-----------------------------------------------------------------------------+</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Services&#124;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">+---+---------------+-----+-------------------------+-------------------------+</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#124; c &#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#124; port&#124;&nbsp;&nbsp; protocol stack name&nbsp;&nbsp; &#124;&nbsp;&nbsp;&nbsp;&nbsp; application name&nbsp;&nbsp;&nbsp;&nbsp;&#124;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">+---+---------------+-----+-------------------------+-------------------------+</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#124;tcp&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&#124; 9311&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inboundDns&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #none#&#124;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">+---+---------------+-----+-------------------------+-------------------------+</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#124;tcp&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&#124; 1935&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inboundRtmp&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appselector&#124;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">+---+---------------+-----+-------------------------+-------------------------+</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#124;tcp&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&#124; 8081&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inboundRtmps&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appselector&#124;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">+---+---------------+-----+-------------------------+-------------------------+</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#124;tcp&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&#124; 8080&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inboundRtmpt&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appselector&#124;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">+---+---------------+-----+-------------------------+-------------------------+</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#124;udp&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&#124; 1935&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inboundRtmfp&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flvplayback&#124;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">+---+---------------+-----+-------------------------+-------------------------+</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#124;tcp&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&#124; 6666&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inboundLiveFlv&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flvplayback&#124;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">+---+---------------+-----+-------------------------+-------------------------+</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#124;tcp&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&#124; 9999&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inboundTcpTs&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flvplayback&#124;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">+---+---------------+-----+-------------------------+-------------------------+</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">&#124;tcp&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0&#124; 1112&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inboundJsonCli&#124;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;admin&#124;</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">+---+---------------+-----+-------------------------+-------------------------+</span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/rtmpserver/src/rtmpserver.cpp:201 GO! GO! GO! (22807)</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/iohandlermanager.cpp:96 Handlers count changed: 9-&gt;10 IOHT_TCP_CARRIER</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/tcpacceptor.cpp:134 Client connected: 127.0.0.1:53720 -&gt; 0.0.0.0:9311</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/iohandlermanager.cpp:96 Handlers count changed: 10-&gt;11 IOHT_TCP_CARRIER</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">/usr/local/ameeran/sources/thelib/src/netio/epoll/iohandlermanager.cpp:105 Handlers count changed: 11-&gt;10 IOHT_TCP_CONNECTOR</span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">2. SECOND SCENARIO = both website and rtmpd server are hosted on the different machines </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">on a different subnets</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 18px; font-family: Arial">第二种场景 = 页面和rtmpd托管在不同子网的不同机器上</span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial; color: #4c33e5">预设置 PREREQUEST:</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">a. rtmpd public ip:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;86.123.101.7 </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">b. webserver ip:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 86.122.125.158 ( domain example: www.a-queens.ro )</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">c. flash player address:&nbsp;&nbsp; http://www.a-queens.ro/flowplayer/flowplayer-3.2.5.swf</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">d. application name (alias for flvplayback): ameeran</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">e. media folder:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /usr/local/media</span><br /><br /><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">1. rtmpappprotocolhandler.h file remains the same as in FIRST SCENARIO </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">&nbsp;&nbsp; rtmpappprotocolhandler.h和第一种场景的相同</span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">2. modify default rtmpappprotocolhandler.cpp like this: </span><br /><span style="padding: 0px; margin: 0px; line-height: 24px; -webkit-text-size-adjust: none; background-color: #ededed; word-wrap: break-word; font-size: 14px; font-family: Arial">&nbsp;&nbsp; 修改rtmpappprotocolhandler.cpp如下:</span><br /><br /></div>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5495</link>
<title><![CDATA[流媒体技术基础-流媒体传输协议]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[音视频与流媒体]]></category>
<pubDate>Tue, 08 Oct 2013 11:36:19 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5495</guid> 
<description>
<![CDATA[ 
	<pre class="best-text mb-10" style="margin-top: 0px; margin-bottom: 10px; padding: 0px; font-family: arial, 'courier new', courier, 宋体, monospace; white-space: pre-wrap; word-wrap: break-word; color: #333333; font-size: 14px; line-height: 24px; background-color: #f1fedd">实时<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">传输协议</a>RTP与RTCP <br /><br /> RTP（Real-timeTransportProtocol）是用于Internet上针对多媒体<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%95%B0%E6%8D%AE%E6%B5%81&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">数据流</a>的一种<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">传输协议</a>。RTP被定义为在一对一或一对多的传输情况下工作，其目的是提供时间信息和实现流同步。RTP通常使用UDP来传送数据，但RTP也可以在TCP或ATM等其他协议之上工作。当应用程序开始一个RTP会话时将使用两个端口：一个给RTP，一个给RTCP。RTP本身并不能为按顺序传送数据包提供可靠的传送机制，也不提供<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">流量控制</a>或拥塞控制，它依靠RTCP提供这些服务。通常RTP算法并<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%B8%8D%E4%BD%9C%E4%B8%BA&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">不作为</a>一个独立的<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%BD%91%E7%BB%9C%E5%B1%82&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">网络层</a>来实现，而是作为应用程序代码的一部分。实时传输控制协议RTCP。RTCP(Real-timeTransportControlProtocol)和RTP一起提供<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">流量控制</a>和拥塞控制服务。在RTP会话期间，各参与者周期性地传送RTCP包。RTCP包中含有已发送的数据包的数量、丢失的数据包的数量等统计资料，因此，服务器可以利用这些信息动态地改变<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%BC%A0%E8%BE%93%E9%80%9F%E7%8E%87&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">传输速率</a>，甚至改变有效载荷类型。RTP和RTCP配合使用，它们能以有效的反馈和最小的开销使传输效率最佳化，因而特别适合传送网上的实时数据。 <br /><br />6.2.1 RTP数据传输协议 <br /><br /> RTP提供端对端<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%BD%91%E7%BB%9C%E4%BC%A0%E8%BE%93&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">网络传输</a>功能，适合通过组播和点播传送实时数据，如视频、音频和仿<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%9C%9F%E6%95%B0&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">真数</a>据。RTP没有涉及资源预订和质量保证等实时服务，RTCP扩充数据传输以允许监控数据传送，提供最小的控制和识别功能。RTP与RTCP设<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E8%AE%A1%E6%88%90&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">计成</a>独立传输和<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%BD%91%E7%BB%9C%E5%B1%82&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">网络层</a>。 <br /><br />2.1.1 RTP固定头 <br /> RTP 头格式如下： <br /> ----------------------------------------------------------------------------------------------- <br /> &#124;V=2&#124;P&#124;X&#124; CC &#124;M&#124; PT &#124; 系列号 &#124; <br /> ----------------------------------------------------------------------------------------------- <br /> &#124; 时标 &#124; <br /> ----------------------------------------------------------------------------------------------- <br /> &#124; 同步源标识(SSRC) &#124; <br /> ----------------------------------------------------------------------------------------------- <br /> &#124; 作用标识 (CSRC) &#124; <br /> &#124; .... &#124; <br /> ----------------------------------------------------------------------------------------------- <br /><br /> 开始12个<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%85%AB%E8%BF%9B%E5%88%B6&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">八进制</a>出现在每个RTP包中，而CSRC标识列表仅出现在<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%B7%B7%E5%90%88%E5%99%A8&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">混合器</a>插入时。 <br /> 2.1.2 复用 RTP 连接 <br /> 为使协议有效运行，复用点数目应减至最小。RTP中，复用由定义RTP连接的目的传输地址（<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">网络地址</a>与<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%AB%AF%E5%8F%A3%E5%8F%B7&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">端口号</a>）提供。例如，对音频和视频单独编码的远程会议，每个媒介被携带在单独RTP连接中，具有各自的目的传输地址。目标不在将音频和视频放在单一RTP连接中，而根据SSRC段载荷类型进行多路分解。使用同一SSRC ，而具有不同载荷类型的交叉包将带来几个问题： <br /> 如一种载荷类型在连接期间切换，没有办法识别新值将替换那一<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%B8%AA%E6%97%A7&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">个旧</a>值。 <br />SSRC定义成用于标识单个计时和系列号空间。如媒体时钟速率不同，而要求不同系列号空间以说明那种载荷类型有<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%B8%A2%E5%8C%85&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">丢包</a>，交叉复用载荷类型将需要不同计时空间。 <br /> RTCP发送和接收报告可能仅描述每个SSRC的计时和系列号空间，而不携带载荷类型段。 <br /> RTP<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%B7%B7%E5%90%88%E5%99%A8&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">混合器</a>不能将不兼容媒体流合并成一个流。 <br /> 在一个RTP连接中携带多个媒介阻止几件事：使用不同网络路径或<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%BD%91%E7%BB%9C%E8%B5%84%E6%BA%90&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">网络资源</a>分配；接受媒介<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%AD%90%E9%9B%86&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">子集</a>。 <br />对每种媒介使用不同SSRC，但以相同RTP连接发送可避免前三个问题，但不能避免后两个问题。 <br /><br />2.1.3 对RTP头特定设置的修改 <br /> 可以认为，现用RTP数据包头对RTP支持的所有应用类共同需要的功能集是完整的。然而，为维持ALF设计原则，头可通过改变或增加设置来裁剪，并仍允许设置无关监控和记录工具起作用。标记位与载荷类型段携带特定设置信息，但由于很多应用需要它们，否则要容纳它们，就要增加另外32位字，故允许分配在固定头中。包含这些段的<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%85%AB%E8%BF%9B%E5%88%B6&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">八进制</a>可通过设置重新定义以适应不同要求，如采用更多或更少标记位。如有标记位，既然设置无关<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%9B%91%E6%8E%A7%E5%99%A8&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">监控器</a>能观察包丢失模式和标记位间关系，我们就可以定位<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%85%AB%E8%BF%9B%E5%88%B6&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">八进制</a>中最重要的位。 <br /> 其它特殊载荷格式（<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">视频编码</a>）所要求的信息应该携带在包的载荷部分。可出现在头，总是在载荷部分开始处，或在数据模式的保留值中指出。如特殊应用类需要独立载荷格式的附加功能，应用运行的设置应该定义附加固定段跟随在现存固定头SSRC之后。这些应用将能迅速而直接访问附加段，同时，与<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%9B%91%E6%8E%A7%E5%99%A8&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">监控器</a>和记录器无关设置仍能通过仅解释开始12个八进制处理RTP包。如证实附加功能是所有设置共同需要的，新版本RTP应该对固定头作出明确改变<br />6.2.2 RTP控制协议-- RTCP <br />&nbsp;&nbsp;RTCP协议将控制包周期发送给所有连接者，应用与数据包相同的分布机制。低层协议提供数据与控制包的复用，如使用单独的UDP<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%AB%AF%E5%8F%A3%E5%8F%B7&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">端口号</a>。RTCP执行下列四大功能： <br />&nbsp;&nbsp;主要是提供数据发布的质量反馈。是作为RTP传输协议的一部分，与其他传输协议的流和阻塞控制有关。反馈对<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E8%87%AA%E9%80%82%E5%BA%94&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">自适应</a>编码控制直接起作用，但IP组播经验表明，从发送者收到反馈对诊断发送错误是致关重要的。给所有参加者发送接收反馈报告允许问题<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E8%A7%82%E5%AF%9F%E8%80%85&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">观察者</a>估计那些问题是局部的，还是全局的。诸如IP组播等发布机制使网络<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%9C%8D%E5%8A%A1%E6%8F%90%E4%BE%9B%E5%95%86&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">服务提供商</a>类团体可能接收反馈信息，充当第三方监控者来诊断网络问题。反馈功能由RTCP发送者和接收者报告执行。 <br />&nbsp;&nbsp;RTCP带有称作规范名字（CNAME）的RTP源持久<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%BC%A0%E8%BE%93%E5%B1%82&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">传输层</a>标识。如发现冲突，或程序重新启动，既然SSRC标识可改变，接收者需要CNAME跟踪参加者。接收者也需要CNAME 与相关RTP连接中给定的几个<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%95%B0%E6%8D%AE%E6%B5%81&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">数据流</a>联系 <br />&nbsp;&nbsp;前两种功能要求所有参加者发送RTCP包，因此，为了RTP扩展到大规<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%A8%A1%E6%95%B0&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">模数</a>量，速率必须受到控制。让每个参加者给其它参加者发送控制包，就大独立观察参加者数量。该数量用语计算包发送的速率。 <br />&nbsp;&nbsp;第四个可选功能是传送最小连接控制信息，如参加者辨识。最可能用在&#92;&quot;松散控制&#92;&quot;连接，那里参加者自由进入或离开，没有成员控制或参数协调，RTCP充当通往所有参加者的方便通道，但不必支持应用的所有控制通讯要求。高级连接控制协议超出本书范围。 <br />&nbsp;&nbsp;在IP组播场合应用RTP时，前3个功能是必须的，推荐用于所有情形。RTP应用设计人员必须避免使用仅在<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%8D%95%E6%92%AD&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">单播</a>模式下工作的机制，那将导致无法扩展规模。 <br />&nbsp;&nbsp;<br />&nbsp;&nbsp;6.2.2.1 RTCP 包格式 <br />&nbsp;&nbsp;下面定义几个携带不同控制信息的RTCP包类型： <br />&nbsp;&nbsp;SR： <br />&nbsp;&nbsp;发送报告，当前活动发送者发送、接收统计。 <br />&nbsp;&nbsp;RR： <br />&nbsp;&nbsp;接收报告，非活动发送者接收统计。 <br />&nbsp;&nbsp;SDES： <br />&nbsp;&nbsp;源描述项，包括CNAME。 <br />&nbsp;&nbsp;BYE： <br />&nbsp;&nbsp;表示结束。 <br />&nbsp;&nbsp;APP： <br />&nbsp;&nbsp;应用特定函数。 <br />&nbsp;&nbsp;类似于RTP数据包，每个RTCP包以固定部分开始，紧接着的是可变长结构元素，但以一个32位边界结束。包含安排要求和固定部分中长度段，使RTCP包可堆叠。不需要插入任何<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%88%86%E9%9A%94%E7%AC%A6&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">分隔符</a>将<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%A4%9A%E5%93%A5&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">多哥</a>RTCP包连接起来形成一个RTCP组合包，以低层协议用单一包发送出去。由于需要低层协议提供提供整体长度来决定组合包的结尾，在组合包中没有单个RTCP包显式计数。 <br />&nbsp;&nbsp;组合包中每个RTCP包可独立处理，不需要根据包组合顺序。但未了执行协议功能，强加如下约束： <br />&nbsp;&nbsp;接收统计（在SR或RR中）应该经常发送，只要带宽允许，因此每个周期发送的组合RTCP 包应包含报告包。 <br />&nbsp;&nbsp;新接收者需要接收CNAME，并尽快识别源，开始联系媒介进行同步，因此每个包应该包含SDES CNAME。 <br />&nbsp;&nbsp;出现在组合包前面的是包类型数量，其增长应该受到限制，以提高常数位数量，提高成功确认RTCP包对错误地址RTP数据包或其他无关包的概率。 <br />&nbsp;&nbsp;因此，所有RTCP包至少必须以两个包组合形式发送，推荐格式如下： <br />&nbsp;&nbsp;加密前缀（Encryption prefix）： <br />&nbsp;&nbsp;仅当组合包被加密，才加上一个32位<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E9%9A%8F%E6%9C%BA%E6%95%B0&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">随机数</a>用于每个组合包发送。 <br />&nbsp;&nbsp;SR或RR： <br />&nbsp;&nbsp;组合包中第一个RTCP包必须总为一个报告包，方便头的确认。即使没有数据发送，也没有接收到数据，也要发送一个空RR，那怕组合包中RTCP包为BYE。 <br />&nbsp;&nbsp;附加RR： <br />&nbsp;&nbsp;如报告统计源数目超过31，在初始报告包后应该有附加RR 包。 <br />&nbsp;&nbsp;<br />&nbsp;&nbsp;SDES： <br />&nbsp;&nbsp;包含CNAME 项的SDES包必须包含在每个组合RTCP包中。如应用要求，其他源描述项可选，但受到带宽限制。 <br />&nbsp;&nbsp;BYE或APP： <br />&nbsp;&nbsp;其它RTCP包类型可以任意顺序排列，除了BYE应作为最后一个包发送，包类型出现可不止一次。 <br />&nbsp;&nbsp;建议转换器或<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%B7%B7%E5%90%88%E5%99%A8&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">混合器</a>从多个源组合单个RTCP包。如组合包整体长度超过网络路径最大传输单元，可分成多个较短组合包用低层协议以单个包形式发送。注意，每个组合包必须以SR或RR包开始。附加RTCP包类型可在Internet Assigned Numbers Authority (IANA)处注册。 <br />&nbsp;&nbsp;<br />&nbsp;&nbsp;6.2.2.2 RTCP传输间隔 <br />&nbsp;&nbsp;RTP设<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E8%AE%A1%E6%88%90&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">计成</a>允许应用自动扩展，连接数可从几个到上千个。例如，音频会议中，<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%95%B0%E6%8D%AE%E6%B5%81&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">数据流</a>量是内在限制的，因为同一时刻只有一两个人说话；对组播，给定连接数据率仍是常数，独立<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%BA%8E%E8%BF%9E&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">于连</a>接数，但控制流量不是内在限制的。如每个参加者以固定速率发送接收报告，控制流量将随参加者数量线性增长，因此，速率必须按比例下降。 <br />&nbsp;&nbsp;一旦确认地址有效，如后来标记成未活动，地址的状态应仍保留，地址应继续计入共享RTCP带宽地址的总数中，时间要保证能扫描典型网络分区，建议为30分钟。注意，这仍大于RTCP报告间隔最大值的五倍。 <br />&nbsp;&nbsp;这个规范定义了除必需的CNAME外的几个源描述项，如NAME（人名）和EMAIL（<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E5%9C%B0%E5%9D%80&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">电子邮件地址</a>）。它也为定义新特定应用RTCP包类型的途径。给附加信息分配控制带宽应引起注意，因为它将降低接收报告和CNAME发送的速率而损害协议的性能。建议分配给单个参加者用于携带附加信息的RTCP带宽不要超过20%。而且并没有有意让所有SDES项包含在每个应用中。 <br />&nbsp;&nbsp;6.2.2.3 发送者与接收者报告 <br />&nbsp;&nbsp;RTP接收者使用RTCP报告包提供接收质量反馈，报告包根据接收者是否是发送者而采用两种格式中的一种。除包类型代码外，发送者报告与接收者报告间唯一的差别是发送者报告包含一个20个字节发送者信息段。如某地址在发出最后或前一个报告间隔期间发送数据包，就发布SR；否则，就发出RR；SR和RR都可没有或包括多个接收报告块。发布报告不是为列在CSRC列表上的起作用的源，每个接收报告块提供从特殊源接收数据的统计。既然最大可有31个接收报告块嵌入在SR 或 RR包中， <br />&nbsp;&nbsp;丢失包累计数差别给出间隔期间丢掉的数量，而所收到扩展的最后一个系列号的差别给出间隔期间希望发送的包数量，两者之比等于经过间隔期间包丢失百分比。如两报告连续，比值应该等于丢失段部分；否则，就不等。每秒包丢失绿可通过NTP时标差除以丢失部分得到。 <br />&nbsp;&nbsp;从发送者信息，第三方<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%9B%91%E6%8E%A7%E5%99%A8&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">监控器</a>可计算载荷平均<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%95%B0%E6%8D%AE%E9%80%9F%E7%8E%87&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">数据速率</a>与没收到数据间隔的平均包速率，两者比值给出平均载荷大小。如假设包丢失与包大小无关，那么特殊接收者收到的包数量给出此接收者收到的表观流量。 <br />&nbsp;&nbsp;<br />&nbsp;&nbsp;6.2.2.4 SDES: 源描述RTCP包 <br />&nbsp;&nbsp;SDES 包为<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%B8%89%E5%B1%82%E7%BB%93%E6%9E%84&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">三层结构</a>，由头与<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%95%B0%E6%8D%AE%E5%9D%97&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">数据块</a>组成，<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%95%B0%E6%8D%AE%E5%9D%97&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">数据块</a>可以没有，也可有多个，组成项描述块所表明的源。项描述如下： <br />&nbsp;&nbsp;版本（V）、填充（P）、长度： <br />&nbsp;&nbsp;如SR包中所描述。 <br />&nbsp;&nbsp;包类型（PT）： <br />&nbsp;&nbsp;8位，包含常数202，识别RTCP SDES包。 <br />&nbsp;&nbsp;源计数（SC）： <br />&nbsp;&nbsp;5位，包含在SDES包中的SSRC/CSRC块数量，零值有效，但没有意义。 <br />&nbsp;&nbsp;源描述项内容如下： <br />&nbsp;&nbsp;CNAME: 规范终端标识SDES项 <br />&nbsp;&nbsp;CNAME标识属性如下： <br />&nbsp;&nbsp;如发生冲突或重启程序，由于随机分配的SSRC标识可能发生变化，需要CNAME项提供从SSRC标识到仍为<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%B8%B8%E9%87%8F&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">常量</a>的源标识的绑定。 <br />&nbsp;&nbsp;象SSRC标识，CNAME标识在RTP连接的所有参加者中应是唯一的。 <br />&nbsp;&nbsp;为了提供一套相关RTP连接中某个参加者所采用的跨多媒体工具间的绑定，CNAME应固定为那个参加者。 <br />&nbsp;&nbsp;为方便第三方监控，CNAME应适合程序或人员定位源。 <br />&nbsp;&nbsp;NAME：用户名称SDES项 <br />&nbsp;&nbsp;这是用于描述源的真正的名称，如&#92;&quot;<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=John%20Doe&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">John Doe</a>, Bit Recycler, Megacorp&#92;&quot;，可是用户想要的任意形式。对诸如会议应用，这种名称也许是参加者列表显示最适宜的形式，它将是除CNAME外发送最频繁的项目。设置可建立这样的<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%BC%98%E5%85%88%E7%BA%A7&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">优先级</a>别。NAME值至少在连接期间仍希望保持为常数。它不该成为连接的所有参加者中唯一依赖。 <br />&nbsp;&nbsp;EMAIL：<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E5%9C%B0%E5%9D%80&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">电子邮件地址</a>SDES项 <br />&nbsp;&nbsp;邮件地址格式由RFC822规定，如&#92;&quot;John.Doe@megacorp.com&#92;&quot;。连接期间，电子邮件仍希望保持为常数。 <br />&nbsp;&nbsp;PHONE：电话号码SDES项 <br />&nbsp;&nbsp;电话号码应带有<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%8A%A0%E5%8F%B7&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">加号</a>，代替国际接入代码，如&#92;&quot;+1 908 555 1212&#92;&quot;即为美国电话号码。 <br />&nbsp;&nbsp;<br />&nbsp;&nbsp;LOC：用户地理位置SDES项 <br />&nbsp;&nbsp;根据应用，此项具有不同程度的细节。对会议应用，字符串如&#92;&quot;Murray Hill, New Jersey&#92;&quot;就足够了。然而，对活动标记系统，字符串如&#92;&quot;Room 2A244, AT&amp;T BL MH&#92;&quot;也许就适用。细节留给实施或用户，但格式和内容可用设置指示。在连接期间，除移动主机外，LOC值期望仍保留为常数。 <br />&nbsp;&nbsp;TOOL：应用或工具名称SDES项 <br />&nbsp;&nbsp;是一个字符串，表示产生流的应用的名称与版本，如&#92;&quot;videotool 1.2&#92;&quot;。这部分信息对调试很有用，类似于邮件或<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">邮件系统</a>版本SMTP头。TOOL值在连接期间仍保持常数。 <br />&nbsp;&nbsp;NOTE: 通知/状态SDES项 <br />&nbsp;&nbsp;该项的推荐语法如下所述，但这些或其它语法可在设置中显式定义。NOTE 项旨在描述源当前状态的过渡信息，如&#92;&quot;on the phone, can&acute;t talk&#92;&quot;，或在讲座期间用于传送谈话的题目。它应该只用于携带例外信息，而不应包含在全部参加者中，因为这将降低接收报告和CNAME发送的速度，因此损害协议的性能。特殊情况下，它不应作为用户设置文件的项目，也不是自动产生。 <br />&nbsp;&nbsp;当其为活动时，由于NOTE项对显示很重要，其它非CNAME项（如NAME）<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%BC%A0%E8%BE%93%E9%80%9F%E7%8E%87&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">传输速率</a>将会降低，结果使NOTE项占用RTCP部分带宽。若过渡信息不活跃，NOTE项继续以同样的速度重复发送几次，但以一个串长为零的字符串通知接收者。然而，如对小倍数的重复或约20-30 RTCP间隔也没有接收到，接收者也应该考虑NOTE项是不活跃的。 <br />&nbsp;&nbsp;PRIV: 专用扩展SDES项 <br />&nbsp;&nbsp;该项用于定义实验或应用特定的SDES扩展，它包括由长字符串对组成的前缀，后跟填充该项其他部分和携带所需信息的字符串值。前缀长度段为8位。前缀字符串是定义PRIV项人员选择的名称，唯一对应应用接收到的其它PRIV项。应用实现者可选择使用应用名称，如有必要，外加附加子类型标识。另外，推荐其它人根据其代表的实体选择名称，然后，在实体内部协调名称的使用。 <br />&nbsp;&nbsp;注意，前缀消耗了总长为255个八进制项的一些空间，因此，前缀应尽可能的短。这个设备和受到约束的RTCP带宽不应过载，其目的不在于满足所有应用的全部控制通讯要求。SDES PRIV前缀没在IANA处注册。如证实某些形式的PRIV项具有通用性， IANA应给它分配一个正式的SDES项类型，这样就不再需要前缀。这简化了应用，并提高了传输的效率。 <br />&nbsp;&nbsp;6.2.2.5 BYE：断开RTCP包 <br />&nbsp;&nbsp;如混合器接收到一个BYE包，混合器转发BYE包，而不改变SSRC/CSRC 标识。如混合器关闭，它也应该发出一个BYE包，列出它所处理的所有源，而不只是自己的SSRC标识。作为可选项，BYE包可包括一个8位八进制计数，后跟很多八进制文本，表示离<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%BC%80%E5%8E%9F&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">开原</a>因，如：&#92;&quot;camera malfunction&#92;&quot;或&#92;&quot;RTP loop detected&#92;&quot;。字符串具有同样的编码，如在SDES 中所描述的。如字符串填充包至下32位边界，字符串就不以空结尾；否则，BYE包以空八进制填充。 <br />&nbsp;&nbsp;6.2.2.6 APP：定义应用的RTCP包 <br />&nbsp;&nbsp;APP包用于开发新应用和新特征的实验，不要求注册包类型值。带有不可识别名称的APP包应被忽略掉。测试后，如确定应用广泛，推荐重新定义每个APP包，而不用向IANA注册子类型和名称段。<br />实时流协议RTSP <br /><br />&nbsp;&nbsp;实时流协议RTSP(RealTimeStreamingProtocol)是由RealNetworks和Netscape共同提出的，该协议定义了一对多应用程序如何有效地通过<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=IP%E7%BD%91%E7%BB%9C&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">IP网络</a>传送多媒体数据。RTSP在<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">体系结构</a>上位于RTP和RTCP之上，它使用TCP或RTP完成数据传输。HTTP与RTSP相比，HTTP传送HTML，而RTP传送的是多媒体数据。<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=HTTP%E8%AF%B7%E6%B1%82&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">HTTP请求</a>由客户机发出，服务器作出响应；使用RTSP时，客户机和服务器都可以发出请求，即RTSP可以是双向的。 <br /><br />6.3 RTSP协议 <br />&nbsp;&nbsp;实时流协议（RTSP）是应用级协议，控制实时数据的发送。RTSP提供了一个可扩展框架，使实时数据，如音频与视频，的受控、点播成为可能。<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%95%B0%E6%8D%AE%E6%BA%90&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">数据源</a>包括现场数据与存储在剪辑中数据。该协议目的在于控制多个数据发送连接，为选择发送通道，如UDP、组播UDP与TCP，提供途径，并为选择基于RTP上发送机制提供方法。 <br />&nbsp;&nbsp;6.3.1 简介 <br />&nbsp;&nbsp;6.3.1.1 目的 <br />&nbsp;&nbsp;实时流协议（RTSP）建立并控制一个或几个时间同步的连续流媒体。尽管连续媒体流与控制流交叉是可能的，通常它本身并不发送连续流。换言之，RTSP充当多媒体服务器的网络远程控制。RTSP连接没有绑定到<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%BC%A0%E8%BE%93%E5%B1%82&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">传输层</a>连接，如TCP。在RTSP连接期间，RTSP用户可打开或关闭多个对服务器的可靠传输连接以发出RTSP 请求。此外，可使用无连接传输协议，如UDP。RTSP<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%B5%81%E6%8E%A7&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">流控</a>制的流可能用到RTP，但RTSP操作并不依赖用于携带连续媒体的传输机制。实时流协议在语法和操作上与HTTP/1.1类似，因此HTTP的扩展机制大都可加入RTSP。协议支持的操作如下： <br />&nbsp;&nbsp;从媒体服务器上检索媒体： <br />&nbsp;&nbsp;用户可通过HTTP或其它方法提交一个演示描述。如演示是组播，演示式就包含用<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%BA%8E%E8%BF%9E&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">于连</a>续媒体的的<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%BB%84%E6%92%AD%E5%9C%B0%E5%9D%80&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">组播地址</a>和端口。如演示仅通过<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%8D%95%E6%92%AD&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">单播</a>发送给用户，用户为了安全应提供目的地址。 <br />&nbsp;&nbsp;媒体服务器邀请进入会议： <br />&nbsp;&nbsp;媒体服务器可被邀请参加正进行的会议，或回放媒体，或记录其中一部分，或全部。这种模式在<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%88%86%E5%B8%83%E5%BC%8F&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">分布式</a>教育应用上很有用，会议中几方可轮流按远程控制按钮。 <br />&nbsp;&nbsp;将媒体加到现成讲座中： <br />&nbsp;&nbsp;如服务器告诉用户可获得附加媒体内容，对现场讲座显得尤其有用。如HTTP/1.1中类似，RTSP请求可由代理、通道与缓存处理。 <br />&nbsp;&nbsp;<br />&nbsp;&nbsp;6.3.1.2 协议特点 <br />&nbsp;&nbsp;RTSP 特性如下： <br />&nbsp;&nbsp;可扩展性： <br />&nbsp;&nbsp;新方法和参数很容易加入RTSP。 <br />&nbsp;&nbsp;易解析： <br />&nbsp;&nbsp;RTSP可由标准 HTTP或MIME解吸器解析。 <br />&nbsp;&nbsp;安全： <br />&nbsp;&nbsp;RTSP使用网页安全机制。 <br />&nbsp;&nbsp;独立于传输： <br />&nbsp;&nbsp;RTSP可使用不可靠数据报协议（UDP）、可靠数据报协议（RDP），如要实现应用级可靠，可使用可靠流协议。 <br />&nbsp;&nbsp;多服务器支持： <br />&nbsp;&nbsp;每个流可放在不同服务器上，用户端自动同不同服务器建立几个并发控制连接，媒体同步在<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E4%BC%A0%E8%BE%93%E5%B1%82&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">传输层</a>执行。 <br />&nbsp;&nbsp;记录设备控制： <br />&nbsp;&nbsp;协议可控制记录和回放设备。 <br />&nbsp;&nbsp;<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%B5%81%E6%8E%A7&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">流控</a>与会议开始分离： <br />&nbsp;&nbsp;仅要求会议初始化协议提供，或可用来创建唯一会议标识号。特殊情况下， SIP或<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=H.323&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">H.323</a> <br />&nbsp;&nbsp;可用来邀请服务器入会。 <br />&nbsp;&nbsp;适合专业应用： <br />&nbsp;&nbsp;通过SMPTE 时标，RTSP支持帧级精度，允<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E8%AE%B8%E8%BF%9C&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">许远</a>程数字编辑 <br />&nbsp;&nbsp;演示描述中立： <br />&nbsp;&nbsp;协议没强加特殊演示或元文件，可传送所用格式类型；然而，演示描述至少必须包含一个RTSP URI。 <br />&nbsp;&nbsp;代理与防火墙友好： <br />&nbsp;&nbsp;协议可由应用和传输层防火墙处理。防火墙需要理解SETUP方法，为UDP媒体流打开一个&#92;&quot;缺口&#92;&quot;。 <br />&nbsp;&nbsp;HTTP友好： <br />&nbsp;&nbsp;此处，RTSP明智的采用HTTP观念，使现在结构都可重用。结构包括Internet 内容选择平台（PICS）。由于在大多数情况下控制连续媒体需要服务器状态， RTSP不仅仅向HTTP 添加方法。 <br />&nbsp;&nbsp;适当的服务器控制： <br />&nbsp;&nbsp;如用户启动一个流，他必须也可以停止一个流。 <br />&nbsp;&nbsp;传输协调； <br />&nbsp;&nbsp;实际处理连续媒体流前，用户 可协调传输方法。 <br />&nbsp;&nbsp;性能协调： <br />&nbsp;&nbsp;如基本特征无效，必须有一些清理机制让用户决定那种方法没生效。这允许用户提出适合的<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">用户界面</a>。 <br />&nbsp;&nbsp;6.3.1.3扩展RTSP <br />&nbsp;&nbsp;由于不是所有媒体服务器有着相同的功能，媒体服务器有必要支持不同请求集。RTSP 可以如下三种方式扩展，这里以改变大小排序： <br />&nbsp;&nbsp;以新参数扩展。如用户需要拒绝通知，而方法扩展不支持，相应标记就加入要求的段中。 <br />&nbsp;&nbsp;加入新方法。如信息接收者不理解请求，返回501<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E9%94%99%E8%AF%AF%E4%BB%A3%E7%A0%81&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">错误代码</a>（还未实现），发送者不应再次尝试这种方法。用户可使用OPTIONS方法查询服务器支持的方法。服务器使用公共响应头列出支持的方法。 <br />&nbsp;&nbsp;定义新版本协议，允许改变所有部分。（除了协议版本号位置） <br />&nbsp;&nbsp;6.3.1.4操作模式 <br />&nbsp;&nbsp;每个演示和媒体流可用RTSP URL识别。演示组成的整个演示与媒体属性由演示描述文件定义。使用HTTP或其它途径用户可获得这个文件，它没有必要保存在媒体服务器上。 <br />&nbsp;&nbsp;为了说明，假设演示描述描述了多个演示，其中每个演示维持了一个公共<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E6%97%B6%E9%97%B4%E8%BD%B4&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">时间轴</a>。为简化说明，且不失一般性，假定演示描述的确包含这样一个演示。演示可包含多个媒体流。除媒体参数外，网络目标地址和端口也需要决定。下面区分几种操作模式： <br />&nbsp;&nbsp;<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%8D%95%E6%92%AD&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">单播</a>： <br />&nbsp;&nbsp;以用户选择的<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%AB%AF%E5%8F%A3%E5%8F%B7&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">端口号</a>将媒体发送到RTSP请求源。 <br />&nbsp;&nbsp;组播，服务器选择地址： <br />&nbsp;&nbsp;媒体服务器选择<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%BB%84%E6%92%AD%E5%9C%B0%E5%9D%80&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">组播地址</a>和端口，这是<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%8E%B0%E5%9C%BA%E7%9B%B4%E6%92%AD&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">现场直播</a>或准点播常用的方式。 <br />&nbsp;&nbsp;组播，用户选择地址： <br />&nbsp;&nbsp;如服务器加入正在进行的组播会议，<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E7%BB%84%E6%92%AD%E5%9C%B0%E5%9D%80&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">组播地址</a>、端口和密匙由会议描述给出。 <br />&nbsp;&nbsp;6.3.1.5 RTSP状态 <br />&nbsp;&nbsp;RTSP控制通过单独协议发送的流，与控制通道无关。例如，RTSP控制可通过TCP连接，而数据流通过UDP。因此，即使媒体服务器没有收到请求，数据也会继续发送。在连接生命期，单个媒体流可通过不同TCP连接顺序发出请求来控制。所以，服务器需要维持能联系流与RTSP请求的连接状态。RTSP中很多方法与状态无关，但下列方法在定义服务器流资源的分配与应用上起着重要的作用： <br />&nbsp;&nbsp;SETUP： <br />&nbsp;&nbsp;让服务器给流分配资源，启动RTSP连接。 <br />&nbsp;&nbsp;PLAY与RECORD： <br />&nbsp;&nbsp;启动SETUP 分配流的数据传输。 <br />&nbsp;&nbsp;PAUSE： <br />&nbsp;&nbsp;临时停止流，而不释放服务器资源。 <br />&nbsp;&nbsp;TEARDOWN： <br />&nbsp;&nbsp;释放流的资源，RTSP连接停止。 <br />&nbsp;&nbsp;标识状态的RTSP方法使用连接头段识别RTSP连接，为响应SETUP请求，服务器连 <br />&nbsp;&nbsp;接产生连接标识。 <br />&nbsp;&nbsp;<br />&nbsp;&nbsp;6.3.1.6 与其他协议关系 <br />&nbsp;&nbsp;RTSP在功能上与HTTP有重叠，与HTTP相互作用体现在与流内容的初始接触是通过网页的。目前的协议规范目的在于允许在网页服务器与实现RTSP媒体服务器之间存在不同传递点。例如，演示描述可通过HTTP和RTSP检索，这降低了浏览器的往返传递，也允许独立RTSP 服务器与用户不全依靠HTTP。 <br />&nbsp;&nbsp;但是，RTSP与HTTP 的本质差别在于数据发送以不同协议进行。HTTP是不对称协议，用户发出请求，服务器作出响应。RTSP中，媒体用户和服务器都可发出请求，且其请求都是无状态的；在请求确认后很长时间内，仍可设置参数，控制媒体流。重用HTTP功能至少在两个方面有好处，即安全和代理。要求非常接近，在缓存、代理和授权上采用HTTP功能是有价值的。 <br />&nbsp;&nbsp;当大多数实时媒体使用RTP作为传输协议时，RTSP没有绑定到RTP。RTSP假设存在演示描述格式可表示包含几个媒体流的演示的静态与临时属性。 <br />&nbsp;&nbsp;<br />&nbsp;&nbsp;6.3.2 协议参数 <br />&nbsp;&nbsp;<br />&nbsp;&nbsp;6.3.3 RTSP 信息 <br />&nbsp;&nbsp;RTSP是基于文本的协议，采用ISO 10646 <a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="null" target="_blank" class="inner-link decor-none">字符集</a>，使用<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=UTF-8&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">UTF-8</a>编码方案。行以CRLF中断，但接收者本身可将CR和LF解释成行终止符。基于文本的协议使以自描述方式增加可选参数更容易。由于参数的数量和命令的频率出现较低，处理效率没引起注意。如仔细研究，文本协议很容易以<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">脚本语言</a>（如：Tcl、<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=Visual%20Basic&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">Visual Basic</a>与Perl）实现研究原型。 <br />&nbsp;&nbsp;10646<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%AD%97%E7%AC%A6%E9%9B%86&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">字符集</a>避免敏感<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%AD%97%E7%AC%A6%E9%9B%86&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">字符集</a>切换，但对应用来说不可见。RTCP也采用这种编码方案。带有重要意义位的<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=ISO%208859-1&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">ISO 8859-1</a>字符表示如100001x 10xxxxxx.。RTSP信息可通过任何低层传输协议携带。 <br />&nbsp;&nbsp;请求包括方法、方法作用于其上的对象和进一步描述方法的参数。方法也可设计为在服务器端只需要少量或不需要状态维护。当信息体包含在信息中，信息体长度有如下因素决定： <br />&nbsp;&nbsp;不管实体头段是否出现在信息中，不包括信息体的的响应信息总以头段后第一和空行结束。 <br />&nbsp;&nbsp;如出现内容长度头段，其值以字节计，表示信息体长度。如未出现头段，其值为零。 <br />&nbsp;&nbsp;服务器关闭连接。 <br />&nbsp;&nbsp;注意：RTSP目前并不支持HTTP/1.1&#92;&quot;块&#92;&quot;传输编码，需要有内容长度头。假如返回适度演示描述长度，即使动态产生，使块传输编码没有必要，服务器也应该能决定其长度。如有实体，即使必须有内容长度，且长度没显式给出，规则可确保行为合理。 <br />&nbsp;&nbsp;从用户到服务器端的请求信息在第一行内包括源采用的方法、源标识和所用协议版本。RTSP定义了附加状态代码，而没有定义任何HTTP代码。 <br />&nbsp;&nbsp;6.3.4 实体 <br />&nbsp;&nbsp;如不受请求方法或响应状态编码限制，请求和响应信息可传输实体，实体由实体<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E5%A4%B4%E6%96%87%E4%BB%B6&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">头文件</a>和试题体组成，有些响应仅包括实体头。在此，根据谁发送实体、谁接收实体，发送者和接收者可分别指用户和服务器。 <br />&nbsp;&nbsp;实体头定义实体体可选元信息，如没有实体体，指请求标识的资源。扩展头机制允<a style="color: #2d64b3; text-decoration: none" rel="nofollow" href="http://zhidao.baidu.com/search?word=%E8%AE%B8%E5%AE%9A&amp;fr=qb_search_exp&amp;ie=utf8" target="_blank" class="inner-link decor-none">许定</a>义附加实体头段，而不用改变协议，但这些段不能假定接收者能识别。不可识别头段应被接收者忽略，而让代理转发。 <br />&nbsp;&nbsp;6.3.5 连接 <br />&nbsp;&nbsp;RTSP请求可以几种不同方式传送： <br />&nbsp;&nbsp;1、持久传输连接，用于多个请求/响应传输。 <br />&nbsp;&nbsp;2、每个请求/响应传输一个连接。 <br />&nbsp;&nbsp;3、无连接模式。 <br />&nbsp;&nbsp;传输连接类型由RTSP URI来定义。对 &#92;&quot;rtsp&#92;&quot; 方案，需要持续连接；而&#92;&quot;rtspu&#92;&quot;方案，调用RTSP 请求发送，而不用建立连接。 <br />&nbsp;&nbsp;不象HTTP，RTSP允许媒体服务器给媒体用户发送请求。然而，这仅在持久连接时才支持，否则媒体服务器没有可靠途径到达用户，这也是请求通过防火墙从媒体服务器传到用户的唯一途径。 <br />&nbsp;&nbsp;6.3.6 方法定义 <br />&nbsp;&nbsp;方法记号表示资源上执行的方法，它区分大小写。新方法可在将来定义，但不能以$开头。 <br />&nbsp;&nbsp;某些防火墙设计与其</pre>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5432</link>
<title><![CDATA[Parallelization of the x264 encoder using OpenCL]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[音视频与流媒体]]></category>
<pubDate>Fri, 06 Sep 2013 06:54:44 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5432</guid> 
<description>
<![CDATA[ 
	<a href="http://li5.ziti.uni-heidelberg.de/x264gpu/">http://li5.ziti.uni-heidelberg.de/x264gpu/</a><br /><br /><h2 style="line-height: 1.2em; color: #333333; font-weight: normal; margin: 20px 0px 10px -1px; font-family: Arial, Helvetica, sans-serif">Description</h2><p style="margin: 0px 0px 5px; font-family: Arial, Helvetica, sans-serif; font-size: 14px; line-height: 18.71875px">With the introduction of H.264, the complexity on video encoders has increased dramatically. As hardware based encoding solutions profit from the strict sequential design and already feature real time capabilities for high definition material, software solutions lack most of the encoding performance. More precisely, the performance of software encoders is limited due to the computation power of encoding system as well as the high level of codec-intern dependencies. As a consequence, software encoders supporting high definition needs are very rare.</p><p style="margin: 0px 0px 5px; font-family: Arial, Helvetica, sans-serif; font-size: 14px; line-height: 18.71875px">The increasing computation power of massive parallel architectures such as modern graphics devices can be used to speed-up the encoding of H.264 video material. Compared to plain hardware solutions, graphics device powered encoders have the advantage of much lower initial costs and at the same time offer the flexibility of boosting the performance with future device upgrades. In addition, computers of today already include high performance graphics devices, which improve encoding times with nearly zero extra costs. While other stand alone GPU accelerated encoding solutions exist for H.264, this work shows the first working parallelization of the open source H.264 encoder x264 using OpenCL.</p><p style="margin: 0px 0px 5px; font-family: Arial, Helvetica, sans-serif; font-size: 14px; line-height: 18.71875px">In the beginning, the parallelization was targeting a straight forward OpenCL based motion estimation without the actual integra- tion into the encoding process. One straight forward approach was based upon the sub-optimal Three Step Search (TSS) algorithm. The implemented Assisted Three Step Search introduced additional assistant points for more concurrency. In addition, a second algorithm was implemented, derived from the computationally intensive Exhaustive Search (ES) &ndash; Full Search &ndash; algorithm. The Exhaustive Search Derivation (ESD) differs in using a reduced set of candidates &ndash; only a fourth of the original set &ndash; examining even positioned translations only.</p><p style="margin: 0px 0px 5px; font-family: Arial, Helvetica, sans-serif; font-size: 14px; line-height: 18.71875px">After finishing the motion estimation, the OpenCL powered computation was integrated into the encoding flow of the x264 encoder by a plain serial design. In favor of higher encoding speeds, better device utilization as well as better adaption to the encoder architecture, the serial design was later replaced by a more autonomous OpenCL working thread approach. The new working thread pipeline was optimized by using principles from the RISC architecture. More precisely, the estimation and selection modules were stripped down to a single process, moving the extracted functionality to discrete modules. In a final step, the sub-sequential Motion Estimation, Transformation and Quantization processes were ported to OpenCL and merged into the pipeline as well.</p><p style="margin: 0px 0px 5px; font-family: Arial, Helvetica, sans-serif; font-size: 14px; line-height: 18.71875px">While the Transformation was applied on blocks with 4x4 size conforming to the H.264 specification, the final Quantization process was implemented equally to the variant used inside the original x264 encoder. Compared to the H.264 specification, the x264 encoder merges the element-wise multiplication of the DCT with the Quantization step using an LUT based approach.</p><p style="margin: 0px 0px 5px; font-family: Arial, Helvetica, sans-serif; font-size: 14px; line-height: 18.71875px">Considering the fact that only a fraction of the motion estimation capabilities have been ported to OpenCL, the OpenCL powered encoding is up to 55% faster than the original Full Search based encoding of the unmodified x264. While other GPU solutions claim up to 20x speedup, independent tests against unmodified x264 shows similar gains as our implementation for FullHD. Furthermore, the current work is the first open-source, working integration into the x264 encoder that enables it to profit from the computing power of high performance graphics devices.</p><h2 style="line-height: 1.2em; color: #333333; font-weight: normal; margin: 20px 0px 10px -1px; font-family: Arial, Helvetica, sans-serif">Contacts</h2><ul style="margin: 0px 0px 15px 28px; padding-left: 0px; font-family: Arial, Helvetica, sans-serif; font-size: 14px; line-height: 18.71875px"><li style="line-height: 1.2em; padding-left: 0px; padding-top: 0.2em; padding-bottom: 0.3em; list-style-type: square">Erich Marth ( erich.marth .at. googlemail.com )</li><li style="line-height: 1.2em; padding-left: 0px; padding-top: 0.2em; padding-bottom: 0.3em; list-style-type: square">Guillermo Marcus ( guillermo.marcus .at. ziti.uni-heidelberg.de )</li></ul><h2 style="line-height: 1.2em; color: #333333; font-weight: normal; margin: 20px 0px 10px -1px; font-family: Arial, Helvetica, sans-serif">Downloads</h2><ul style="margin: 0px 0px 15px 28px; padding-left: 0px; font-family: Arial, Helvetica, sans-serif; font-size: 14px; line-height: 18.71875px"><li style="line-height: 1.2em; padding-left: 0px; padding-top: 0.2em; padding-bottom: 0.3em; list-style-type: square"><a style="color: #990000; text-decoration: none" href="http://li5.ziti.uni-heidelberg.de/x264gpu/x264demo.zip">x264demo</a>&nbsp;(ZIP file, 506K)</li></ul><p style="margin: 0px 0px 5px; font-family: Arial, Helvetica, sans-serif; font-size: 14px; line-height: 18.71875px">This demo includes the full source code in OpenCL, plus some scripts to fetch images from &quot;Big Buck Bunny&quot; and encode them using x264. Please note that the download of the source images might take a long time and take some serious space in your hard drive (~3.4G). We are working in adding the source code to the x264 development tree.</p><h2 style="line-height: 1.2em; color: #333333; font-weight: normal; margin: 20px 0px 10px -1px; font-family: Arial, Helvetica, sans-serif">References</h2><ul style="margin: 0px 0px 15px 28px; padding-left: 0px; font-family: Arial, Helvetica, sans-serif; font-size: 14px; line-height: 18.71875px"><li style="line-height: 1.2em; padding-left: 0px; padding-top: 0.2em; padding-bottom: 0.3em; list-style-type: square">CHEN, W.-N., AND HANG, H.-M. 2008. H.264/avc motion estimation implementation on compute unified device architecture (cuda). Tech. rep., National Chiao-Tung University.</li><li style="line-height: 1.2em; padding-left: 0px; padding-top: 0.2em; padding-bottom: 0.3em; list-style-type: square">CROSS, J., 2008. GPU Accelerated Video Transcoding. Online Article, December.&nbsp;<a style="color: #990000; text-decoration: none" href="http://www.extremetech.com/article2/0,2845,2337057,00.asp">[online]</a></li><li style="line-height: 1.2em; padding-left: 0px; padding-top: 0.2em; padding-bottom: 0.3em; list-style-type: square">SCHWALB, M., EWERTH, R., AND FREISLEBEN, B. 2009. Fast motion estimation on graphics hardware for h.264 video encoding. Trans. Multi. 11, 1, 1&ndash;10.</li><li style="line-height: 1.2em; padding-left: 0px; padding-top: 0.2em; padding-bottom: 0.3em; list-style-type: square">SHIMPI, A. A., 2008. Badaboom: A Full Test of Elemental&rsquo;s GPU Accelerated H.264 Transcoder. Online Article, August.&nbsp;<a style="color: #990000; text-decoration: none" href="http://www.anandtech.com/show/2586">[online]</a></li></ul>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5427</link>
<title><![CDATA[基于FFmpeg和Qt的播放器]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[音视频与流媒体]]></category>
<pubDate>Thu, 05 Sep 2013 07:01:13 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5427</guid> 
<description>
<![CDATA[ 
	<p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 24px; color: #333333; font-family: 'DejaVu Sans Condensed', Helvetica, Tahoma, Arial, sans-serif, 宋体">很久以前就想用FFmpeg做个播放器，用Qt做gui。但是能力有限。网上大多数都是讲ffplay的，ffplay代码太长看着不舒服没花时间看。最近有个项目要用到视频播放功能，一开始用了phonon，用起来方便，但是有点不足，比如gui用的是QWidget的组件，我是希望用graphics framework ，自定义功能也不多。最重要的是我重装win8后不能工作，于是决定还是自己动手写个比较靠谱。知道原理之后发现并不难。</p><p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 24px; color: #333333; font-family: 'DejaVu Sans Condensed', Helvetica, Tahoma, Arial, sans-serif, 宋体"><strong>多线程</strong></p><p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 24px; color: #333333; font-family: 'DejaVu Sans Condensed', Helvetica, Tahoma, Arial, sans-serif, 宋体">&nbsp; &nbsp; 其实总体思路还是比较简单的，用3个线程（除掉主线程），一个是分离器（demuxer）的线程，它的工作就是读取并分解音视频流，把数据包放到音/视频包的队列里。另外两个线程就是音频（播音频会阻塞）和视频解码播放线程了，它们的工作就是读取队列里的数据包进行解码，然后输出到窗口或音频设备。</p><p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 24px; color: #333333; font-family: 'DejaVu Sans Condensed', Helvetica, Tahoma, Arial, sans-serif, 宋体"><strong>同步</strong></p><p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 24px; color: #333333; font-family: 'DejaVu Sans Condensed', Helvetica, Tahoma, Arial, sans-serif, 宋体">&nbsp; &nbsp; 看到网上讨论比较多的就是音视频同步，最开始其实我很傻地根据视频的帧率设置个timer，每隔多少个毫秒进行读取解码输出，也就一个线程，这个非常不精确。后来测试了下音频播放，发现不像视频那样循环得快了就播放速度变快，音频的播放速率最后会稳定到正常速度的（还不知道为什么，貌似要改变音频速率就要resample一下），怪不得别人经常说要把视频同步到音频。理解这点之后操作起来就非常简单了，音频解码的数据包里有个时间戳pts（有时候分离好后要处理下），播放这个包时记下这个时间戳，视频线程要播放视频包时时间戳和音频的对比下，快了就wait一下，慢了就赶紧播或者丢帧，这样处理后同步就没问题了。很简单，代码也很短，效果也很好。</p><p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 24px; color: #333333; font-family: 'DejaVu Sans Condensed', Helvetica, Tahoma, Arial, sans-serif, 宋体"><strong>缓冲</strong></p><p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 24px; color: #333333; font-family: 'DejaVu Sans Condensed', Helvetica, Tahoma, Arial, sans-serif, 宋体">&nbsp; &nbsp; &nbsp;还有一个要注意的是分离线程应该分离多少数据包，因为你让那个线程不停地跑的话一会儿整个视频就被读取光了，没必要，而且非常占内存，而你播放的时候并不需要那么多数据包。所以可以设置个缓冲，音视频包队列堆积到一定数量后就wait一下让解码播放线程继续跑一会，当队列里的数据包比较少的时候唤醒分离线程，叫它继续读取点数据。这样，可以把播放器的内存占用降到很小。我做了个简单的对比，用mplayer、迅雷看看还有我的播放器播放一个4G大小的视频，那两个播放器内存都要200多M，我的稳定在50多点，效果很明显啊！而且对播放流畅度神马的无影响。</p><p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 24px; color: #333333; font-family: 'DejaVu Sans Condensed', Helvetica, Tahoma, Arial, sans-serif, 宋体">&nbsp; &nbsp; 音频播放目前用的是portaudio。windows上没问题，linux上有点问题。不知道有没有其他的跨平台的库可以播放音频。</p><p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 24px; color: #333333; font-family: 'DejaVu Sans Condensed', Helvetica, Tahoma, Arial, sans-serif, 宋体">&nbsp; &nbsp; 播放器也刚刚开始做，目前功能还比较简单，就是能正常播放视频了。不能seek，不支持字幕。还有个bug，就是缩放窗口时经常崩溃，我也崩溃了，还没找到原因。</p><p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 24px; color: #333333; font-family: 'DejaVu Sans Condensed', Helvetica, Tahoma, Arial, sans-serif, 宋体">&nbsp; &nbsp; 废话了这么多，最后贴上项目网址：https://github.com/wang-bin/QtAV</p><p style="margin: 0px 0px 0.75em; font-size: 16px; line-height: 24px; color: #333333; font-family: 'DejaVu Sans Condensed', Helvetica, Tahoma, Arial, sans-serif, 宋体">&nbsp; &nbsp; 欢迎大家共同学习交流音视频播放的问题，也欢迎参与写播放器</p>
]]>
</description>
</item>
</channel>
</rss>