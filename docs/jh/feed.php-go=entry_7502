<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0">
<channel>
<title><![CDATA[流浪的龙－个人知识管理]]></title> 
<link>http://i.renjihe.com/blog/index.php</link> 
<description><![CDATA[]]></description> 
<language>zh-cn</language> 
<copyright><![CDATA[流浪的龙－个人知识管理]]></copyright>
<item>
<link>http://i.renjihe.com/blog/read.php?</link>
<title><![CDATA[nodejs中全局变量global对象]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[web]]></category>
<pubDate>Wed, 24 Aug 2016 11:39:18 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?</guid> 
<description>
<![CDATA[ 
	<span style="font-size: 14px; line-height: 20px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd">作为一个javascript初学者，都在不知不觉的使用全局变量，用了许久之后，前辈告诉我们不要用去全局变量，然后想尽办法不使用全局变量，使用模块化的思路去解决问题。</span><br /><br /><span style="font-size: 14px; line-height: 20px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd">但是到了nodejs中来，模块的全局变量只能在模块用，不能拿到外面去用，当然这是非常好设计，作为天生就能模块化的封装，还能有效的隔离各个模块的耦合，符合我对模块化的期待。事实上在nodejs的实现代码中发现，require一个模块是一个沙箱中执行，简单的想就是在一个毕包里面执行的，这样，沙箱外面是无法访问到。</span><br /><br /><span style="font-size: 14px; line-height: 20px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd">但是在翻阅nodejs的文档时，发现有一个global对象，可以用于定义整个runtime时期的全局变量。还是罪恶的来看看怎么使用吧。</span><br /><br /><span style="font-size: 14px; line-height: 20px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd">module1.js:</span><div style="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; line-height: 20px; border: 1px solid #cccccc; padding: 4px 5px 4px 4px; width: 1380.81px; font-size: 13px; word-break: break-all; background-color: #eeeeee">module.exports=&#123;&#125;;<br /><span style="color: #008000">//</span><span style="color: #008000">耻辱的使用了全局变量</span><span style="color: #008000"><br /></span>global.varA&nbsp;=&nbsp;&quot;abc&quot;;</div><br /><span style="font-size: 14px; line-height: 20px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd">main.js:</span><br /><div style="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; line-height: 20px; border: 1px solid #cccccc; padding: 4px 5px 4px 4px; width: 1380.81px; font-size: 13px; word-break: break-all; background-color: #eeeeee"><span style="color: #0000ff">var</span>&nbsp;c&nbsp;=&nbsp;require(&quot;./calculator&quot;);<br />console.log(global.varA);<span style="color: #008000">//</span><span style="color: #008000">使用global对象访问到&quot;全局&quot;变量</span><span style="color: #008000"><br /></span></div><br /><span style="font-size: 14px; line-height: 20px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd">非常丑陋的代码，很好的反面教材，事实上，在我学习从全局变量转向的模块化防止各种全局变量的过程中，我通常使用的是这儿一种方法：</span><div style="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; line-height: 20px; border: 1px solid #cccccc; padding: 4px 5px 4px 4px; width: 1380.81px; font-size: 13px; word-break: break-all; background-color: #eeeeee">module.exports&nbsp;=&nbsp;(<span style="color: #0000ff">function</span>()&#123;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000ff">var</span>&nbsp;_value&nbsp;=&nbsp;1;<span style="color: #008000">//</span><span style="color: #008000">在函数内声明一个变量，作用域是函数内</span><span style="color: #008000"><br /></span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000ff">return</span>&nbsp;<span style="color: #0000ff">function</span>()&#123;&nbsp;<span style="color: #008000">//</span><span style="color: #008000">返回的一个function能访问到_value，所以_value并不是global级别的变量，但是可以通过这个接口访问到</span><span style="color: #008000"><br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000ff">return</span>&nbsp;_value++;<br />&nbsp;&nbsp;&nbsp;&nbsp;&#125;;<br /><br />&#125;)();<span style="color: #008000">//</span><span style="color: #008000">一个立即执行的匿名函数</span></div><br /><span style="font-size: 14px; line-height: 20px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd">main.js:</span><br /><div style="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; line-height: 20px; border: 1px solid #cccccc; padding: 4px 5px 4px 4px; width: 1380.81px; font-size: 13px; word-break: break-all; background-color: #eeeeee"><img src="http://www.blogjava.net/Images/OutliningIndicators/None.gif" border="0" align="top" /><span style="color: #0000ff">var</span>&nbsp;c&nbsp;=&nbsp;require(&quot;./module1&quot;);<br /><img src="http://www.blogjava.net/Images/OutliningIndicators/None.gif" border="0" align="top" /><br /><img src="http://www.blogjava.net/Images/OutliningIndicators/None.gif" border="0" align="top" />console.log(c());<span style="color: #008000">//</span><span style="color: #008000">1</span><span style="color: #008000"><br /><img src="http://www.blogjava.net/Images/OutliningIndicators/None.gif" border="0" align="top" /></span>console.log(c());<span style="color: #008000">//</span><span style="color: #008000">2</span></div><br /><span style="font-size: 14px; line-height: 20px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd">一个很好的技巧，从web中的js环境到nodejs环境，屡试不爽。</span><br /><br /><span style="font-size: 14px; line-height: 20px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd">关于global对象，实际使用中可以省去global. 他是默认的根作用域，相当于web环境中的window对象。</span><br /><br /><span style="font-size: 14px; line-height: 20px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd">global 对象有几个挺有用的属性：</span><br /><p style="font-size: 13px; line-height: 19.5px; margin: 10px 0px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd">&nbsp;</p><div style="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; line-height: 20px; border: 1px solid #cccccc; padding: 4px 5px 4px 4px; width: 1380.81px; font-size: 13px; word-break: break-all; background-color: #eeeeee">console.log(__dirname);<span style="color: #008000">//</span><span style="color: #008000">当前路径</span><span style="color: #008000"><br /></span>console.log(__filename);<span style="color: #008000">//</span><span style="color: #008000">当前在执行的js文件路径</span><span style="color: #008000"><br />//</span><span style="color: #008000">global.process&nbsp;获取当前的Process实例</span></div><p style="font-size: 13px; line-height: 19.5px; margin: 10px 0px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd">&nbsp;</p><p style="font-size: 13px; line-height: 19.5px; margin: 10px 0px; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; background-color: #eeeedd"><br />global对象的文档：<a style="color: #770000; text-decoration: none" href="http://nodejs.org/api/globals.html">http://nodejs.org/api/globals.html</a></p>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?#blogcomment</link>
<title><![CDATA[[评论] nodejs中全局变量global对象]]></title> 
<author> &lt;user@domain.com&gt;</author>
<category><![CDATA[评论]]></category>
<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?#blogcomment</guid> 
<description>
<![CDATA[ 
	
]]>
</description>
</item>
</channel>
</rss>