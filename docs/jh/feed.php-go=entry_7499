<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0">
<channel>
<title><![CDATA[流浪的龙－个人知识管理]]></title> 
<link>http://i.renjihe.com/blog/index.php</link> 
<description><![CDATA[]]></description> 
<language>zh-cn</language> 
<copyright><![CDATA[流浪的龙－个人知识管理]]></copyright>
<item>
<link>http://i.renjihe.com/blog/read.php?</link>
<title><![CDATA[Nodejs异步流程控制Async]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[web]]></category>
<pubDate>Wed, 24 Aug 2016 11:37:58 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?</guid> 
<description>
<![CDATA[ 
	<p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><a style="margin: 0pt; padding: 0pt; color: #0e73b8; outline-style: none; outline-width: medium; text-decoration: none" href="http://blog.fens.me/series-nodejs/" target="_blank" title="从零开始nodejs系列文章">从零开始nodejs系列文章</a>，将介绍如何利Javascript做为服务端脚本，通过Nodejs框架web开发。Nodejs框架是基于V8的引擎，是目前速度最快的Javascript引擎。chrome浏览器就基于V8，同时打开20-30个网页都很流畅。Nodejs标准的web开发框架Express，可以帮助我们迅速建立web站点，比起PHP的开发效率更高，而且学习曲线更低。非常适合小型网站，个性化网站，我们自己的Geek网站！！</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">关于作者</strong></p><ul style="margin: 0pt 0pt 0pt 0px; padding: 0pt 0pt 0pt 0px; list-style: none; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">张丹(Conan), 程序员Java,R,PHP,Javascript</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">weibo：@Conan_Z</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">blog:&nbsp;<a style="margin: 0pt; padding: 0pt; color: #0e73b8; outline-style: none; outline-width: medium; text-decoration: none" href="http://blog.fens.me/" target="_blank" title="粉丝日志&#124;跨界的IT博客">http://blog.fens.me</a></li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">email: bsspirit@gmail.com</li></ul><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">转载请注明出处：</strong><br /><a style="margin: 0pt; padding: 0pt; color: #0e73b8; outline-style: none; outline-width: medium; text-decoration: none" href="http://blog.fens.me/nodejs-async/" target="_blank" title="Nodejs异步流程控制Async">http://blog.fens.me/nodejs-async/</a></p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><a style="margin: 0pt; padding: 0pt; color: #0e73b8; outline-style: none; outline-width: medium; text-decoration: none" href="http://blog.fens.me/wp-content/uploads/2013/09/nodejs-async.png"><img style="margin: 0pt; padding: 0pt; border: none; max-width: 620px; height: auto" class="alignnone size-full wp-image-2406" src="http://blog.fens.me/wp-content/uploads/2013/09/nodejs-async.png" border="0" alt="nodejs-async" width="600" height="400" /></a></p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">前言</strong></p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">Nodejs框架类库很多，功能相近的框架，本来只打算学一种写一种。之前写过流程控制框架<a style="margin: 0pt; padding: 0pt; color: #0e73b8; outline-style: none; outline-width: medium; text-decoration: none" href="http://blog.fens.me/nodejs-async-windjs/" target="_blank" title="wind.js助力异步编程">windjs文章</a>，本来是想着要支持一下&ldquo;国人框架&rdquo;。无奈啊，作者竟然放弃了维护，国人真的不靠谱啊！</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">&ldquo;流程控制&rdquo;本来是件比较简单的事，但是由于Nodejs的异步架构的实现方法，对于需要同步的业务逻辑，实现起来就比较麻烦。嵌套3-4层，代码就会变得的支离破碎了！</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">今天就遇到了一个业务逻辑，连续对数据库操作，前后有依赖。让我们看看Async是如何解决问题的。</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">不用不知道，一用真强大！！</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">目录</strong></p><ol style="margin: 0px; padding: 0px 0px 0px 35px; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><li style="margin-top: 0px; margin-right: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 0px !important; list-style: decimal outside none !important">Async介绍</li><li style="margin-top: 0px; margin-right: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 0px !important; list-style: decimal outside none !important">Async安装</li><li style="margin-top: 0px; margin-right: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 0px !important; list-style: decimal outside none !important">Async函数介绍</li><li style="margin-top: 0px; margin-right: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 0px !important; list-style: decimal outside none !important">async_demo使用介绍</li><li style="margin-top: 0px; margin-right: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 0px !important; list-style: decimal outside none !important">场景：对数据库的连续操作</li><li style="margin-top: 0px; margin-right: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 0px !important; list-style: decimal outside none !important">async_demo我的分支</li></ol><h2 style="margin: 25px 0px 10px; padding: 0pt 0pt 5px; font-size: 20px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 26px; color: #434343; transition: color 0.2s linear">1. Async介绍</h2><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">Async是一个流程控制工具包，提供了直接而强大的异步功能。基于Javascript为Node.js设计，同时也可以直接在浏览器中使用。</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">Async提供了大约20个函数，包括常用的 map, reduce, filter, forEach 等，异步流程控制模式包括，串行(series)，并行(parallel)，瀑布(waterfall)等。</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">项目地址：<a style="margin: 0pt; padding: 0pt; color: #0e73b8; outline-style: none; outline-width: medium; text-decoration: none" href="https://github.com/caolan/async" target="_blank" title="async">https://github.com/caolan/async</a></p><h2 style="margin: 25px 0px 10px; padding: 0pt 0pt 5px; font-size: 20px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 26px; color: #434343; transition: color 0.2s linear">2. Async安装</h2><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">我的系统环境</strong></p><ul style="margin: 0pt 0pt 0pt 0px; padding: 0pt 0pt 0pt 0px; list-style: none; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">win7 64bit</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">Nodejs:v0.10.5</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">Npm:1.2.19</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">MySQL:Server version: 5.6.11 MySQL Community Server (GPL)</li></ul><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">我们做实验时，安装async有两个方式:</strong></p><ul style="margin: 0pt 0pt 0pt 0px; padding: 0pt 0pt 0pt 0px; list-style: none; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">1. 独立安装async</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">2. 下载async demo代码安装</li></ul><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">我建议大家用第二种方式安装，这样子实例的代码就都有了。</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">1). 独立安装async</strong></p><pre style="margin: 0pt 0pt 15px; padding: 10px; overflow: auto; color: #4d4d4f; font-size: 13px; line-height: 20px; background: none 0% 0% repeat scroll #f9f9d4"> ~ D:&#92;workspace&#92;javascript&gt;mkdir nodejs-async &amp;&amp; cd nodejs-async ~ D:&#92;workspace&#92;javascript&#92;nodejs-async&gt;npm install async npm http GET https://registry.npmjs.org/async npm http 304 https://registry.npmjs.org/async async@0.2.9 node_modules&#92;async </pre><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">打开网页,参照示例学习：<a style="margin: 0pt; padding: 0pt; color: #0e73b8; outline-style: none; outline-width: medium; text-decoration: none" href="https://github.com/bsspirit/async_demo" target="_blank">https://github.com/bsspirit/async_demo</a></p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">2). 下载async demo代码安装</strong></p><pre style="margin: 0pt 0pt 15px; padding: 10px; overflow: auto; color: #4d4d4f; font-size: 13px; line-height: 20px; background: none 0% 0% repeat scroll #f9f9d4"> ~ D:&#92;workspace&#92;javascript&gt;git clone git@github.com:bsspirit/async_demo.git nodejs-async ~ D:&#92;workspace&#92;javascript&gt;cd nodejs-async ~ D:&#92;workspace&#92;javascript&#92;nodejs-async&gt;npm install npm http GET https://registry.npmjs.org/moment npm http GET https://registry.npmjs.org/async npm http 304 https://registry.npmjs.org/moment npm http 304 https://registry.npmjs.org/async async@0.2.9 node_modules&#92;async moment@2.1.0 node_modules&#92;moment </pre><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">这套demo示例，比较全面的介绍了async的使用，有中文注释。 感谢github社区原创作者freewind，代码更新的贡献者alsotang。</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">当然，我的分支中也修改了一部分代码。在本文最后，我会写到changelog中！</p><h2 style="margin: 25px 0px 10px; padding: 0pt 0pt 5px; font-size: 20px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 26px; color: #434343; transition: color 0.2s linear">3. Async函数介绍</h2><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">基于async的0.2.9版本。</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">async主要实现了三个部分的流程控制功能：</strong></p><ul style="margin: 0pt 0pt 0pt 0px; padding: 0pt 0pt 0pt 0px; list-style: none; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">集合: Collections</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">流程控制: Control Flow</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">工具类: Utils</li></ul><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">1). 集合: Collections</strong></p><ul style="margin: 0pt 0pt 0pt 0px; padding: 0pt 0pt 0pt 0px; list-style: none; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">each: 如果想对同一个集合中的所有元素都执行同一个异步操作。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">map: 对集合中的每一个元素，执行某个异步操作，得到结果。所有的结果将汇总到最终的callback里。与each的区别是，each只关心操作不管最后的值，而map关心的最后产生的值。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">filter: 使用异步操作对集合中的元素进行筛选, 需要注意的是，iterator的callback只有一个参数，只能接收true或false。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">reject: reject跟filter正好相反，当测试为true时则抛弃</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">reduce: 可以让我们给定一个初始值，用它与集合中的每一个元素做运算，最后得到一个值。reduce从左向右来遍历元素，如果想从右向左，可使用reduceRight。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">detect: 用于取得集合中满足条件的第一个元素。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">sortBy: 对集合内的元素进行排序，依据每个元素进行某异步操作后产生的值，从小到大排序。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">some: 当集合中是否有至少一个元素满足条件时，最终callback得到的值为true，否则为false.</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">every: 如果集合里每一个元素都满足条件，则传给最终回调的result为true，否则为false</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">concat: 将多个异步操作的结果合并为一个数组。</li></ul><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">2). 流程控制: Control Flow</strong></p><ul style="margin: 0pt 0pt 0pt 0px; padding: 0pt 0pt 0pt 0px; list-style: none; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">series: 串行执行，一个函数数组中的每个函数，每一个函数执行完成之后才能执行下一个函数。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">parallel: 并行执行多个函数，每个函数都是立即执行，不需要等待其它函数先执行。传给最终callback的数组中的数据按照tasks中声明的顺序，而不是执行完成的顺序。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">whilst: 相当于while，但其中的异步调用将在完成后才会进行下一次循环。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">doWhilst: 相当于do&hellip;while, doWhilst交换了fn,test的参数位置，先执行一次循环，再做test判断。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">until: until与whilst正好相反，当test为false时循环，与true时跳出。其它特性一致。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">doUntil: doUntil与doWhilst正好相反，当test为false时循环，与true时跳出。其它特性一致。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">forever: 无论条件循环执行，如果不出错，callback永远不被执行。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">waterfall: 按顺序依次执行一组函数。每个函数产生的值，都将传给下一个。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">compose: 创建一个包括一组异步函数的函数集合，每个函数会消费上一次函数的返回值。把f(),g(),h()异步函数，组合成f(g(h()))的形式，通过callback得到返回值。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">applyEach: 实现给一数组中每个函数传相同参数，通过callback返回。如果只传第一个参数，将返回一个函数对象，我可以传参调用。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">queue: 是一个串行的消息队列，通过限制了worker数量，不再一次性全部执行。当worker数量不够用时，新加入的任务将会排队等候，直到有新的worker可用。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">cargo: 一个串行的消息队列，类似于queue，通过限制了worker数量，不再一次性全部执行。不同之处在于，cargo每次会加载满额的任务做为任务单元，只有任务单元中全部执行完成后，才会加载新的任务单元。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">auto: 用来处理有依赖关系的多个任务的执行。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">iterator: 将一组函数包装成为一个iterator，初次调用此iterator时，会执行定义中的第一个函数并返回第二个函数以供调用。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">apply: 可以让我们给一个函数预绑定多个参数并生成一个可直接调用的新函数，简化代码。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">nextTick: 与nodejs的nextTick一样，再最后调用函数。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">times: 异步运行,times可以指定调用几次，并把结果合并到数组中返回</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">timesSeries: 与time类似，唯一不同的是同步执行</li></ul><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">3). 工具类: Utils</strong></p><ul style="margin: 0pt 0pt 0pt 0px; padding: 0pt 0pt 0pt 0px; list-style: none; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">memoize: 让某一个函数在内存中缓存它的计算结果。对于相同的参数，只计算一次，下次就直接拿到之前算好的结果。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">unmemoize: 让已经被缓存的函数，返回不缓存的函数引用。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">log: 执行某异步函数，并记录它的返回值，日志输出。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">dir: 与log类似，不同之处在于，会调用浏览器的console.dir()函数，显示为DOM视图。</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">noConflict: 如果之前已经在全局域中定义了async变量，当导入本async.js时，会先把之前的async变量保存起来，然后覆盖它。仅仅用于浏览器端，在nodejs中没用，这里无法演示。</li></ul><h2 style="margin: 25px 0px 10px; padding: 0pt 0pt 5px; font-size: 20px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 26px; color: #434343; transition: color 0.2s linear">4. async_demo使用介绍</h2><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">详细使用请参考github源代码：<a style="margin: 0pt; padding: 0pt; color: #0e73b8; outline-style: none; outline-width: medium; text-decoration: none" href="https://github.com/bsspirit/async_demo" target="_blank">https://github.com/bsspirit/async_demo</a></p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">每个函数的用法，有非常详细的实例！！</p><h2 style="margin: 25px 0px 10px; padding: 0pt 0pt 5px; font-size: 20px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 26px; color: #434343; transition: color 0.2s linear">5. 场景：对数据库的连续操作</h2><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">这个场景进背景情况，请参考文章：<a style="margin: 0pt; padding: 0pt; color: #0e73b8; outline-style: none; outline-width: medium; text-decoration: none" href="http://blog.fens.me/nodejs-mysql-intro/" target="_blank" title="用Nodejs连接MySQL">用Nodejs连接MySQL</a></p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">原场景中，对数据串行操作，增删改查(CRUD)，代码如下：</p><pre style="margin: 0pt 0pt 15px; padding: 10px; overflow: auto; color: #4d4d4f; font-size: 13px; line-height: 20px; background: none 0% 0% repeat scroll #f9f9d4"> var mysql = require('mysql'); var conn = mysql.createConnection(&#123;&nbsp;&nbsp;&nbsp;&nbsp; host: 'localhost',&nbsp;&nbsp;&nbsp;&nbsp; user: 'nodejs',&nbsp;&nbsp;&nbsp;&nbsp; password: 'nodejs',&nbsp;&nbsp;&nbsp;&nbsp; database: 'nodejs',&nbsp;&nbsp;&nbsp;&nbsp; port: 3306 &#125;); conn.connect();&nbsp;&nbsp;var insertSQL = 'insert into t_user(name) values(&quot;conan&quot;),(&quot;fens.me&quot;)'; var selectSQL = 'select * from t_user limit 10'; var deleteSQL = 'delete from t_user'; var updateSQL = 'update t_user set name=&quot;conan update&quot;&nbsp;&nbsp;where name=&quot;conan&quot;';&nbsp;&nbsp;//delete conn.query(deleteSQL, function (err0, res0) &#123;&nbsp;&nbsp;&nbsp;&nbsp; if (err0) console.log(err0);&nbsp;&nbsp;&nbsp;&nbsp; console.log(&quot;DELETE Return ==&gt; &quot;);&nbsp;&nbsp;&nbsp;&nbsp; console.log(res0);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//insert&nbsp;&nbsp;&nbsp;&nbsp; conn.query(insertSQL, function (err1, res1) &#123;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (err1) console.log(err1);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(&quot;INSERT Return ==&gt; &quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(res1);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//query&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.query(selectSQL, function (err2, rows) &#123;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (err2) console.log(err2);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;SELECT ==&gt; &quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (var i in rows) &#123;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(rows[i]);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#125;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//update&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.query(updateSQL, function (err3, res3) &#123;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (err3) console.log(err3);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(&quot;UPDATE Return ==&gt; &quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(res3);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//query&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.query(selectSQL, function (err4, rows2) &#123;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (err4) console.log(err4);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;SELECT ==&gt; &quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (var i in rows2) &#123;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(rows2[i]);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#125;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#125;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#125;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#125;);&nbsp;&nbsp;&nbsp;&nbsp; &#125;); &#125;);&nbsp;&nbsp;//conn.end(); </pre><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">为了实现了串行操作，所有的调用都是在callback中实现的，5层嵌套结构。这种代码已经变得不可以维护了。所以，需要用async库，对上面的代码结构进行重写！</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">修改后的代码</strong></p><pre style="margin: 0pt 0pt 15px; padding: 10px; overflow: auto; color: #4d4d4f; font-size: 13px; line-height: 20px; background: none 0% 0% repeat scroll #f9f9d4"> var mysql = require('mysql'); var async = require('async');&nbsp;&nbsp;var conn = mysql.createConnection(&#123;&nbsp;&nbsp;&nbsp;&nbsp; host: 'localhost',&nbsp;&nbsp;&nbsp;&nbsp; user: 'nodejs',&nbsp;&nbsp;&nbsp;&nbsp; password: 'nodejs',&nbsp;&nbsp;&nbsp;&nbsp; database: 'nodejs',&nbsp;&nbsp;&nbsp;&nbsp; port: 3306 &#125;);&nbsp;&nbsp;var sqls = &#123;&nbsp;&nbsp;&nbsp;&nbsp; 'insertSQL': 'insert into t_user(name) values(&quot;conan&quot;),(&quot;fens.me&quot;)',&nbsp;&nbsp;&nbsp;&nbsp; 'selectSQL': 'select * from t_user limit 10',&nbsp;&nbsp;&nbsp;&nbsp; 'deleteSQL': 'delete from t_user',&nbsp;&nbsp;&nbsp;&nbsp; 'updateSQL': 'update t_user set name=&quot;conan update&quot;&nbsp;&nbsp;where name=&quot;conan&quot;' &#125;;&nbsp;&nbsp;var tasks = ['deleteSQL', 'insertSQL', 'selectSQL', 'updateSQL', 'selectSQL']; async.eachSeries(tasks, function (item, callback) &#123;&nbsp;&nbsp;&nbsp;&nbsp; console.log(item + &quot; ==&gt; &quot; + sqls[item]);&nbsp;&nbsp;&nbsp;&nbsp; conn.query(sqls[item], function (err, res) &#123;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; console.log(res);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; callback(err, res);&nbsp;&nbsp;&nbsp;&nbsp; &#125;); &#125;, function (err) &#123;&nbsp;&nbsp;&nbsp;&nbsp; console.log(&quot;err: &quot; + err); &#125;); </pre><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">控制台输出</strong></p><pre style="margin: 0pt 0pt 15px; padding: 10px; overflow: auto; color: #4d4d4f; font-size: 13px; line-height: 20px; background: none 0% 0% repeat scroll #f9f9d4"> deleteSQL ==&gt; delete from t_user &#123; fieldCount: 0,&nbsp;&nbsp; affectedRows: 0,&nbsp;&nbsp; insertId: 0,&nbsp;&nbsp; serverStatus: 34,&nbsp;&nbsp; warningCount: 0,&nbsp;&nbsp; message: '',&nbsp;&nbsp; protocol41: true,&nbsp;&nbsp; changedRows: 0 &#125; insertSQL ==&gt; insert into t_user(name) values(&quot;conan&quot;),(&quot;fens.me&quot;) &#123; fieldCount: 0,&nbsp;&nbsp; affectedRows: 2,&nbsp;&nbsp; insertId: 45,&nbsp;&nbsp; serverStatus: 2,&nbsp;&nbsp; warningCount: 0,&nbsp;&nbsp; message: '&amp;Records: 2&nbsp;&nbsp;Duplicates: 0&nbsp;&nbsp;Warnings: 0',&nbsp;&nbsp; protocol41: true,&nbsp;&nbsp; changedRows: 0 &#125; selectSQL ==&gt; select * from t_user limit 10 [ &#123; id: 45,&nbsp;&nbsp;&nbsp;&nbsp; name: 'conan',&nbsp;&nbsp;&nbsp;&nbsp; create_date: Fri Sep 13 2013 12:24:51 GMT+0800 (中国标准时间) &#125;,&nbsp;&nbsp; &#123; id: 46,&nbsp;&nbsp;&nbsp;&nbsp; name: 'fens.me',&nbsp;&nbsp;&nbsp;&nbsp; create_date: Fri Sep 13 2013 12:24:51 GMT+0800 (中国标准时间) &#125; ] updateSQL ==&gt; update t_user set name=&quot;conan update&quot;&nbsp;&nbsp;where name=&quot;conan&quot; &#123; fieldCount: 0,&nbsp;&nbsp; affectedRows: 1,&nbsp;&nbsp; insertId: 0,&nbsp;&nbsp; serverStatus: 2,&nbsp;&nbsp; warningCount: 0,&nbsp;&nbsp; message: '(Rows matched: 1&nbsp;&nbsp;Changed: 1&nbsp;&nbsp;Warnings: 0',&nbsp;&nbsp; protocol41: true,&nbsp;&nbsp; changedRows: 1 &#125; selectSQL ==&gt; select * from t_user limit 10 [ &#123; id: 45,&nbsp;&nbsp;&nbsp;&nbsp; name: 'conan update',&nbsp;&nbsp;&nbsp;&nbsp; create_date: Fri Sep 13 2013 12:24:51 GMT+0800 (中国标准时间) &#125;,&nbsp;&nbsp; &#123; id: 46,&nbsp;&nbsp;&nbsp;&nbsp; name: 'fens.me',&nbsp;&nbsp;&nbsp;&nbsp; create_date: Fri Sep 13 2013 12:24:51 GMT+0800 (中国标准时间) &#125; ] err: null </pre><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">代码一下读性就增强了许多倍，这就是高效的开发。</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">不用不知道，一用真强大！！！</p><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px">当然还有其他的工作流框架来完成这件事情step,then.js,windjs。<br />windjs请参考：<a style="margin: 0pt; padding: 0pt; color: #0e73b8; outline-style: none; outline-width: medium; text-decoration: none" href="http://blog.fens.me/nodejs-async-windjs/" target="_blank" title="wind.js助力异步编程">wind.js助力异步编程</a></p><h2 style="margin: 25px 0px 10px; padding: 0pt 0pt 5px; font-size: 20px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 26px; color: #434343; transition: color 0.2s linear">6. async_demo我的分支</h2><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><a style="margin: 0pt; padding: 0pt; color: #0e73b8; outline-style: none; outline-width: medium; text-decoration: none" href="https://github.com/bsspirit/async_demo" target="_blank">https://github.com/bsspirit/async_demo</a></p><ul style="margin: 0pt 0pt 0pt 0px; padding: 0pt 0pt 0pt 0px; list-style: none; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">1. forEach.js改名为each.js</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">2. each.js文件中的async.forEach，改为async.each</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">3. map.js增加mapLimit函数</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">4. filter_reject.js对注释补充</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">5. filter_reject.js增加rejectSeries函数</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">6. reduce.js增加注释</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">7. detect.js增加注释</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">8. sortBy.js增加注释</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">9. some.js对注释补充</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">10. every.js对注释补充和修改</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">11. series.js调整注释格式</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">12. parallel.js调整注释格式</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">13. parallel.js增加parallelLimit函数</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">14. whilist_until.js调整注释格式</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">15. whilist_until.js增加doWhilst函数</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">16. whilist_until.js增加doUntil函数</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">17. whilist_until.js增加forever函数</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">18. waterfall.js调整注释格式</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">19. 增加compose.js文件</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">20. apply.js补充注释并增加一个实例</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">21. 修改nextTick.js实例</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">22. 增加times.js文件，包括times和timesSeries函数</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">23. 修改iterator.js实例</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">24. 修正auto.js关于第二个实例的错误解释</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">25. 修改queue.js实例和注释</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">26. 修改cargo.js文件</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">27. 增加applyEach.js文件</li><li style="margin-top: 0pt; margin-right: 0pt; margin-left: 0pt; padding-top: 0pt; padding-right: 0pt; list-style: none outside none; margin-bottom: 5px !important; padding-bottom: 3px !important; padding-left: 22px !important; background: url('http://blog.fens.me/wp-content/themes/silesia/images/bullets/5.gif')">28. 修改utils.js实例和注释</li></ul><p style="margin: 10px 0pt 15px; padding: 0pt; color: #4d4d4f; font-family: Arial, Helvetica, sans-serif; font-size: 13px; line-height: 20px"><strong style="margin: 0pt; padding: 0pt">转载请注明出处：</strong><br /><a style="margin: 0pt; padding: 0pt; color: #0e73b8; outline-style: none; outline-width: medium; text-decoration: none" href="http://blog.fens.me/nodejs-async/" target="_blank" title="Nodejs异步流程控制Async">http://blog.fens.me/nodejs-async/</a></p>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?#blogcomment</link>
<title><![CDATA[[评论] Nodejs异步流程控制Async]]></title> 
<author> &lt;user@domain.com&gt;</author>
<category><![CDATA[评论]]></category>
<pubDate>Thu, 01 Jan 1970 00:00:00 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?#blogcomment</guid> 
<description>
<![CDATA[ 
	
]]>
</description>
</item>
</channel>
</rss>