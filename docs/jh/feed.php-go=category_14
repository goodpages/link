<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0">
<channel>
<title><![CDATA[流浪的龙－个人知识管理]]></title> 
<link>http://i.renjihe.com/blog/index.php</link> 
<description><![CDATA[]]></description> 
<language>zh-cn</language> 
<copyright><![CDATA[流浪的龙－个人知识管理]]></copyright>
<item>
<link>http://i.renjihe.com/blog/read.php?6081</link>
<title><![CDATA[QT自定义精美换肤界面]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[QT]]></category>
<pubDate>Fri, 22 Aug 2014 05:54:53 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?6081</guid> 
<description>
<![CDATA[ 
	<p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">陆陆续续用</span>QT<span style="margin: 0px; padding: 0px; font-family: 宋体">开发过很多项目，也用</span>QT<span style="margin: 0px; padding: 0px; font-family: 宋体">写过不少私活项目，也写过</span>N<span style="margin: 0px; padding: 0px; font-family: 宋体">个工具，一直梦寐以求能像</span>VC<span style="margin: 0px; padding: 0px; font-family: 宋体">一样可以很方便的有个自定义的界面，</span>QSS<span style="margin: 0px; padding: 0px; font-family: 宋体">的强大让我看到了很好的希望，辗转百度谷歌无数次，一直搜索</span>QT<span style="margin: 0px; padding: 0px; font-family: 宋体">相关的换肤文章，绝大部分的是一些简单的按钮文本样式，要做到整体换肤程度几乎不行，</span>QTCN<span style="margin: 0px; padding: 0px; font-family: 宋体">论坛里的奋斗的孩子写了个模仿</span>360<span style="margin: 0px; padding: 0px; font-family: 宋体">安全卫士系列，让我既惊喜有遗憾，惊喜的是能够用</span>QT<span style="margin: 0px; padding: 0px; font-family: 宋体">实现一个这么完整的</span>360<span style="margin: 0px; padding: 0px; font-family: 宋体">安全卫士界面，确实不错，也支持多种换肤，遗憾的是我下载过的是</span>VC<span style="margin: 0px; padding: 0px; font-family: 宋体">版本的，对于一直执着于用</span>Qt Creator&nbsp;<span style="margin: 0px; padding: 0px; font-family: 宋体">来开发的我来说，不大喜欢，工程文件之多之复杂，对于追求精简美的我来说更是觉得别扭，当然源码学习参考价值还是很高的，只是个人不大喜欢而已。陆续看过</span><a style="margin: 0px; padding: 0px; outline: none; color: black" href="http://my.csdn.net/slientman" target="_blank"><strong style="margin: 0px; padding: 0px"><span style="margin: 0px; padding: 0px; font-size: 9pt; text-decoration: none; font-family: Arial, sans-serif; color: #333333; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial">slientman</span></strong></a><span style="margin: 0px; padding: 0px; font-family: 宋体">的</span>QT<span style="margin: 0px; padding: 0px; font-family: 宋体">整体换肤方案，链接地址：</span><a style="margin: 0px; padding: 0px; outline: none; color: black" href="http://blog.csdn.net/slientman/article/details/5618950">http://blog.csdn.net/slientman/article/details/5618950</a><span style="margin: 0px; padding: 0px; font-family: 宋体">也从</span>CSDN<span style="margin: 0px; padding: 0px; font-family: 宋体">下过该可执行文件，也不知道是作者粗心还是故意，居然没有自带</span>QT<span style="margin: 0px; padding: 0px; font-family: 宋体">运行库，导致我电脑上试过几个版本的运行库都不行，作者也说了，花了很多精力，不打算开源，这个对于喜欢分享的我来说，心里又是一睹，不过本人还是带着诚意加过作者</span>QQ<span style="margin: 0px; padding: 0px; font-family: 宋体">，愿意自费购买一套，也一直没有得到作者的回复，有点失望。后面又在博客园里面看到</span><a style="margin: 0px; padding: 0px; outline: none; color: black" href="http://home.cnblogs.com/u/csuftzzk/"><span style="margin: 0px; padding: 0px; text-decoration: none; font-family: Verdana, sans-serif; background: #fafcfd">24K</span><span style="margin: 0px; padding: 0px; text-decoration: none; font-family: 宋体; background: #fafcfd">纯开源</span></a><span style="margin: 0px; padding: 0px; font-family: 宋体">（</span><a style="margin: 0px; padding: 0px; outline: none; color: black" href="http://www.cnblogs.com/csuftzzk/">http://www.cnblogs.com/csuftzzk/</a><span style="margin: 0px; padding: 0px; font-family: 宋体">）、文艺</span>IT<span style="margin: 0px; padding: 0px; font-family: 宋体">男（</span><a style="margin: 0px; padding: 0px; outline: none; color: black" href="http://www.cnblogs.com/appsucc/">http://www.cnblogs.com/appsucc/</a><span style="margin: 0px; padding: 0px; font-family: 宋体">）、</span>&nbsp;liulun<span style="margin: 0px; padding: 0px; font-family: 宋体">（</span><a style="margin: 0px; padding: 0px; outline: none; color: black" href="http://www.cnblogs.com/liulun/">http://www.cnblogs.com/liulun/</a><span style="margin: 0px; padding: 0px; font-family: 宋体">）等几位大侠写过的类似工具，尤其是这篇文章（</span><a style="margin: 0px; padding: 0px; outline: none; color: black" href="http://www.cnblogs.com/liulun/p/3775294.html">http://www.cnblogs.com/liulun/p/3775294.html</a><span style="margin: 0px; padding: 0px; font-family: 宋体">）让我认识到了还有</span>fontawesome<span style="margin: 0px; padding: 0px; font-family: 宋体">这个好东西，真心感谢作者！</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">在看过这么多习惯文章后，着手开始自己的</span>QUI<span style="margin: 0px; padding: 0px; font-family: 宋体">编写过程，一开始设想的是参照这篇文章</span><a style="margin: 0px; padding: 0px; outline: none; color: black" href="http://www.cnblogs.com/appsucc/p/3257661.html">http://www.cnblogs.com/appsucc/p/3257661.html</a><span style="margin: 0px; padding: 0px; font-family: 宋体">来进行开发，封装成一个</span>DLL<span style="margin: 0px; padding: 0px; font-family: 宋体">，提供外部接口给需要加上皮肤的窗体调用，当开发完成之后，才发现还是会有一系列的问题，例如当主窗体需要关闭时，需调用</span>this.parent().close()<span style="margin: 0px; padding: 0px; font-family: 宋体">类似方法才可以关闭窗体，而且必须是</span>QWidget<span style="margin: 0px; padding: 0px; font-family: 宋体">才能加入到子窗体中，当有相关</span>QDialog<span style="margin: 0px; padding: 0px; font-family: 宋体">窗体打开需要给出返回值时，不能方便的提供</span>done<span style="margin: 0px; padding: 0px; font-family: 宋体">（</span>1<span style="margin: 0px; padding: 0px; font-family: 宋体">）这样的方法返回，后面索性抛弃了这种做法，还是采用</span>QSS<span style="margin: 0px; padding: 0px; font-family: 宋体">样式调用，相关样式都已经在样式表中写好，无非就五种颜色，采用了上下两种渐变颜色，</span>normal<span style="margin: 0px; padding: 0px; font-family: 宋体">两种</span>,hover(select,focus<span style="margin: 0px; padding: 0px; font-family: 宋体">等</span>)<span style="margin: 0px; padding: 0px; font-family: 宋体">两种，还有一个是文字颜色，只要将对应样式表替换这五种颜色即可，当然大部分时候替换的是四种颜色，文字颜色默认为白色，通用绝大部分渐变颜色。</span><span style="margin: 0px; padding: 0px; line-height: 1.5">&nbsp;</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">核心处理部分：</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">1<span style="margin: 0px; padding: 0px; font-family: 宋体">：无边框窗体处理</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">对标题栏安装</span>eventFilter<span style="margin: 0px; padding: 0px; font-family: 宋体">事件监听器监听鼠标双击事件，重载</span>mouseMoveEvent<span style="margin: 0px; padding: 0px; font-family: 宋体">、</span>mousePressEvent<span style="margin: 0px; padding: 0px; font-family: 宋体">、</span>mouseReleaseEvent<span style="margin: 0px; padding: 0px; font-family: 宋体">三个事件实现鼠标拖动，当窗体改变大小后还必须用</span>QRect location;<span style="margin: 0px; padding: 0px; font-family: 宋体">来记住当前窗体位置，方便按下右上角还原按钮时将窗体设置在最大化前的位置。</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">部分代码如下：</span></p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid #cccccc; overflow: auto; font-family: 'Courier New' !important; background-color: #f5f5f5"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px"><span style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important" class="cnblogs_code_copy"><a style="margin: 0px; padding: 0px; text-decoration: underline; outline: none; border: none !important" title="复制代码"><img style="margin: 0px; padding: 0px; border: none !important" src="http://common.cnblogs.com/images/copycode.gif" border="0" alt="复制代码" /></a></span></div><div style="margin: 0px; padding: 0px"><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;1</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">bool</span>&nbsp;frmMain::eventFilter(QObject&nbsp;*obj,&nbsp;QEvent&nbsp;*<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">event</span>)<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;2</span>&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">if</span>&nbsp;(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">event</span>-&gt;type()&nbsp;==&nbsp;QEvent::MouseButtonDblClick)&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">this</span>-&gt;on_btnMenu_Max_clicked();<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">return</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">true</span>;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">return</span>&nbsp;QObject::eventFilter(obj,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">event</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;8</span>&nbsp;&#125;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;9</span>&nbsp;&nbsp;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">10</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">void</span>&nbsp;frmMain::mouseMoveEvent(QMouseEvent&nbsp;*e)<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">11</span>&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">12</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">if</span>&nbsp;(mousePressed&nbsp;&amp;&amp;&nbsp;(e-&gt;buttons()&nbsp;&amp;&amp;&nbsp;Qt::LeftButton)&nbsp;&amp;&amp;&nbsp;!max)&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">13</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">this</span>-&gt;move(e-&gt;globalPos()&nbsp;-&nbsp;mousePoint);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e-&gt;accept();<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">16</span>&nbsp;&#125;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">17</span>&nbsp;&nbsp;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">18</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">void</span>&nbsp;frmMain::mousePressEvent(QMouseEvent&nbsp;*e)<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">19</span>&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">if</span>&nbsp;(e-&gt;button()&nbsp;==&nbsp;Qt::LeftButton)&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">21</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mousePressed&nbsp;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">true</span>;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">22</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mousePoint&nbsp;=&nbsp;e-&gt;globalPos()&nbsp;-&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">this</span>-&gt;pos();<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">23</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e-&gt;accept();<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">24</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">25</span>&nbsp;&#125;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">26</span>&nbsp;&nbsp;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">27</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">void</span>&nbsp;frmMain::mouseReleaseEvent(QMouseEvent&nbsp;*)<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">28</span>&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">29</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mousePressed&nbsp;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">false</span>;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">30</span>&nbsp;&#125;</div><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px"><span style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important" class="cnblogs_code_copy"><a style="margin: 0px; padding: 0px; text-decoration: underline; outline: none; border: none !important" title="复制代码"><img style="margin: 0px; padding: 0px; border: none !important" src="http://common.cnblogs.com/images/copycode.gif" border="0" alt="复制代码" /></a></span></div></div><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">&nbsp;</p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">2<span style="margin: 0px; padding: 0px; font-family: 宋体">：图形字体的使用</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">这里直接用的是网上的</span>IconHelper<span style="margin: 0px; padding: 0px; font-family: 宋体">类，也不知道最初作者是谁，反正代码也就几行，不难。</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">贴出</span>CPP<span style="margin: 0px; padding: 0px; font-family: 宋体">实现文件代码</span></p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid #cccccc; overflow: auto; font-family: 'Courier New' !important; background-color: #f5f5f5"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px"><span style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important" class="cnblogs_code_copy"><a style="margin: 0px; padding: 0px; text-decoration: underline; outline: none; border: none !important" title="复制代码"><img style="margin: 0px; padding: 0px; border: none !important" src="http://common.cnblogs.com/images/copycode.gif" border="0" alt="复制代码" /></a></span></div><div style="margin: 0px; padding: 0px"><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;1</span>&nbsp;#include&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">iconhelper.h</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;2</span>&nbsp;&nbsp;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;3</span>&nbsp;IconHelper*&nbsp;IconHelper::_instance&nbsp;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800080">0</span>;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;4</span>&nbsp;IconHelper::IconHelper(QObject*):<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QObject(qApp)<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;6</span>&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">int</span>&nbsp;fontId&nbsp;=&nbsp;QFontDatabase::addApplicationFont(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">:/image/fontawesome-webfont.ttf</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QString&nbsp;fontName&nbsp;=&nbsp;QFontDatabase::applicationFontFamilies(fontId).at(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800080">0</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iconFont&nbsp;=&nbsp;QFont(fontName);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">10</span>&nbsp;&#125;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">11</span>&nbsp;&nbsp;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">12</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">void</span>&nbsp;IconHelper::SetIcon(QLabel*&nbsp;lab,&nbsp;QChar&nbsp;c,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">int</span>&nbsp;size)<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">13</span>&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iconFont.setPointSize(size);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lab-&gt;setFont(iconFont);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lab-&gt;setText(c);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">17</span>&nbsp;&#125;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">18</span>&nbsp;&nbsp;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">19</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">void</span>&nbsp;IconHelper::SetIcon(QPushButton*&nbsp;btn,&nbsp;QChar&nbsp;c,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">int</span>&nbsp;size)<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">20</span>&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">21</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iconFont.setPointSize(size);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">22</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btn-&gt;setFont(iconFont);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">23</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btn-&gt;setText(c);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">24</span>&nbsp;&#125;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">25</span>&nbsp;&nbsp;</div><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px"><span style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important" class="cnblogs_code_copy"><a style="margin: 0px; padding: 0px; text-decoration: underline; outline: none; border: none !important" title="复制代码"><img style="margin: 0px; padding: 0px; border: none !important" src="http://common.cnblogs.com/images/copycode.gif" border="0" alt="复制代码" /></a></span></div></div><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">在主窗体的构造函数中这样调用即可。</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">IconHelper::Instance()-&gt;SetIcon(ui-&gt;btnMenu_Close, QChar(0xf00d), 10);</p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">右上角最大化按钮会有两个图标，最大化时候一个，还原时候一个，所以这里在事件中这样处理的。</span></p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid #cccccc; overflow: auto; font-family: 'Courier New' !important; background-color: #f5f5f5"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px"><span style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important" class="cnblogs_code_copy"><a style="margin: 0px; padding: 0px; text-decoration: underline; outline: none; border: none !important" title="复制代码"><img style="margin: 0px; padding: 0px; border: none !important" src="http://common.cnblogs.com/images/copycode.gif" border="0" alt="复制代码" /></a></span></div><div style="margin: 0px; padding: 0px"><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;1</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">void</span>&nbsp;frmMain::on_btnMenu_Max_clicked()<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;2</span>&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">if</span>&nbsp;(max)&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">this</span>-&gt;setGeometry(location);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IconHelper::Instance()-&gt;SetIcon(ui-&gt;btnMenu_Max,&nbsp;QChar(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800080">0xf096</span>),&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800080">10</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;btnMenu_Max-&gt;setToolTip(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">最大化</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">else</span>&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;=&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">this</span>-&gt;geometry();<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">this</span>-&gt;setGeometry(qApp-&gt;desktop()-&gt;availableGeometry());<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IconHelper::Instance()-&gt;SetIcon(ui-&gt;btnMenu_Max,&nbsp;QChar(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800080">0xf079</span>),&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800080">10</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">11</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;btnMenu_Max-&gt;setToolTip(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">还原</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">12</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">13</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;=&nbsp;!max;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">14</span>&nbsp;&#125;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">15</span>&nbsp;&nbsp;</div><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px"><span style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important" class="cnblogs_code_copy"><a style="margin: 0px; padding: 0px; text-decoration: underline; outline: none; border: none !important" title="复制代码"><img style="margin: 0px; padding: 0px; border: none !important" src="http://common.cnblogs.com/images/copycode.gif" border="0" alt="复制代码" /></a></span></div></div><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">3<span style="margin: 0px; padding: 0px; font-family: 宋体">：自定义弹出信息框、询问框、错误框</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">我比较偷懒，直接用新建的</span>UI<span style="margin: 0px; padding: 0px; font-family: 宋体">窗体来实现，对信息框、询问框、错误框的判断直接在</span>setmessage<span style="margin: 0px; padding: 0px; font-family: 宋体">函数中处理。</span></p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid #cccccc; overflow: auto; font-family: 'Courier New' !important; background-color: #f5f5f5"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px"><span style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important" class="cnblogs_code_copy"><a style="margin: 0px; padding: 0px; text-decoration: underline; outline: none; border: none !important" title="复制代码"><img style="margin: 0px; padding: 0px; border: none !important" src="http://common.cnblogs.com/images/copycode.gif" border="0" alt="复制代码" /></a></span></div><div style="margin: 0px; padding: 0px"><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;1</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">void</span>&nbsp;frmMessageBox::SetMessage(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">const</span>&nbsp;QString&nbsp;&amp;msg,&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">int</span>&nbsp;type)<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;2</span>&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">if</span>&nbsp;(type&nbsp;==&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800080">0</span>)&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;labIcoMain-&gt;setStyleSheet(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">border-image:&nbsp;url(:/image/info.png);</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;btnCancel-&gt;setVisible(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">false</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;lab_Title-&gt;setText(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">提示</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">else</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">if</span>&nbsp;(type&nbsp;==&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800080">1</span>)&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;labIcoMain-&gt;setStyleSheet(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">border-image:&nbsp;url(:/image/question.png);</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">&nbsp;9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;lab_Title-&gt;setText(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">询问</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">else</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">if</span>&nbsp;(type&nbsp;==&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800080">2</span>)&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">11</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;labIcoMain-&gt;setStyleSheet(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">border-image:&nbsp;url(:/image/error.png);</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">12</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;btnCancel-&gt;setVisible(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">false</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">13</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;lab_Title-&gt;setText(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">错误</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span>);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">15</span>&nbsp;&nbsp;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;labInfo-&gt;setText(msg);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">17</span>&nbsp;&#125;</div><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px"><span style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important" class="cnblogs_code_copy"><a style="margin: 0px; padding: 0px; text-decoration: underline; outline: none; border: none !important" title="复制代码"><img style="margin: 0px; padding: 0px; border: none !important" src="http://common.cnblogs.com/images/copycode.gif" border="0" alt="复制代码" /></a></span></div></div><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">&nbsp;</p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">4<span style="margin: 0px; padding: 0px; font-family: 宋体">：设置全局皮肤样式</span></p><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid #cccccc; overflow: auto; font-family: 'Courier New' !important; background-color: #f5f5f5"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px"><span style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important" class="cnblogs_code_copy"><a style="margin: 0px; padding: 0px; text-decoration: underline; outline: none; border: none !important" title="复制代码"><img style="margin: 0px; padding: 0px; border: none !important" src="http://common.cnblogs.com/images/copycode.gif" border="0" alt="复制代码" /></a></span></div><div style="margin: 0px; padding: 0px"><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">1</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008000">//</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008000">设置皮肤样式</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008000"><br /></span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">static</span>&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">void</span>&nbsp;SetStyle(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #0000ff">const</span>&nbsp;QString&nbsp;&amp;styleName)<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#123;<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QFile&nbsp;file(QString(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">:/image/%1.css</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span>).arg(styleName));<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file.open(QFile::ReadOnly);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QString&nbsp;qss&nbsp;=&nbsp;QLatin1String(file.readAll());<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qApp-&gt;setStyleSheet(qss);<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qApp-&gt;setPalette(QPalette(QColor(<span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">#F0F0F0</span><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #800000">&quot;</span>)));<br /><span style="margin: 0px; padding: 0px; line-height: 1.5 !important; color: #008080">9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#125;</div><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px"><span style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5 !important" class="cnblogs_code_copy"><a style="margin: 0px; padding: 0px; text-decoration: underline; outline: none; border: none !important" title="复制代码"><img style="margin: 0px; padding: 0px; border: none !important" src="http://common.cnblogs.com/images/copycode.gif" border="0" alt="复制代码" /></a></span></div></div><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">&nbsp;<span style="margin: 0px; padding: 0px; line-height: 1.5">&nbsp;</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">myHelper::SetStyle(&quot;black&quot;);//<span style="margin: 0px; padding: 0px; font-family: 宋体">黑色风格</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px" align="left"><span style="margin: 0px; padding: 0px; line-height: 1.5">&nbsp;</span><img style="margin: 0px; padding: 0px; border: 0px; line-height: 1.5" src="http://images.cnitblog.com/blog/63094/201408/152043198581515.jpg" border="0" /></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px" align="left">myHelper::SetStyle(&quot;blue&quot;);//<span style="margin: 0px; padding: 0px; font-family: 宋体">蓝色风格</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><img style="margin: 0px; padding: 0px; border: 0px" src="http://images.cnitblog.com/blog/63094/201408/152043312486695.jpg" border="0" /></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">myHelper::SetStyle(&quot;gray&quot;);//<span style="margin: 0px; padding: 0px; font-family: 宋体">灰色风格</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><img style="margin: 0px; padding: 0px; border: 0px" src="http://images.cnitblog.com/blog/63094/201408/152043420773602.jpg" border="0" /></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">myHelper::SetStyle(&quot;navy&quot;);//<span style="margin: 0px; padding: 0px; font-family: 宋体">天蓝色风格</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><img style="margin: 0px; padding: 0px; border: 0px" src="http://images.cnitblog.com/blog/63094/201408/152043513278694.jpg" border="0" /></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">特点：</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">1<span style="margin: 0px; padding: 0px; font-family: 宋体">：无边框窗体，自定义标题栏，鼠标拖动，大小缩放，双击切换。</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">2<span style="margin: 0px; padding: 0px; font-family: 宋体">：除了少量的几个图片资源外，几乎使用</span>QSS<span style="margin: 0px; padding: 0px; font-family: 宋体">写完所有颜色样式控制。</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">3<span style="margin: 0px; padding: 0px; font-family: 宋体">：自定义一个</span>QMessageBox<span style="margin: 0px; padding: 0px; font-family: 宋体">对话框，自动换行显示提示信息，可以很方便的调用。</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">信息框：</span>myHelper::ShowMessageBoxInfo</p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><img style="margin: 0px; padding: 0px; border: 0px" src="http://images.cnitblog.com/blog/63094/201408/152044045146691.jpg" border="0" /></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">询问框：</span>myHelper::ShowMessageBoxQuesion</p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><img style="margin: 0px; padding: 0px; border: 0px" src="http://images.cnitblog.com/blog/63094/201408/152044126233569.jpg" border="0" /></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">错误框：</span>myHelper::ShowMessageBoxError</p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><img style="margin: 0px; padding: 0px; border: 0px" src="http://images.cnitblog.com/blog/63094/201408/152044207026502.jpg" border="0" /></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">4<span style="margin: 0px; padding: 0px; font-family: 宋体">：使用</span>fontawesome<span style="margin: 0px; padding: 0px; font-family: 宋体">图形字体库，将互联网的优秀资源应用于</span>QT<span style="margin: 0px; padding: 0px; font-family: 宋体">中。</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">5<span style="margin: 0px; padding: 0px; font-family: 宋体">：彻底公开源码，可以任意随意使用。</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">6<span style="margin: 0px; padding: 0px; font-family: 宋体">：</span>QT<span style="margin: 0px; padding: 0px; font-family: 宋体">各个版本都可以编译通过，亲测无误。</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">7<span style="margin: 0px; padding: 0px; font-family: 宋体">：自带提供了四种样式黑色、蓝色、灰色、天蓝色风格供选择，可以自由更改</span>image<span style="margin: 0px; padding: 0px; font-family: 宋体">文件夹下的样式，也可以自己增加一些样式。</span><span style="margin: 0px; padding: 0px; line-height: 1.5">&nbsp;</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px"><span style="margin: 0px; padding: 0px; font-family: 宋体">代码肯定还有很多不完善的地方，不能通用于任何项目，肯定需要修改不少代码才可以用于自己的项目，如果有更好的建议，非常欢迎提出来！</span><span style="margin: 0px; padding: 0px; line-height: 1.5">&nbsp;</span></p><p style="margin: 10px auto; padding: 0px; font-size: 14px; line-height: 21px">CSDN<span style="margin: 0px; padding: 0px; font-family: 宋体">下载地址：</span><a style="margin: 0px; padding: 0px; outline: none; color: black" href="http://download.csdn.net/detail/feiyangqingyun/7763413">http://download.csdn.net/detail/feiyangqingyun/7763413</a></p>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5983</link>
<title><![CDATA[Qt版权介绍：GPL, LGPL 以及 Commercial 授权]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[QT]]></category>
<pubDate>Sat, 07 Jun 2014 02:26:46 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5983</guid> 
<description>
<![CDATA[ 
	<div class="tit" style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;Qt GPL, LGPL &amp; Commercial License</div><table border="0" style="border-collapse: collapse; border-spacing: 0px; color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><tbody><tr><td><div id="blog_text" class="cnt"><p>From:</p><p>http://www.qteverywhere.com/</p><p>&nbsp;</p><p>Qt 4.5中提供了三种授权协议，分别是GPL, LGPL和Commercial，可能很多人要问，为什么同样的一个产品要提供三种授权协议，什么情况下使用什么的样的授权协议最合适？在这里我就大致解释一下：</p><p>&nbsp;</p><p>GPL全称是The GNU General Public License，是目前大多数的GNU程序和超过半数的自由软件使用的许可协议。GPL的出发点是代码的开源/免费使用和引用/修改/衍生代码的开源/免 费使用，但不允许修改后和衍生的代码做为闭源的商业软件发布和销售。<br />GPL协议的主要内容是只要在一个软件中使用(&rdquo;使用&rdquo;指类库引用，修改后的代码或者衍生代码)GPL 协议的产品，则该软件产品必须也采用GPL协议，既必须也是开源和免费。这就是所谓的&rdquo;传染性&rdquo;。GPL协议的产品作为一个单独的产品使用没有任何问题， 还可以享受免费的优势。</p><p>&nbsp;</p><p>回到LGPL，LGPL的全称是 GNU Lesser General Public License，GNU 较宽松公共许可证，也是由协议是由自由软体基金会发布的许可证，是一个主要为类库使用设计的开源协议，和GPL要求任何使用/修改/衍生之GPL类库的的 软件必须采用GPL协议不同。LGPL允许商业软件通过类库引用(link)方式使用LGPL类库而不需要开源商业软件的代码。这使得采用LGPL协议的 开源代码可以被商业软件作为类库引用并发布和销售。</p><p>&nbsp;</p><p>除了GPL和LGPL两种开源协议之外，Qt还提供了Commercial商业协议，Qt的商业协议是由Nokia定义的，由Nokia和购买方签 订的，具有法律效应的Qt产品授权协议。 Commercial License相教与GPL和LGPL，对于商业客户提供了更多的灵活性，客户可以任意的修改Qt的源代码，开发商业软件，而不需要公开任何源代码。并 且，在Commercial License中，我们还提供了技术支持服务。当然，商业授权协议是需要费用的。</p><p>到底什么时候需要选择GPL和LGPL呢？一个最显而易见的理由就是他们都是免费的，使用LGPL和GPL版本的Qt是不需要支付任何费用的，当然 我们也相应的不会提供技术支持。如果你打算开发真正的开源软件，并希望使用者也可以保持开源，那么GPL是更好的选择，因为所有人，不论你自己还是将来基 于你的代码进行再次开发都必须开源。如果你打算开发闭源（不开放源代码）的商业软件，那么LGPL则更适合，但必须满足下面两个条件：<br />1. 你的应用程序应该动态链接Qt函数库，并使你的应用程序与未做修改的LGPL库分开发布。同时必须确保使用者（接受者）知道应用程序使用了LGPL版本的Qt；<br />2. 如果你对LGPL版本的Qt进行了任何修改，并发布，则必须遵循LGPL 条款发布。任何使用者有权利得到这些修改（通常情况下是源代码），并且确保使用者可以通过这些修改自己生成相应你修改过的Qt版本。</p><p>相信到这里大家已经对Qt提供的这三种协议有了基本的了解，通常大家还会有一个疑问，就是基于这三种授权协议的Qt产品到底由多少功能上的区别，是 不是商业版本的会更完整，性能更好一些？这里我可以负责任的说：99%的代码都是一样的，无论是GPL, LGPL还是Commercial，功能，性能都没有区别，唯一的区别就在于授权协议的不同。</p><p>还有一点需要说明的就是，由于LGPL是在Qt4.5这个版本里面才引入的，所以之前的Qt版本，4.4或者3.x的版本，并不提供LGPL协议，是不可逆的。同时未来发布的Qt版本，就一直会提供三种不同的授权协议版本。</p><p>&nbsp;</p><p>下面有一些链接，有兴趣想深入了解这些授权协议的同学，可以学习学习</p><p>GPL协议原文 －&nbsp;<a style="text-decoration: none; outline: none; color: #336699" href="http://www.gnu.org/copyleft/gpl.html" target="_blank">http://www.gnu.org/copyleft/gpl.html</a><br />GPL协议中文译文 －&nbsp;<a style="text-decoration: none; outline: none; color: #336699" href="http://bergwolf.googlepages.com/gplv3_zh" target="_blank">http://bergwolf.googlepages.com/gplv3_zh</a><br />LGPL协议原文 -&nbsp;<a style="text-decoration: none; outline: none; color: #336699" href="http://www.gnu.org/copyleft/lesser.html" target="_blank">http://www.gnu.org/copyleft/lesser.html</a><br />LGPL协议中文译文 －&nbsp;<a style="text-decoration: none; outline: none; color: #336699" href="http://www.thebigfly.com/gnu/lgpl/lgpl-v3.php" target="_blank">http://www.thebigfly.com/gnu/lgpl/lgpl-v3.php</a><br />58种不同的开源协议 －&nbsp;<a style="text-decoration: none; outline: none; color: #336699" href="http://www.fsf.org/licensing/licenses/" target="_blank">http://www.fsf.org/licensing/licenses/</a><br />什么是动态链接 －&nbsp;<a style="text-decoration: none; outline: none; color: #336699" href="http://zh.wikipedia.org/wiki/%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93" target="_blank">http://zh.wikipedia.org/wiki/%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93</a><br />官方声明 －&nbsp;<a style="text-decoration: none; outline: none; color: #336699" href="http://www.qtsoftware.com/about/news/lgpl-license-option-added-to-qt" target="_blank">http://www.qtsoftware.com/about/news/lgpl-license-option-added-to-qt</a><br />官方Q&amp;A －&nbsp;<a style="text-decoration: none; outline: none; color: #336699" href="http://www.qtsoftware.com/about/licensing/frequently-asked-questions" target="_blank">http://www.qtsoftware.com/about/licensing/frequently-asked-questions</a></p></div></td></tr></tbody></table>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5746</link>
<title><![CDATA[Qt和Ogre的自由結合]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[QT]]></category>
<pubDate>Thu, 05 Dec 2013 06:36:58 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5746</guid> 
<description>
<![CDATA[ 
	<p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">Qt和Ogre的結合這個問題在以前做畢設的時候就已經處理過，但是並不是很完美的解決掉.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">比如說：Ogre的渲染窗口無法固定大小，會隨著MainWindow的變化而變化.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">今天就來解決這個問題.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">如果我們有以下的需求:</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">1.Ogre的渲染窗口必須固定大小，不能隨著MainWindow的變化而變化.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">2.當MainWindow的大小變得很小的時候，Ogre的渲染窗口外部有滾動條可以拖動來看到全部的Ogre視野.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">這兩個需求可以在Scene Editor裡面並不會用到，因為Viewport的大小並不是那麼重要，所以Ogitor和其他一些常見的Qt Ogre Scene Editor也沒有解決這個問題.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">但是在一些特殊的Editor，她可能就有這個需要.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">我們先回顧一下Ogre怎麼放到Qt中.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">一個class,我們命名為OgreWidget，繼承與QWidget類.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">一些初始化Ogre的內容在這裡跳過.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">我們來看關鍵的地方:</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">1.在創建Ogre的RenderWindow的時候要指定參數:</p><div id="highlighter_808700" class="syntaxhighlighter&nbsp;&nbsp;" style="color: #666666; font-family: Arial, Helvetica, sans-serif"><div class="bar"><div class="toolbar"><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#viewSource" title="view source" class="item viewSource">view source</a><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#printSource" title="print" class="item printSource">print</a><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#about" title="?" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">1</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">Ogre::NameValuePairList params;</td></tr></tbody></table></div><div class="line alt2"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">2</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">params[&quot;externalWindowHandle&quot;] = Ogre::StringConverter::toString((size_t)(HWND)winId());</td></tr></tbody></table></div><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">3</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">pRenderWindow = mRoot-&gt;createRenderWindow(&quot;Ogre&quot;, width(), height(),&nbsp;false, &amp;params);</td></tr></tbody></table></div></div></div><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif"></p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">注意，參數為掛載Ogre這個渲染內容的QWidget句柄，也就是說，傳入哪個QWidget的句柄，Ogre就渲染到哪個地方.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">2.嵌入Qt的MainWindow:</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">要嵌入到MainWindow，只需要添加一個Layout，然後在MainWindow裡面set這個Layout即可.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">而Ogitor是放到了一個QDockWidget裡面，類似於這樣:</p><div id="highlighter_487114" class="syntaxhighlighter&nbsp;&nbsp;" style="color: #666666; font-family: Arial, Helvetica, sans-serif"><div class="bar "><div class="toolbar"><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#viewSource" title="view source" class="item viewSource">view source</a><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#printSource" title="print" class="item printSource">print</a><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#about" title="?" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">1</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">QDockWidget *pDock =&nbsp;new&nbsp;QDockWidget(QObject::tr(XX));</td></tr></tbody></table></div><div class="line alt2"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">2</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">3</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">OgreWidget *pOgreWidget =&nbsp;new&nbsp;OgreWidget(pDock);&nbsp;&nbsp;//!&lt; 此處傳入的是父Widget的指針，一定要.</td></tr></tbody></table></div><div class="line alt2"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">4</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">5</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">pDock-&gt;setWidget(pOgreWidget);</td></tr></tbody></table></div></div></div><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">然後在MainWindow裡面add這個QDockWidget即可.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">但是這樣的Ogre渲染區域是隨著外部的變化而變化的.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">我們現在來看看之前提出的需求：</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">如果你直接這樣做:</p><div id="highlighter_381426" class="syntaxhighlighter&nbsp;&nbsp;" style="color: #666666; font-family: Arial, Helvetica, sans-serif"><div class="bar&nbsp;&nbsp; "><div class="toolbar"><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#viewSource" title="view source" class="item viewSource">view source</a><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#printSource" title="print" class="item printSource">print</a><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#about" title="?" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">1</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">QScrollArea *pScroll =&nbsp;new&nbsp;pScroll;</td></tr></tbody></table></div><div class="line alt2"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">2</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">3</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">OgreWidget *pOgreWidget =&nbsp;new&nbsp;OgreWidget(pScroll );</td></tr></tbody></table></div><div class="line alt2"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">4</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">5</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">pScroll-&gt;setWidget(pOgreWidget );</td></tr></tbody></table></div></div></div><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">你會發現有問題，Ogre已經不再渲染到Qt了，滾動條可以看見並且可用狀態，但是Ogre沒了.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">如果你這樣做：</p><div id="highlighter_809216" class="syntaxhighlighter&nbsp;&nbsp;" style="color: #666666; font-family: Arial, Helvetica, sans-serif"><div class="bar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "><div class="toolbar"><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#viewSource" title="view source" class="item viewSource">view source</a><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#printSource" title="print" class="item printSource">print</a><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#about" title="?" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">1</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">QScrollArea *pScroll =&nbsp;new&nbsp;pScroll;</td></tr></tbody></table></div><div class="line alt2"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">2</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">3</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">OgreWidget *pOgreWidget =&nbsp;new&nbsp;OgreWidget(pScroll );</td></tr></tbody></table></div></div></div><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">你可以看到Ogre已經渲染到了QScrollArea的區域裡面，但是QScrollArea卻不能正常工作了，滾動條消失了，即使通過</p><div id="highlighter_454946" class="syntaxhighlighter&nbsp;&nbsp;" style="color: #666666; font-family: Arial, Helvetica, sans-serif"><div class="bar&nbsp;&nbsp;"><div class="toolbar"><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#viewSource" title="view source" class="item viewSource">view source</a><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#printSource" title="print" class="item printSource">print</a><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#about" title="?" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">1</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">setVerticalScrollBarPolicy(Qt::ScrollBarAlwaysOn)</td></tr></tbody></table></div></div></div><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">這樣的方法強制打開滾動條，發現滾動條雖然可以看見了，但是不可用灰色狀態.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">那麼該怎麼辦呢？這個問題困擾了幾十分鐘之後，終於想到了方法。我們僅僅只需要一個QWidget來過度即可.</p><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">像這樣：</p><div id="highlighter_969408" class="syntaxhighlighter&nbsp;&nbsp;" style="color: #666666; font-family: Arial, Helvetica, sans-serif"><div class="bar&nbsp;&nbsp;&nbsp;&nbsp; show"><div class="toolbar"><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#viewSource" title="view source" class="item viewSource">view source</a><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#printSource" title="print" class="item printSource">print</a><a style="outline: none; color: #00a19e; width: 16px; height: 16px" href="http://www.ispinel.com/2011/08/05/1932/#about" title="?" class="item about">?</a></div></div><div class="lines"><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">1</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">QWidget *pRenderWidget =&nbsp;new&nbsp;QWidget;</td></tr></tbody></table></div><div class="line alt2"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">2</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">3</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">OgreWidget *pOgreWidget =&nbsp;new&nbsp;OgreWidget(pRenderWidget );</td></tr></tbody></table></div><div class="line alt2"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">4</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">5</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">QScrollArea *pScroll =&nbsp;new&nbsp;pScroll;</td></tr></tbody></table></div><div class="line alt2"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">6</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table border="0" style="margin: 0px 0px 1em; padding: 0px; border-collapse: collapse; width: 723px; border: 0px"><tbody><tr><td class="number" style="border: 1px solid #cccccc; padding: 15px">7</td><td class="content" style="border: 1px solid #cccccc; padding: 15px">pScroll-&gt;setWidget(pRenderWidget );</td></tr></tbody></table></div></div></div><p style="margin: 0px 0px 1em; padding: 0px; line-height: 30px; color: #666666; font-family: Arial, Helvetica, sans-serif">然後我們再設定一下OgreWidget的固定大小值，然後就解決了文章提出的兩個需求.</p>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5745</link>
<title><![CDATA[将ogre 嵌入到 Qt中]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[QT]]></category>
<pubDate>Thu, 05 Dec 2013 06:36:41 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5745</guid> 
<description>
<![CDATA[ 
	<p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">我用的环境是VS2008+Qt</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">1，新建一个Qt Application，除了main.cpp文件以外，将其它东西全部删除。</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">2，添加几个文件如下：</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">FOgreWidget.h：</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">#include &lt;QWidget&gt;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />// 如果为假就返回<br />#ifndef FALSE_RETURN<br />#define FALSE_RETURN(h, r) if(!h) return r;<br />#endif</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">#ifndef _DEGUG<br />#define _DEGUG<br />#endif</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">#include &lt;QEvent&gt;<br />#include &quot;Ogre.h&quot;<br />#include &quot;OgreConfigFile.h&quot;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />class FOgreWidget : public QWidget<br />&#123;<br />&nbsp;Q_OBJECT<br />public:<br />&nbsp;FOgreWidget(QWidget* parent ,QString strInsName);<br />&nbsp;~FOgreWidget();</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;//QSize minimumSizeHint() const;<br />&nbsp;//QSize sizeHint() const;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">protected:</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&nbsp;// 事件处理函数</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;void resizeEvent(QResizeEvent* evt);//窗口可能缩放</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&nbsp;void timerEvent(QTimerEvent* evt);//可以设一时钟来更新窗口</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&nbsp;void paintEvent(QPaintEvent* evt);//呵，当然得处理了</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&nbsp;void keyPressEvent(QKeyEvent* evt);<br />&nbsp;//void keyReleaseEvent(QKeyEvent* evt);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&nbsp;void mousePressEvent(QMouseEvent* evt) ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&nbsp;//void mouseReleaseEvent(QMouseEvent* evt);<br />&nbsp;//void mouseMoveEvent(QMouseEvent* evt);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&nbsp;void wheelEvent(QWheelEvent* evt);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&nbsp;bool LoadPlugin() ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;bool LoadResource() ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;bool CreateSceneManager() ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;bool CreateRenderWindow() ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;bool CreateDefaultCamera() ;<br />&nbsp;bool SelectRenderSystem() ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;bool CreateScene()&nbsp; ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&nbsp;void updateDraw() ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;void CreateLight() ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;Ogre::SceneManager* m_pSceneManager ;<br />&nbsp;Ogre::RenderWindow* m_pRenderWindow;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;Ogre::Camera* m_pDefCamera;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;Ogre::Viewport* m_pDefViewport;&nbsp;&nbsp;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;Ogre::Root* m_pRoot ;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;Ogre::Entity *&nbsp; m_pMainEnt;&nbsp;&nbsp;&nbsp;<br />&nbsp;Ogre::SceneNode*&nbsp;&nbsp; m_pMainNode;&nbsp;&nbsp;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;Ogre::Light* m_pMainLight;&nbsp;&nbsp;&nbsp;&nbsp;<br />public :<br />&nbsp;bool Initialize() ;<br />private:<br />&nbsp;QString&nbsp; m_strInsName_ ;<br />&#125;;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">FOgreWidget.cpp：</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">#include &quot;FOgreWidget.h&quot;<br />#include &lt;QKeyEvent&gt;<br />#include &lt;string&gt;<br />using namespace std ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">FOgreWidget::FOgreWidget(QWidget* parent,QString strInsName) : QWidget(parent,Qt::WFlags(Qt::MSWindowsOwnDC)),m_strInsName_(strInsName)<br />&#123;<br />&nbsp;m_pSceneManager = NULL ;<br />&nbsp;m_pRenderWindow= NULL ;<br />&nbsp;m_pDefCamera= NULL ;<br />&nbsp;m_pDefViewport= NULL ;<br />&nbsp;m_pRoot = NULL ;<br />&nbsp;m_pMainEnt= NULL ;<br />&nbsp;m_pMainNode= NULL ;<br />&nbsp;m_pMainLight = NULL ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />FOgreWidget::~FOgreWidget()<br />&#123;<br />&nbsp;// destroy Viewport and RenderWindow<br />&nbsp;if( m_pDefViewport )<br />&nbsp;&#123;<br />&nbsp;&nbsp;m_pRenderWindow-&gt;removeViewport(m_pDefViewport-&gt;getZOrder());<br />&nbsp;&nbsp;m_pDefViewport = NULL ;<br />&nbsp;&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;Ogre::Root::getSingleton().detachRenderTarget(m_pRenderWindow);<br />&nbsp;m_pRenderWindow = NULL ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />void FOgreWidget::paintEvent(QPaintEvent *evt)<br />&#123;<br />&nbsp;Q_UNUSED(evt);&nbsp;&nbsp;&nbsp;<br />&nbsp;updateDraw() ;<br />&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">void FOgreWidget::timerEvent(QTimerEvent* evt)<br />&#123;<br />&nbsp;Q_UNUSED(evt);<br />&nbsp;updateDraw() ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">void FOgreWidget::resizeEvent(QResizeEvent *evt)<br />&#123;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;QWidget::resizeEvent(evt) ;<br />&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">void FOgreWidget::keyPressEvent(QKeyEvent* evt)<br />&#123;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&nbsp;QWidget::keyPressEvent(evt) ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />void FOgreWidget::mousePressEvent(QMouseEvent* evt)<br />&#123;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;QWidget::mousePressEvent(evt) ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />void FOgreWidget::wheelEvent(QWheelEvent* evt)<br />&#123;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;QWidget::wheelEvent(evt) ;<br />&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />bool FOgreWidget::LoadPlugin()<br />&#123;&nbsp;&nbsp;&nbsp;<br />&nbsp;assert(m_pRoot!=NULL) ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">#if defined(_DEGUG) &#124;&#124; defined(DEBUG)<br />&nbsp;// Load D3D9 Render System(debug)<br />&nbsp;m_pRoot-&gt;loadPlugin(&quot;RenderSystem_Direct3D9_d&quot;);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;// Load OpenGL Render System(debug)<br />&nbsp;m_pRoot-&gt;loadPlugin(&quot;RenderSystem_GL_d&quot;);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;// Load partical system(debug)<br />&nbsp;m_pRoot-&gt;loadPlugin(&quot;Plugin_ParticleFX_d&quot;);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;// Load octree<br />&nbsp;m_pRoot-&gt;loadPlugin(&quot;Plugin_OctreeSceneManager_d&quot;);<br />#else<br />&nbsp;// Load D3D9 Render System<br />&nbsp;m_pRoot-&gt;loadPlugin(&quot;RenderSystem_Direct3D9&quot;);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;// Load OpenGL Render System<br />&nbsp;m_pRoot-&gt;loadPlugin(&quot;RenderSystem_GL&quot;);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;// Load partical system<br />&nbsp;m_pRoot-&gt;loadPlugin(&quot;Plugin_ParticleFX&quot;);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;// Load octree<br />&nbsp;m_pRoot-&gt;loadPlugin(&quot;Plugin_OctreeSceneManager&quot;);<br />#endif&nbsp;&nbsp;&nbsp;<br />&nbsp;return true;<br />&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />bool FOgreWidget::LoadResource()<br />&#123;<br />&nbsp;// Load resource paths from config file<br />&nbsp;Ogre::ConfigFile cf;<br />&nbsp;cf.load(&quot;resources.cfg&quot;);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;// Go through all sections &amp; settings in the file<br />&nbsp;Ogre::ConfigFile::SectionIterator seci = cf.getSectionIterator();</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;Ogre::String secName, typeName, archName;<br />&nbsp;while (seci.hasMoreElements())<br />&nbsp;&#123;<br />&nbsp;&nbsp;secName = seci.peekNextKey();<br />&nbsp;&nbsp;Ogre::ConfigFile::SettingsMultiMap *settings = seci.getNext();<br />&nbsp;&nbsp;Ogre::ConfigFile::SettingsMultiMap::iterator i;<br />&nbsp;&nbsp;for(i = settings-&gt;begin(); i != settings-&gt;end(); ++i)<br />&nbsp;&nbsp;&#123;<br />&nbsp;&nbsp;&nbsp;typeName = i-&gt;first;<br />&nbsp;&nbsp;&nbsp;archName = i-&gt;second;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;&nbsp;&nbsp;Ogre::ResourceGroupManager::getSingleton().addResourceLocation(<br />&nbsp;&nbsp;&nbsp;&nbsp;archName, typeName, secName);<br />&nbsp;&nbsp;&#125;<br />&nbsp;&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;return true;<br />&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">bool FOgreWidget::CreateSceneManager()<br />&#123;<br />&nbsp;assert(m_pRoot);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;m_pSceneManager = m_pRoot-&gt;createSceneManager(Ogre::ST_GENERIC);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;return true;<br />&#125;<br />bool FOgreWidget::CreateDefaultCamera()<br />&#123;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;assert(m_pRoot);<br />&nbsp;assert(m_pSceneManager);<br />&nbsp;assert(m_pRenderWindow);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;//m_pDefCamera = m_pSceneManager-&gt;createCamera(strName);<br />&nbsp;m_pDefCamera = m_pSceneManager-&gt;createCamera(&quot;MyCamera&quot;);<br />&nbsp;m_pDefCamera-&gt;setPosition(Ogre::Vector3(0,0,80));<br />&nbsp;m_pDefCamera-&gt;lookAt(Ogre::Vector3(0,0,-300));<br />&nbsp;m_pDefCamera-&gt;setNearClipDistance(5);<br />&nbsp;m_pDefViewport = m_pRenderWindow-&gt;addViewport(m_pDefCamera);<br />&nbsp;m_pDefViewport-&gt;setBackgroundColour(Ogre::ColourValue(0, 0.0, 0.0, 1));<br />&nbsp;m_pDefCamera-&gt;setAspectRatio(Ogre::Real(m_pDefViewport-&gt;getActualWidth()) / Ogre::Real(m_pDefViewport-&gt;getActualHeight()));</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&nbsp;// Make window active and post an update<br />&nbsp;m_pRenderWindow-&gt;setActive(true);<br />&nbsp;m_pRenderWindow-&gt;update();</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;return true;<br />&#125;<br />// Create Render Window<br />bool FOgreWidget::CreateRenderWindow()<br />&#123;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;assert(m_pRoot);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;Ogre::NameValuePairList params;<br />&nbsp;params[&quot;left&quot;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = &quot;0&quot;;<br />&nbsp;params[&quot;top&quot;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = &quot;0&quot;;<br />&nbsp;params[&quot;border&quot;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = &quot;none&quot;;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;//params[&quot;externalWindowHandle&quot;] = Ogre::StringConverter::toString((size_t)(HWND)winId());<br />&nbsp;params[&quot;parentWindowHandle&quot;] = Ogre::StringConverter::toString((size_t)(HWND)winId());</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;string strName&nbsp; ;<br />&nbsp;strName = m_strInsName_.toStdString() ;<br />&nbsp;strName += &quot;_Window&quot; ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;m_pRenderWindow = m_pRoot-&gt;createRenderWindow(strName, width(), height(), false, &amp;params) ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;if(m_pRenderWindow == NULL) return false;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;return true;<br />&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />bool FOgreWidget::Initialize( )<br />&#123;<br />&nbsp;// already inited<br />&nbsp;if(m_pRoot!= NULL) return true ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />&nbsp;if(Ogre::Root::getSingletonPtr() == NULL)&nbsp;<br />&nbsp;&#123;<br />&nbsp;&nbsp;// create scene root with no config file and plugin<br />&nbsp;&nbsp;//m_pRoot = new Root(&quot;&quot;);<br />&nbsp;&nbsp;m_pRoot = new Ogre::Root();</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;&nbsp;// Load plugin<br />&nbsp;&nbsp;//FALSE_RETURN( LoadPlugin(), false );</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;&nbsp;// Select Render System<br />&nbsp;&nbsp;FALSE_RETURN( SelectRenderSystem(), false );</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;&nbsp;m_pRoot-&gt;initialise(false);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;&nbsp;// Load Resource<br />&nbsp;&nbsp;FALSE_RETURN( LoadResource(), false );<br />&nbsp;&#125;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;else<br />&nbsp;&#123;<br />&nbsp;&nbsp;m_pRoot = Ogre::Root::getSingletonPtr();<br />&nbsp;&#125;&nbsp;&nbsp;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;// Create Render Window<br />&nbsp;FALSE_RETURN( CreateRenderWindow(), false );</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;// Create Scene Manager<br />&nbsp;FALSE_RETURN( CreateSceneManager(), false );</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;// Create Default Camera and Viewport<br />&nbsp;FALSE_RETURN( CreateDefaultCamera(), false );</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;Ogre::ResourceGroupManager::getSingleton().initialiseAllResourceGroups();</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;// Create Scene<br />&nbsp;FALSE_RETURN( CreateScene(), false );</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;CreateLight() ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;startTimer(2);<br />&nbsp;return false ;<br />&#125;&nbsp;&nbsp;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />// Select Render System<br />bool FOgreWidget::SelectRenderSystem()<br />&#123;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;m_pRoot-&gt;restoreConfig() ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;if(m_pRoot-&gt;showConfigDialog())<br />&nbsp;&#123;<br />&nbsp;&nbsp;// If returned true, user clicked OK so initialise<br />&nbsp;&nbsp;// Here we choose to let the system create a default rendering window by passing 'true'</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;&nbsp;return true;<br />&nbsp;&#125;<br />&nbsp;else<br />&nbsp;&nbsp;exit(0);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;return false ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px"><br />bool FOgreWidget::CreateScene()<br />&#123;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;string strName&nbsp; ;<br />&nbsp;strName = m_strInsName_.toStdString() ;<br />&nbsp;strName += &quot;.mesh&quot; ;<br />&nbsp;m_pMainEnt = m_pSceneManager-&gt;createEntity(&quot;root_mesh&quot;, strName);<br />&nbsp;m_pMainNode = m_pSceneManager-&gt;getRootSceneNode()-&gt;createChildSceneNode();<br />&nbsp;m_pMainNode-&gt;attachObject(m_pMainEnt);<br />&nbsp;return true ;<br />&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">void FOgreWidget::updateDraw()<br />&#123;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;if(m_pRenderWindow != NULL)<br />&nbsp;&#123;<br />&nbsp;&nbsp;//printf(&quot;I'm %s/n&quot;,m_strInsName_.toStdString().c_str()) ;<br />&nbsp;&nbsp;m_pRoot-&gt;_fireFrameStarted();<br />&nbsp;&nbsp;m_pRenderWindow-&gt;update();<br />&nbsp;&nbsp;//m_pDefCamera-&gt;moveRelative(mDirection);<br />&nbsp;&nbsp;//m_pDefCamera-&gt;yaw(Ogre::Radian(angleX));<br />&nbsp;&nbsp;//m_pDefCamera-&gt;pitch(Ogre::Radian(angleY));</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;&nbsp;m_pRoot-&gt;_fireFrameEnded();<br />&nbsp;&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">void FOgreWidget::CreateLight()<br />&#123;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;m_pSceneManager-&gt;setAmbientLight(Ogre::ColourValue(0.5, 0.5, 0.5));<br />&nbsp;m_pMainLight = m_pSceneManager-&gt;createLight(&quot;mainLight&quot;);<br />&nbsp;m_pMainLight-&gt;setPosition(20,80,50);<br />&#125;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">main.cpp</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">#include &lt;QtGui/QApplication&gt;<br />#include &quot;FOgreWidget.h&quot;<br />#include &lt;QVBoxLayout&gt;<br />#pragma comment( lib, &quot;OgreMain_d.lib&quot;)<br />#pragma comment( lib, &quot;OIS_d.lib&quot;)</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">int main(int argc, char *argv[])<br />&#123;<br />&nbsp;QApplication a(argc, argv);</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;QWidget widget ;<br />&nbsp;widget.setGeometry (10,10,640,480) ;</p><p style="margin: 0px; padding: 0px; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;FOgreWidget ogreWidget(&amp;widget,QString(&quot;ogrehead&quot;)) ;<br />&nbsp;ogreWidget.setGeometry (10,10,340,280) ;<br />&nbsp;ogreWidget.Initialize() ;<br />&nbsp;widget.show() ;<br />&nbsp;<br />&nbsp;a.connect(&amp;a, SIGNAL(lastWindowClosed()), &amp;a, SLOT(quit()));<br />&nbsp;return a.exec();<br />&#125;</p><div><br /></div>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5739</link>
<title><![CDATA[Phonon MinGW 编译指南]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[QT]]></category>
<pubDate>Wed, 04 Dec 2013 14:34:06 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5739</guid> 
<description>
<![CDATA[ 
	<p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">这里说下怎么用MinGW编译Phonon</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">网上可以找到一些文章关于MinGW+Phonon的，几乎都说MinGW。但是从上文的分析可以知道，Phonon只是一个接口，根本不存在平台相关性。连Qt文档里也仅仅是说：</p><blockquote style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><p>Warning: The MinGW version of Qt does not support building the Qt backend.</p></blockquote><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">也就是说MinGW可以编译Phonon！不能编译的仅仅是后端插件。至于原因，大概是因为DirectX 的SDK和MinGW的兼容性不怎么好吧。后端问题下面另有解决方案！</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">所以用MinGW编译Phonon很简单，在Qt做configure的时候加上phonon的选项就可以，编译phonon-backend的选项最好还是去掉，加了也只会给之后的编译造成麻烦，具体参数用configure --help查询。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">configure完成之后，如果你做出改动的只有Phonon库，那你完全不必把Qt的其他部分一一编译，只需进入src/phonon/，把phonon编译即可。在这过程中一般不会发生问题，编译完成后，你就在lib/里得到了phonon的库文件了(默认是动态库)</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">此时，你的phonon程序已经可以编译了。你可以把Qt demo中的mediaplayer和musicplayer拿来编译，都可以生产可执行文件，也可以执行。但是运行时会弹出<em>phonon backend plugin could not be loaded&nbsp;</em>。这就是缺少后端插件的情况，这时的程序除了显示出界面什么都不能干。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">接下去我们就要想办法找一个可以控制音视频解码播放的后端，并且写一个插件让phonon可以调用这个后端。基本上，这是一件相当麻烦的事情。幸好有高人已经替我们把烦人的事情都做了。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><strong><em><a style="color: #336699; text-decoration: none" href="http://code.google.com/p/phonon-vlc-mplayer/">phonon-vlc-mplayer</a></em></strong>是一个用vlc或者mplayer来做phonon后端的项目，他提供了vlc/mplayer的后端插件源码。现在发布的版本只支持mplayer了，因为支持vlc的版本另外有人写了，链接可以在上面找。详细的情况都可以在该项目主页上查到。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">但这个项目不能直接拿来用，因为他使用了比Qt所带的更新版本的phonon库，和Qt自带库不匹配。要么替换掉Qt的phonon库到最新版，要么就是改插件。其实最新版的增加功能也就字幕和声道切换，为了保证最大兼容性，咱们还是改插件吧。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">这里提供改好的插件源代码：<a style="color: #336699; text-decoration: none" href="http://c-home.appspot.com/static/files/phonon-mplayer.zip">phonon-mplayer.zip</a></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">项目管理我已经改成qmake了。首先进入libmplayer子目录编译，将mplaye的控制端编译成静态库。</p><blockquote style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><p>qmake</p><p>make</p></blockquote><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">在release文件夹下生成的libmplayer.a就是静态库。把这个文件copy到libmplayer子目录下。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">然后再到回到phonon-mplayer目录编译即可得到插件。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">把编译完的插件(dll文件)拷贝到Qt主目录下的plugins/phonon_backend。之后你的程序中的Phonon就能找到他了。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">但这时你还不能用，因为你还没有作为后端的mplayer。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">网上去找个好用的mplayer下载了，把mplayer.exe和相关文件拷贝到 程序主目录/mplayer/ 下，你的插件就能调用mplayer了。这时，你的程序就能正常地播放音频视频了。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">其他的注意事项：</p><ol style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><li>例程中的capabilities我一直无法编译，每次都是gcc出段错误，这是MinGW的问题。或许换4.0+版本的MinGW可以解决。</li><li>mplayer不提供音效选项</li><li>Qt的插件机制非常严格，在加载时会核对库版本和编译器版本，不同的不会加载，所以你如果更换了编译器，可能仅仅是很小的版本变化，你的程序也可能出现<em>phonon backend plugin could not be loaded&nbsp;</em>的情况。请保证你的phonon库，你的程序，以及你的后端插件由同一编译器编译，不然可能造成不可知的错误。</li><li>phonon-mplayer在编译后会产生debug和release2个版本。如上条，插件检查机制非常严格，所以这两个版本就分别对应你自己程序的编译形式。好在phonon的插件检查是不按照文件名的，所以你把2个dll改成不重名都拷贝到插件目录中去，程序是会自动识别对应的插件的。</li><li>发布程序时请将插件放在 程序主目录/phonon_backend/ 下即可，注意只需要release版就可以了，如果你还没蛋疼到发布debug版的话</li></ol>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5736</link>
<title><![CDATA[QT自动更换壁纸软件]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[QT]]></category>
<pubDate>Wed, 04 Dec 2013 01:40:12 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5736</guid> 
<description>
<![CDATA[ 
	<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 14.399999618530273px; background-color: #e5e7e7; font-family: simsun; color: #000080"><a href="http://blog.sina.com.cn/s/blog_691051e10100w962.html">http://blog.sina.com.cn/s/blog_691051e10100w962.html</a><br />因为系统的有些问题，不能升级，所以一直用的win7普通版。<br />win7普通版不能实现壁纸的自动切换，于是下载了一个软件，可那个软件总是出现一些小问题，于是打算自己做一个。<br />类似于他的软件</span><br /><br /><span style="font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; font-family: simsun; color: #464646">我将一步一步添加功能。</span><br /><span style="font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; font-family: simsun; color: #464646">最终将包含如下内容：</span><br /><span style="font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; font-family: simsun; color: #464646">1、将一个文件夹中的图片设置为壁纸（功能如图）</span><br /><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 14.399999618530273px; background-color: #e5e7e7; font-family: simsun; color: #000080">2、可以实现最小化<br />3、启动画面网络化<br />4、部分信息从网络读取<br />暂时有这些吧<br /><br />第一步：最核心的内容，设置壁纸<br />代码如下<br /><br /><br />#include</span><span style="font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; font-family: simsun; color: #464646">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-size: 14.399999618530273px; background-color: #e5e7e7; font-family: simsun; color: #008000">&lt;QApplication&gt;</span><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;QSettings&gt;</span></pre><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;windows.h&gt;</span></pre><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>main<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">argc</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">char</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">argv</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">[])</span></pre><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QApplication</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">app</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">argc</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">argv</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);<br /></span></pre><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QSettings</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">appSettings</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;HKEY_CURRENT_USER&#92;&#92;Control</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">Panel&#92;&#92;Desktop&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QSettings</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">NativeFormat</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QString</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">bgpath</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;E:&#92;s.jpg&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">appSettings</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>setValue<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;Wallpaper&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">bgpath</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QByteArray</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">ba</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">bgpath</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>toLatin1<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px">SystemParametersInfoA<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span>SPI_SETDESKWALLPAPER<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">0</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">ba</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>data<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(),</span>SPIF_UPDATEINIFILE<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#124;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>SPIF_SENDWININICHANGE<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">return</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">app</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>exec<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;<br />环境：WIN7&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 24px; font-size: large">Qt Creator 2.2.1 (</span>基于 Qt 4.7.4 (32 bit)&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 24px; font-size: large">)</span>&nbsp;<br /><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">已经过测试。<br /><br />现在分析一下：<br /><br /></span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">QSettings类提供了持久的独立于平台的程序设置。</span>&nbsp;<br />&nbsp;On Unix systems, QSettings uses text files to store settings，On Windows systems, QSettings uses the system registry<br /><br />在windows下，<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">QSettings</span>&nbsp;使用了系统的注册表。<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000"><br /></span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">现在我们打开注册表看一下&nbsp;</span><br /><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">HKEY_CURRENT_USER&#92;&#92;Control</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">Panel&#92;&#92;Desktop</span>&nbsp;<br /><a style="text-decoration: none; color: #286446" href="http://photo.blog.sina.com.cn/showpic.html#blogid=691051e10100w962&amp;url=http://s5.sinaimg.cn/orignal/691051e1t77787b202ed4" target="_blank"><img style="margin: 0px; padding: 0px; border: 0px; list-style: none" src="http://s5.sinaimg.cn/middle/691051e1t77787b202ed4&amp;690" border="0" alt="QT自动更换壁纸软件（一）" title="QT自动更换壁纸软件（一）" width="367" height="125" /></a><br />其中有一个项是<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">Wallpaper</span>即壁纸。值是一个图片地址，就是壁纸的地址了。<br />那么我们可以猜到，我们只要改变这个值就可以做到改变系统的壁纸了。<br /><br />QSettings::Format有两种:<br />QSettings::NativeFormat在windows平台可以读写windows注册表.<br />QSettings::IniFormat可以读写ini格式的配置文件<br />因为我们要修改注册表，自然选用了QSettings::NativeFormat。<br />&nbsp;<br /><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QString</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">bgpath</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;E:&#92;s.jpg&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span>&nbsp;&nbsp;&nbsp;是我定义的一张图片地址&nbsp;<br /><br /><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QByteArray</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">ba</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">bgpath</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>toLatin1<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span>&nbsp;<br />将字符串转化为字符数组<br /><br />下面就是我们要使用的一个API（MFC中可以使用IActiveDesktop这个函数，具体请百度）<br />SystemParametersInfoA&nbsp;<br />我们查下MSDN<br />我的MSDN是英文的，读不懂的自行翻译。<br />SystemParametersInfo查询或设置功能的系统参数。 这个函数也可以更新用户配置文件,以一个参数。<br />（更多信息看http://msdn.microsoft.com/en-us/library/ms724947(VS.85).aspx）<br /><strong>BOOL SystemParametersInfo(&nbsp;<br />UINT</strong><em>&nbsp;uiAction</em><strong>,&nbsp;</strong>// system parameter to query or set&nbsp;<br /><strong>UINT</strong><em>&nbsp;uiParam</em><strong>,&nbsp;</strong>// depends on action to be taken&nbsp;<strong><br />PVOID</strong><em>&nbsp;pvParam</em><strong>,&nbsp;</strong>// depends on action to be taken&nbsp;<br /><strong>UINT</strong><em>&nbsp;fWinIni</em>&nbsp;// user profile update flag<br />&nbsp;<strong>);</strong>&nbsp;<br /><br />SystemParametersInfoA<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span>SPI_SETDESKWALLPAPER<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">0</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">ba</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>data<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(),</span>SPIF_UPDATEINIFILE<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#124;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>SPIF_SENDWININICHANGE<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span>&nbsp;<br /></pre><dl style="margin: 0px; padding: 0px; border: 0px; list-style: none; color: #464646; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7"><dt style="margin: 0px; padding: 0px; border: 0px; list-style: none"><em>uiAction</em></dt><dd style="margin: 0px; padding: 0px; border: 0px; list-style: none">Specifies the systemwide parameter to query or set. This parameter can be one of the following values:<table border="0" cellspacing="4" style="margin: 0px; padding: 0px; width: 1px; height: 32px"><tbody><tr valign="top"><th width="54%" align="left" style="margin: 0px; padding: 0px; font-size: 12px; font-family: Verdana, 宋体, sans-serif"><br /></th></tr></tbody></table></dd></dl><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px">SPI_SETDESKWALLPAPER 设置桌面墙纸。必须指出的pvParam参数一个为字符串的位图文件的名称。<br /></pre><dl style="margin: 0px; padding: 0px; border: 0px; list-style: none; color: #464646; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7"><dt style="margin: 0px; padding: 0px; border: 0px; list-style: none"><em>uiParam</em></dt><dd style="margin: 0px; padding: 0px; border: 0px; list-style: none">Depends on the system parameter being queried or set. For more information about systemwide parameters, see the<em>uiAction</em>&nbsp;parameter. If not otherwise indicated, you must specify zero for this parameter.</dd><dt style="margin: 0px; padding: 0px; border: 0px; list-style: none">取决于被质疑或系统参数设置。更多信息,见uiAction系统参数的参数。如果不是另有注明为零,您必须指定这个参数。<br /></dt><dt style="margin: 0px; padding: 0px; border: 0px; list-style: none"><em>pvParam</em></dt><dd style="margin: 0px; padding: 0px; border: 0px; list-style: none">Depends on the system parameter being queried or set. For more information about systemwide parameters, see the<em>uiAction</em>&nbsp;parameter. If not otherwise indicated, you must specify NULL for this parameter.</dd><dt style="margin: 0px; padding: 0px; border: 0px; list-style: none"><em>fWinIni</em></dt><dd style="margin: 0px; padding: 0px; border: 0px; list-style: none">If a system parameter is being set, specifies whether the user profile is to be updated, and if so, whether the<a style="text-decoration: underline; color: #286446">WM_SETTINGCHANGE</a>&nbsp;message is to be broadcast to all top-level windows to notify them of the change. This parameter can be zero or can be one of the following values:<table border="0" cellspacing="4" style="margin: 0px; padding: 0px"><tbody><tr valign="top"><th width="44%" align="left" style="margin: 0px; padding: 0px; font-size: 12px; font-family: Verdana, 宋体, sans-serif">Value</th><th width="56%" align="left" style="margin: 0px; padding: 0px; font-size: 12px; font-family: Verdana, 宋体, sans-serif">Action</th></tr><tr valign="top"><td width="44%" style="margin: 0px; padding: 0px; font-size: 12px; font-family: Verdana, 宋体, sans-serif; line-height: 17.600000381469727px">SPIF_UPDATEINIFILE</td><td width="56%" style="margin: 0px; padding: 0px; font-size: 12px; font-family: Verdana, 宋体, sans-serif; line-height: 17.600000381469727px">Writes the new system-wide parameter setting to the user profile.</td></tr><tr valign="top"><td width="44%" style="margin: 0px; padding: 0px; font-size: 12px; font-family: Verdana, 宋体, sans-serif; line-height: 17.600000381469727px">SPIF_SENDCHANGE</td><td width="56%" style="margin: 0px; padding: 0px; font-size: 12px; font-family: Verdana, 宋体, sans-serif; line-height: 17.600000381469727px">Broadcasts the WM_SETTINGCHANGE message after updating the user profile.</td></tr><tr valign="top"><td width="44%" style="margin: 0px; padding: 0px; font-size: 12px; font-family: Verdana, 宋体, sans-serif; line-height: 17.600000381469727px">SPIF_SENDWININICHANGE</td><td width="56%" style="margin: 0px; padding: 0px; font-size: 12px; font-family: Verdana, 宋体, sans-serif; line-height: 17.600000381469727px">Same as SPIF_SENDCHANGE.</td></tr></tbody></table></dd></dl><pre style="white-space: normal; color: #464646; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; margin-top: 0px; margin-bottom: 0px">好了，这第一段的程序就此分析完毕。<br />已经可以设置系统壁纸了。</pre><br /><br /><br /><br /><span style="font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; font-family: simsun; color: #464646">我们继续上一节的内容。</span><div style="color: #464646; font-size: 14.399999618530273px; background-color: #e5e7e7; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; line-height: 1.5">上一节我们已经知道了如何设置壁纸，那要设置壁纸必须有图片文件。这节我们看怎么获取图片。</div><div style="color: #464646; font-size: 14.399999618530273px; background-color: #e5e7e7; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; line-height: 1.5">因为是自动切换，必然有很多图片，所以我们设置为选择一个文件夹，将文件夹内的全部图片读取设置壁纸。</div><div style="color: #464646; font-size: 14.399999618530273px; background-color: #e5e7e7; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; line-height: 1.5"><br /></div><div style="color: #464646; font-size: 14.399999618530273px; background-color: #e5e7e7; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; line-height: 1.5">这次做的例子便是如何读取一个文件夹内的全部图片文件</div><div style="color: #464646; font-size: 14.399999618530273px; background-color: #e5e7e7; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; line-height: 1.5"><br /></div><div style="color: #464646; font-size: 14.399999618530273px; background-color: #e5e7e7; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; line-height: 1.5">就贴上代码进行分析（UI请自行根据截图制作，或者代码添加）</div><div style="color: #464646; font-size: 14.399999618530273px; background-color: #e5e7e7; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; line-height: 1.5">******************************** &nbsp;&nbsp;mainwindow.h &nbsp;******************************************</div><div style="color: #464646; font-size: 14.399999618530273px; background-color: #e5e7e7; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; line-height: 1.5"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080"><br /></span></div><div style="color: #464646; font-family: simsun; font-size: 14.399999618530273px; background-color: #e5e7e7; line-height: 1.5"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000080">#ifndef</span>&nbsp;MAINWINDOW_H<pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#define</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>MAINWINDOW_H</pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;QMainWindow&gt;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;QFileDialog&gt;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;QDir&gt;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;QStandardItem&gt;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;QAbstractItemModel&gt;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;QStringListModel&gt;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;QFileInfo&gt;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">namespace</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">Ui</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">class</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">class</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">:</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">public</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QMainWindow</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">Q_OBJECT</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">public</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">:</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">explicit</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QWidget</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span>parent<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">0</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">~</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-style: italic; color: #000000">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">private</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">slots</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">:</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>on_pushButton_clicked<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>on_pushButton_3_clicked<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">private</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">:</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">Ui</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">ui</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QString</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">directory</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QDir</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">qdir</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QStringList</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">fileslist</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#endif</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">//</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">MAINWINDOW_H</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000"><br /></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">******************************** &nbsp;&nbsp;mainwindow.cpp &nbsp;******************************************</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080"><br /></span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;mainwindow.h&quot;</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;ui_mainwindow.h&quot;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QWidget</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">parent</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">:</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QMainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">parent</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">),</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">ui</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">new</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">Ui</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">)</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">ui</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">-&gt;</span>setupUi<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">this</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">ui</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">-&gt;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">fileEdit</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">-&gt;</span>setText<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;C:&#92;&#92;&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::~</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-style: italic; color: #000000">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">()</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">delete</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">ui</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span>on_pushButton_clicked<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">()</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">directory</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QFileDialog</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span>getExistingDirectory<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">this</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span>tr<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;Find</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">Files&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">),</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QDir</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span>rootPath<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">());</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">ui</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">-&gt;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">fileEdit</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">-&gt;</span>clear<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">ui</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">-&gt;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">fileEdit</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">-&gt;</span>setText<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">directory</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">qdir</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QDir</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">directory</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">fileslist</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">qdir</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>entryList<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QStringList</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;*&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">),</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QDir</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">Files</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#124;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QDir</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">NoSymLinks</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QStringList</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">files</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QFileInfo</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">qfile</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">size</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">fileslist</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>size<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QString</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">hz</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">for</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">0</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&lt;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">size</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">++)</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">qfile</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>setFile<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">fileslist</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>at<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">));</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">hz</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">qfile</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>completeSuffix<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">if</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">hz</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">==</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;bmp&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#124;&#124;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">hz</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">==</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;png&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#124;&#124;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">hz</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">==</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;jpg&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">)</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">files</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>append<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">directory</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">+</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;&#92;&#92;&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">+</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">fileslist</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>at<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">));</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QAbstractItemModel</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">model</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">new</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QStringListModel</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">files</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">ui</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">-&gt;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">listView</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">-&gt;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-style: italic; color: #000000">setModel</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">model</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span>on_pushButton_3_clicked<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">()</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px">exit<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">0</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 1.5">***************************************************************************************</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px">【选择一个文件夹】</pre><pre style="white-space: normal">QString<span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #800000">directory</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">QFileDialog</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">::</span>getExistingDirectory<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #808000">this</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">,</span>tr<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #008000">&quot;Find</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #008000">Files&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">),</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">QDir</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">::</span>rootPath<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">());</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000"><br /></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">QFileDialog类提供了允许用户选择文件或者目录的对话框。</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">QFileDialog类允许用户在它们的文件系统上遍历来选择一个或多个文件或目录。</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><br /></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><a style="text-decoration: none; color: #286446" href="http://blog.sina.com.cn/s/blog_691051e10100wao0.html">QString</a>&nbsp;<a style="text-decoration: underline; color: #286446" name="getExistingDirectory"></a>QFileDialog::getExistingDirectory</pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px">这是一个返回由用户选择的已经存在的目录的方便的静态函数。</pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><a style="text-decoration: none; color: #286446" href="http://blog.sina.com.cn/s/blog_691051e10100wao0.html">QDir</a>&nbsp;<a style="text-decoration: underline; color: #286446" name="current"></a>QDir::current ()&nbsp;[静态]---返回应用程序当前目录。</pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><a style="text-decoration: none; color: #286446" href="http://blog.sina.com.cn/s/blog_691051e10100wao0.html">QDir</a>&nbsp;<a style="text-decoration: underline; color: #286446" name="home"></a>QDir::home ()&nbsp;[静态]---返回主目录。</pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><a style="text-decoration: none; color: #286446" href="http://blog.sina.com.cn/s/blog_691051e10100wao0.html">QString</a>&nbsp;<a style="text-decoration: underline; color: #286446" name="homeDirPath"></a>QDir::homeDirPath ()&nbsp;[静态]---返回用户的主目录的绝对路径。</pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><a style="text-decoration: none; color: #286446" href="http://blog.sina.com.cn/s/blog_691051e10100wao0.html">QDir</a>&nbsp;<a style="text-decoration: underline; color: #286446" name="root"></a>QDir::root ()&nbsp;[静态]---返回根目录。</pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><br /></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080"><br /></span></pre><pre style="white-space: normal"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #800080">QAbstractItemModel，并且要过滤非图片文件（也可以在</span>entryList中用过滤器<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #800080">）</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">QStringList fileslist</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">qdir</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">.</span>entryList<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">QStringList</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #008000">&quot;*&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">),</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">QDir</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">::</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">Files</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">&#124;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">QDir</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">::</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">NoSymLinks</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">);</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">QDir::entryList返回这个目录中所有目录和文件的名称的列表</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px">【得到文件数量】</pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">size</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">fileslist</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">.</span>size<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">();</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><br /></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">【文件操作】</span></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">QDir</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">qdir</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">;</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">qdir</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">QDir</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">directory</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">); &nbsp;&nbsp;&nbsp;&nbsp;//将之前得到的QString类型的目录地址转化为系统路径</span></span></pre><pre style="white-space: normal"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QDir类提供了访问目录结构和它们的内容的与平台无关的方式。<br />QDir用来操作路径名称、关于路径和文件的访问信息和操作底层文件系统。</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">QFileInfo</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">qfile</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">; &nbsp;</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">【添加到ListView】</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-style: italic; color: #000000">setModel</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">model</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">); &nbsp;因为要添加model。</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">所以要添加创建一个</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">QAbstractItemModel</span></span></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080"><br /></span></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #808000">for</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000080">0</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">&lt;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">size</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">++)</span></span></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">&#123;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">qfile</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">.</span>setFile<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">fileslist</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">.</span>at<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">));</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px">//转化为文件，以便获取文件后缀</pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">hz</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">qfile</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">.</span>completeSuffix<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">();</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">//获取文件后缀</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #808000">if</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">hz</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">==</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #008000">&quot;bmp&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">&#124;&#124;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">hz</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">==</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #008000">&quot;png&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">&#124;&#124;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">hz</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">==</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #008000">&quot;jpg&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">)</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">&#123;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">files</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">.</span>append<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">directory</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">+</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #008000">&quot;&#92;&#92;&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">+</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">fileslist</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">.</span>at<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">));</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">&#125;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">&#125;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000"><br /></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">QAbstractItemModel</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">model</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #808000">new</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">QStringListModel</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">files</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">);</span></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">ui</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">-&gt;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">listView</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">-&gt;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-style: italic; color: #000000">setModel</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">model</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px">//添加到ListView</pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 1.5">******************************** &nbsp;&nbsp;main.cpp &nbsp;******************************************</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 1.5"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;QtGui/QApplication&gt;</span></span></span></pre><pre style="white-space: normal"></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;mainwindow.h&quot;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>main<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">argc</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">char</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">argv</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">[])</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QFont</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">font</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;ZYSong18030&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">12</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QApplication</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span>setFont<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">font</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QApplication</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">a</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">argc</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">argv</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">w</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">w</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>show<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">return</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">a</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>exec<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre></div><br /><br /><br /><span style="font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; font-family: simsun; color: #464646">下一步就是将一二中的代码结合起来。文件读取代码不需要有改变，不过自动换壁纸代码要放到一个线程中，不然会把程序卡在那里，而没有可操作性。所以这次的内容比较容易。</span><div style="color: #464646; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7">************************************&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">mythread.h&nbsp;</span>********************************************</div><div style="color: #464646; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#ifndef</span>&nbsp;MYTHREAD_H<pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#define</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>MYTHREAD_H</pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;QThread&gt;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;QStringList&gt;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;windows.h&gt;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;time.h&gt;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&lt;QSettings&gt;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">class</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">mythread</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">:</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">public</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QThread</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">Q_OBJECT</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">public</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">:</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">explicit</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">mythread</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QObject</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span>parent<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">0</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>setValue<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QStringList</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">file</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">n</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">m</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">)</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">files</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">file</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">size</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">n</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">times</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">m</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">r</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">true</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">virtual</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-style: italic; color: #000000">run</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>ChangeDesk<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QString</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>filepath<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>end<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">private</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">:</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QStringList</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">files</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">size</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">times</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">BOOL</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">r</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">signals</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">:</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">public</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">slots</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">:</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#endif</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">//</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">MYTHREAD_H</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif">setValue<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">QStringList</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">file</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">n</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">m</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">)；将文件列表，间隔时间传递进来</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000"><br /></span></pre><pre style="white-space: normal"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif">****************************&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800080">mythread.cpp&nbsp;</span>********************************************</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">#include</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;mythread.h&quot;</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">mythread</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">mythread</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QObject</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">parent</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">:</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QThread</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">parent</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">)</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">mythread</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-style: italic; color: #000000">run</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">()</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">while</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">r</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">)</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px">Sleep<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">times</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">1000</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px">srand<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span>time<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">0</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">));</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span>rand<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">()%</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">size</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px">ChangeDesk<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">files</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>at<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">));</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">mythread</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span>ChangeDesk<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QString</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">filepath</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">)</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QSettings</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">appSettings</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;HKEY_CURRENT_USER&#92;&#92;Control</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">Panel&#92;&#92;Desktop&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QSettings</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">NativeFormat</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">appSettings</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>setValue<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;Wallpaper&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">filepath</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QByteArray</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">ba</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">filepath</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>toLatin1<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px">SystemParametersInfoA<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span>SPI_SETDESKWALLPAPER<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000080">0</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*)</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">ba</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>data<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(),</span>SPIF_UPDATEINIFILE<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#124;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span>SPIF_SENDWININICHANGE<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">mythread</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">::</span>end<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">()</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">r</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">false</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #808000">while</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #800000">r</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">)</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">&#123;</span></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px">Sleep<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">times</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000080">1000</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">);</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px">srand<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span>time<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000080">0</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">));</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #808000">int</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">=</span>rand<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">()%</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">size</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px">ChangeDesk<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">files</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">.</span>at<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">i</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">));</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">&#125;</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">用r的真假来判断循环是否继续，用来结束无线循环。 每次切换休眠times秒的时间。 然后图片的切换是采用的随即办法。也可以采用顺序切换，可以在让用户自己选择壁纸切换方式。</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000"><br /></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px">重写了run()方法 调用的时候只需要</pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">mythread</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">m</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #800000">m</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif">.</span>setValue<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #800000">files</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif">size</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif">times</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif">);</span></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000"><br /></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000"><br /></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">m</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">.</span>start<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000"><br /></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">中断线程使用</span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">m</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">.</span>end<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">();</span></span></pre><pre style="white-space: normal; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px">下面一节我们将看如何将窗体最小化到托盘</pre></div><br /><br /><span style="font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7; font-family: simsun; color: #464646">这节我们要让软件可以托盘运行，毕竟总是占据任务栏对用户是不好的体验。</span><div style="color: #464646; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7">我们将制作如上图一样的效果。</div><div style="color: #464646; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7">要使用的到QT的<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QSystemTrayIcon</span></div><div style="color: #464646; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080"><br /></span></div><div style="color: #464646; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">The QStyleSheetItem class provides an encapsulation of a set of text styles.</span></div><div style="color: #464646; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">头文件中需要有</span></div><div style="color: #464646; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QSystemTrayIcon</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">trayIcon</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span><pre style="white-space: normal; color: #800080; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">QAction</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">showpro</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; color: #800080; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">QAction</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">endpro</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; color: #800080; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">QMenu</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">*</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">menu</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">;</span></pre><pre style="white-space: normal; color: #800080; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-style: italic">closeEvent</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QCloseEvent</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">*</span>event<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">);</span></span></pre></div><div style="color: #464646; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">首先是设置图标</span></div><div style="color: #464646; font-family: simsun; font-size: 14.399999618530273px; line-height: 21.600000381469727px; background-color: #e5e7e7"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">trayIcon</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">new</span>&nbsp;<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QSystemTrayIcon</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">this</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span><pre style="white-space: normal; color: #800080; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">trayIcon</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">-&gt;</span>setIcon<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">QIcon</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;:/image/cool.png&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">));</span></pre><pre style="white-space: normal; color: #800080; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000"><br /></span></pre><pre style="white-space: normal; color: #800080; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">然后是添加功能</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">showpro</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">new</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QAction</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;Restore&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">this</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">);</span></pre><pre style="white-space: normal; color: #000000; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QObject</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">::</span>connect<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">showpro</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">SIGNAL</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(</span>triggered<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">()),</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">this</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">SLOT</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(</span>showNormal<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">()));</span></pre><pre style="white-space: normal; color: #000000; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">endpro</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">new</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QAction</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #008000">&quot;Exit&quot;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">this</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">);</span></pre><pre style="white-space: normal; color: #000000; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QObject</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">::</span>connect<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">endpro</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">SIGNAL</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(</span>triggered<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">()),</span>qApp<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">,</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">SLOT</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(</span>quit<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">()));</span></pre><pre style="white-space: normal; color: #000000; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px"><br /></span></pre><pre style="white-space: normal; color: #000000; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">将action加入菜单并保存到图标上</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">menu</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">-&gt;</span>addAction<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">showpro</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">);</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #800000">menu</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">-&gt;</span>addAction<span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #800000">endpro</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #800000">trayIcon</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">-&gt;</span>setContextMenu<span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #800000">menu</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">);</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">最后一个步就是显示图标</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #800000">trayIcon</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5">-&gt;</span>show<span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 1.5">();</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">现在运行程序，发现已经显示了我们的图标，右击图标也会显示我们添加的功能、但是点X的时候，程序是退出，并未缩小。</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">重写</span></pre><pre style="white-space: normal"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-style: italic; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">closeEvent</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">menu</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">=</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">new</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QMenu</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">this</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">);</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-style: italic; color: #000000"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-style: italic; color: #000000"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">void</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">MainWindow</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">::</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">closeEvent</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800080">QCloseEvent</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">*</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">event</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px">)</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-style: italic; color: #000000"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #808000">if</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">(</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #800000">trayIcon</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">-&gt;</span>isVisible<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">())</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#123;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px">hide<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">event</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">-&gt;</span>ignore<span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #c0c0c0">&nbsp;</span><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">();</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">&#125;</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000">这段代码让窗体点关闭的时候隐藏窗体。</span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; color: #000000"><br /></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 21.600000381469727px; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; color: #000000">至此，我们已经实现了软件的托盘运行。</span></span></pre><pre style="white-space: normal; margin-top: 0px; margin-bottom: 0px"><span style="word-wrap: normal; word-break: normal; line-height: 1.5; font-family: 宋体, Verdana, Arial, Helvetica, sans-serif; color: #000000">我们也实现了软件所需要的基本功能。我们将在以后添加一些辅助性内容。</span></pre></div><br />
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5693</link>
<title><![CDATA[动态对话框(Dynamic Dialogs)]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[QT]]></category>
<pubDate>Wed, 27 Nov 2013 09:40:28 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5693</guid> 
<description>
<![CDATA[ 
	<span style="line-height: 28px; font-size: 16px; font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; color: #ff00ff">动态对话框</span><span style="font-size: 16px; line-height: 28px; font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53">是在程序运行时用Qt Designer的.ui文件创建。而不是用uic工具把.ui文件转换为等价的c++代码，而</span><span style="line-height: 28px; font-size: 16px; font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; color: #ff00ff">是在运行时使用类QUiLoader加载.ui文件</span><span style="font-size: 16px; line-height: 28px; font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53">，例如下面的代码：</span><br /><span style="line-height: 28px; font-size: 16px; font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; color: #ff0000">QUiLoader uiLoader;<br />QFile file(&quot;sortdialog.ui&quot;);<br />QWidget *sortDialog = uiLoader.load(&amp;file);<br />if (sortDialog) &#123;<br />&nbsp;&nbsp;&nbsp; ...<br />&#125;</span><p style="line-height: 28px; margin: 0px 0px 10px; padding: 0px; font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 16px">子控件可以用<span style="color: #ff0000">QObject::findChild&lt;T&gt;()</span>得到<br /><span style="color: #ff0000">QComboBox *primaryColumnCombo =<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sortDialog-&gt;findChild&lt;QComboBox *&gt;(&quot;primaryColumnCombo&quot;);<br />if (primaryColumnCombo) &#123;<br />&nbsp;&nbsp;&nbsp; ...<br />&#125;</span></p><p style="line-height: 28px; margin: 0px 0px 10px; padding: 0px; font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 16px"><span style="color: #ff0000">findChild&lt;T&gt;()</span><span style="color: #ff00ff">是模板成员函数，得到类型为T的给定名字的子控件的指针</span>。由于编译器的原因，用MSVC6是得不到的。如果使用的是MSVC6，那么可以使用全局函数<span style="color: #ff0000">qFindChild&lt;T&gt;()</span>。</p><p style="line-height: 28px; margin: 0px 0px 10px; padding: 0px; font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 16px"><span style="color: #ff00ff">QUiLoader类位于一个单独的链接库中，如果在一个应用程序中使用了QUiLoader，必须在这个程序的.pro文件中添加下面这样的代码：</span><br /><span style="color: #ff0000">CONFIG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; += uitools</span></p><p style="line-height: 28px; margin: 0px 0px 10px; padding: 0px; font-family: 'Hiragino Sans GB W3', 'Hiragino Sans GB', Arial, Helvetica, simsun, u5b8bu4f53; font-size: 16px">使用动态对话框不用重新编译程序就能够改变对话框的布局。它们可以用来创建&ldquo;瘦客户程序(thin-client applications)&rdquo;，指只有内建的前期的对话框，其他的对话框都是按照不同需要来创建的。</p>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5692</link>
<title><![CDATA[QUiLoader:彻底分离你的Ui设计工作]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[QT]]></category>
<pubDate>Wed, 27 Nov 2013 09:40:06 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5692</guid> 
<description>
<![CDATA[ 
	<p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">Trolltech提供的界面所见即所得工具designer极大的简化了开发者花费在UI布局上的时间。但一部分喜欢在终端上开发的工程师认为拖拖拉拉这种伎俩实在是&rdquo;雕虫小技，壮夫不为&ldquo;也。即使专门的界面设计师为他设计.ui文件的话，他也嫌来来回回的重新编译麻烦。乐于自己通过QLayout手写代码进行设计。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">那么QUiLoader这个工具，则可以真正做到程序师和界面师做到&ldquo;鸡犬相闻，不相往来&rdquo;, .ui文件不需要重新编译，就可以被程序加载，生成新的外观。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">我们来看QUiLoader的实用方法<br />QUiLoader loader;<br />QFile file(&ldquo;cuteqt.ui&rdquo;);<br />file.open(QFile::ReadOnly);<br />QWidget *formWidget = loader.load(&amp;file, this);<br />通过load函数即可根据.ui文件创建出一个对应的QWidget对象,后面的this指针是QWidget *类型的，你可以用其它窗体去作为formWidget的父窗体。父窗体被显示的时候，该formWidget窗体就会被显示，当然更好的方法是用一个QLayout来管理formWidget,因为父窗体可能不止一个子窗体。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">如果你还想对cuteqt.ui中的那些子窗体信号作处理，那么可以用qFindChild去找到它们。<br />ui_setButton = qFindChild&lt;QPushButton*&gt;(this, &ldquo;setButton&rdquo;);<br />ui_clearButton = qFindChild&lt;QPushButton*&gt;(this, &ldquo;clearButton&rdquo;);<br />ui_textEdit = qFindChild&lt;QTextEdit*&gt;(this, &ldquo;textEdit&rdquo;);</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">比如你可以用<br />connect(ui_setButton,SIGNAL(clicked()),this,SLOT（setButtonClicked()));处理ui_setButton的clicked()信号。<br />但拜元对象机制所赐，还有一劳永逸的方法<br />QMetaObject::connectSlotsByName(this);该函数会将this的所有子对象都连接上一个槽(slot)，槽的命名规范为<br />on_对象名_信号名，比如上面的setButton的clicked()，将会生成一个on_setButton_clicked()的槽，你只要实现该槽函数就可以了。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">怎样，动态加载.ui文件的方法是不是很简单？而且这样做的好处至少有两个<br />1. 前期的设计会更准确，程序师和界面师只要协商好有哪些对象就可以分头工作了，彼此互不依赖<br />2. 界面可以独立于应用发布</p>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5691</link>
<title><![CDATA[Qt Designer中自定义控件的使用(提升法与插件法)]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[QT]]></category>
<pubDate>Wed, 27 Nov 2013 09:10:18 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5691</guid> 
<description>
<![CDATA[ 
	<ul style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><li style="list-style-type: none"><p style="margin: 0.25em 0px" class="line862">准备乱写一点Qt自定义Widget在Designer中的使用。可是又不想重复提升法(promotion)及插件法基本用法，因为Manual中<a style="color: #047307; text-decoration: none; border: 0px" href="http://doc.qt.nokia.com/4.7/designer-using-custom-widgets.html" class="http">Using Custom Widgets with Qt Designer</a>已经说的很清楚了。</p></li></ul><h2 style="margin: 0px; padding: 0px 0px 0.3em; color: #333333; font-family: Arial; line-height: 26px; border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #047307"><a style="color: #336699" name="t0"></a>使用designer</h2><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">Qt用户可能会经历这样的3个阶段：</p><ul style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><li>刚接触Qt，在designer中拖拖拽拽，一个界面就形成了。相当方便(不过不少人网友初次接触时对layout相当不适应)</li><li>比较熟悉之后，感觉designer是个累赘，比如：<ul><li>感觉在designer中拖拽控件，完全没有在代码中写的易于控制。尽管都是用QLayout</li><li>接触到自定义控件后，发现在designer中使用自定义控件比较麻烦。</li><li>就是不太喜欢desinger生成.ui文件，然后uic生成 ui_xxx.h文件的这套东西。</li><li>...</li></ul></li><li>再过一段时间，发觉，designer确实很方便。而且通过提升法在designer中使用自定义控件是非常简单的。而且前一阶段的问题其实也都不算什么问题。</li></ul><h2 style="margin: 0px; padding: 0px 0px 0.3em; color: #333333; font-family: Arial; line-height: 26px; border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #047307"><a style="color: #336699" name="t1"></a>自定义控件</h2><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">考虑下列情况：</p><ul style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><li>从QWidget派生了一个led灯控件：HLed</li><li>从QSpinBox派生了一个进制可变的：HBaseSpinBox</li><li>从QLabel派生了一个发射但双击信号的:HLabel</li><li>...</li></ul><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">恩，没什么特别的哈</p><ul style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><li>如果在代码中使用的话，包含头文件直接用即可。和标准控件没有任何区别。</li><li>如果在designer中使用，分别拖放QWidget、QSpinBox、QLabel，然后右键点击提升...</li></ul><h2 style="margin: 0px; padding: 0px 0px 0.3em; color: #333333; font-family: Arial; line-height: 26px; border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #047307"><a style="color: #336699" name="t2"></a>提升 vs 插件</h2><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">两种方法有什么区别么？什么区别?</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">先考虑我们是如何使用designer的（此处不考虑.ui动态加载）：</p><ul style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><li>打开designer，拖放控件，应用布局，设置属性</li><li>保存，生成 XXX.ui 文件</li><li>调用 uic 将 XXX.ui 预处理成 ui_XXX.h</li><li><p style="margin: 0.25em 0px" class="line862">调用C++编译器编译这些&nbsp;*.h、*.cpp</p></li></ul><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">注意，如果你写了插件，那么它只在第一步中有用。有什么用：</p><ul style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><li><p style="margin: 0.25em 0px" class="line862">插件包含类名name()已经头文件includeFile()信息。（对比，用提升法时，手动输入这两项信息）</p></li><li>插件包含控件的实现<ul><li>所以在designer中可以看到控件的真实样子。(对比，提升法时，需要一个替身，一般就是其基类)</li><li>可以感知其有哪些属性，并显示在属性编辑器中。（对比，你可以直接在属性编辑器中添加属性，又一个大大的加号，不是么？）</li></ul></li><li>...</li></ul><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">归根到底，插件法 和 提升法想比，其实没有本质的区别。二者都是要生成一个.ui文件，而这个文件的使用，和插件一点关系都没有。</p><h2 style="margin: 0px; padding: 0px 0px 0.3em; color: #333333; font-family: Arial; line-height: 26px; border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #047307"><a style="color: #336699" name="t3"></a>还有点什么...</h2><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">前面的东西都似乎没什么意思，因为Manual中介绍很清楚，只要用过提升法和插件法就能得出上面这些的东西。</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">可是，还有有一点可能稍微有点意思，考虑：</p><ul style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><li>我从QStackedWidget派生类了一个HDoubleSpinBox。可是在designer中，我想看到一个QDoubleSpinBox，而不是一个stacked widget.</li><li>我从QLabel派生了一个HLabelButton。可是在designer中，我想看到一个QToolButton，而不是一个 QLabel</li><li>...</li></ul><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">插件法能不能做到？</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">能，只要让插件的createWidget()创建一个QDoubleSpinBox或者QToolButton</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">提升法能不能做到？</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px" class="line874">能，注意到提升时我们我们需要选择一个基类。而这个基类，我们可以随便选，选择哪一个，哪一个就会作为替身显示出来。</p><div><br /></div>
]]>
</description>
</item><item>
<link>http://i.renjihe.com/blog/read.php?5690</link>
<title><![CDATA[Qt中Ui文件的使用总结]]></title> 
<author>renjihe1988 &lt;admin@yourname.com&gt;</author>
<category><![CDATA[QT]]></category>
<pubDate>Wed, 27 Nov 2013 09:09:51 +0000</pubDate> 
<guid>http://i.renjihe.com/blog/read.php?5690</guid> 
<description>
<![CDATA[ 
	<p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: SimSun">Qt中ui文件主要包括3种方式：直接使用法，单继承法和多继承法。</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: SimSun">其中直接使用法和单继承法是先单纯地通过QtDesignor设计好界面以及控件信号等保存为ui文件，然后在需要ui的地方（通常是对话框等创建之前）通过UI::引用并创建UI中的控件的对象，如UI::Dialog ui，然后再创建了QDialog对话框dialog对象（dialog为ui中的对象名）之后为其套上设计的ui，即ui.setupUi(dialog)，对话框显示时则和设计的ui中一样了。</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-family: SimSun"><span style="font-size: 16px; font-family: 宋体">单继承法这种方式也是QtCreator在创建相应的Qt GUI应用时默认的使用方式。</span></span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">Dialog::Dialog(QWidget *parent) :</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&nbsp;&nbsp;&nbsp; QDialog(parent),</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&nbsp;&nbsp;&nbsp; ui(new Ui::Dialog)</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&#123;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&nbsp;&nbsp;&nbsp; ui-&gt;setupUi(this);</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&#125;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px">对应<span style="font-family: Calibri">dialog.h</span>文件内容如下：</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">#include &lt;QDialog&gt;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">namespace Ui &#123;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&nbsp;&nbsp;&nbsp; class Dialog;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&#125;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">class Dialog : public QDialog</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&#123;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&nbsp;&nbsp;&nbsp; Q_OBJECT</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">public:</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&nbsp;&nbsp;&nbsp; explicit Dialog(QWidget *parent = 0);</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&nbsp;&nbsp;&nbsp; ~Dialog();</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">private:</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&nbsp;&nbsp;&nbsp; Ui::Dialog *ui;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&#125;;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; color: #000000">其中<span style="font-family: Calibri">Dialog</span>类声明为<span style="font-family: Calibri">QDialog</span>单继承，并且将其本身声明了一个私有的指针，然而在<span style="font-family: Calibri">dialog.cpp</span>中内容如下：</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">#include &quot;dialog.h&quot;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">#include &quot;ui_dialog.h&quot;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">Dialog::Dialog(QWidget *parent) :</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&nbsp;&nbsp;&nbsp; QDialog(parent),</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&nbsp;&nbsp;&nbsp; ui(new Ui::Dialog)</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&#123;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&nbsp;&nbsp;&nbsp; ui-&gt;setupUi(this);</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&#125;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">Dialog::~Dialog()</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&#123;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&nbsp;&nbsp;&nbsp; delete ui;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; font-family: Calibri">&#125;</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; color: #000000">构造函数的定义<span style="font-family: Calibri">QDialog(parent)</span>和<span style="font-family: Calibri">ui(new Ui::Dialog)</span>初始化列表，即完成了界面类的创建，<span style="font-family: Calibri">ui</span>指针的初始化，调用父类<span style="font-family: Calibri">QDialog</span>构造函数，创建<span style="font-family: Calibri">Dialog</span>。然后就可以通过<span style="font-family: Calibri">ui</span>指针来完成对界面的操作和控制。<span style="font-family: Calibri">ui-&gt;setupUi(this);</span>完成了界面的设置。</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; color: #000000">而多继承法则是直接将需要<span style="font-family: Calibri">ui</span>的<span style="font-family: Calibri">Dialog</span>等在定义时通过<span style="font-family: Calibri">QDialog</span>和<span style="font-family: Calibri">UI</span>类一起继承构建对应的<span style="font-family: Calibri">Dialog</span>等类，然后在该类的构造函数中通过<span style="font-family: Calibri">setupUi(this)</span>套上<span style="font-family: Calibri">/</span>设置<span style="font-family: Calibri">ui</span>即可。</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px">&nbsp;</p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; color: #000000">参考文献：</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; color: #000000">吴迪．零基础学<span style="font-family: Calibri">Qt4</span>编程</span></p><p style="color: #333333; font-family: Arial; font-size: 14px; line-height: 26px"><span style="font-size: 16px; color: #000000">成洁，卢紫毅．<span style="font-family: Calibri">Linux</span>窗口程序设计&mdash;<span style="font-family: Calibri">Qt4</span>精彩实例分析</span></p>
]]>
</description>
</item>
</channel>
</rss>